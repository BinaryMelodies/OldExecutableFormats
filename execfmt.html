<!-- This file is automatically generated from execfmt.dat -->
<html>
<head>
<title>Old computer executable file formats</title>
</head>
<body>

<h1>Table of contents</h1>

<ul>
<li>1971 &mdash; <a href="#aout">UNIX a.out file format</a> (for <u>a</u>ssembly <u>out</u>put)</li>
<li>1987 &mdash; <a href="#aout_minix">MINIX a.out file format</a></li>
<li>1983 &mdash; <a href="#coff">COFF format</a> (Common Object File Format) for UNIX</li>
<li>1984 &mdash; <a href="#xout">XENIX x.out file format</a></li>
<li>1988 &mdash; <a href="#macho">Mach-O format</a> (for Mach object) for UNIX</li>
<li>1988 &mdash; <a href="#elf">ELF format</a> (Executable and Linkable Format) for UNIX</li>
<li>1974 &mdash; <a href="#cpm">flat binary</a> CP/M</li>
<li>1976 &mdash; <a href="#cmd_flex">FLEX executable</a> (.CMD)</li>
<li>1979 &mdash; <a href="#prl">Page relocatable</a> for CP/M</li>
<li>1983 &mdash; <a href="#cpm3">CP/M-80 Plus executable</a> (.COM) for CP/M</li>
<li>1981 &mdash; <a href="#cmd">CP/M-86 executable</a> (.CMD) for PC</li>
<li>1982 &mdash; <a href="#68k">CP/M-68K executable</a> (.68K) for Atari etc.</li>
<li>1982 &mdash; <a href="#z8k">CP/M-8000 executable</a> (.Z8K)</li>
<li>1987 &mdash; <a href="#hu">Human68k executable</a> (HU) for X68000</li>
<li>1981 &mdash; <a href="#mz">MZ executable</a> (named after Mark Zbikowski) for PC</li>
<li>1985 &mdash; <a href="#ne">New executable</a> (NE) for PC</li>
<li>1990 &mdash; <a href="#le">Linear executable</a> (LE, LX) for PC</li>
<li>1993 &mdash; <a href="#pe">Portable executable</a> (PE) for PC</li>
<li>1986 &mdash; <a href="#mp">MP/MQ executable</a>  for Phar Lap DOS extenders</li>
<li>1987 &mdash; <a href="#bw">BW executable</a> for Rational Systems DOS/16M DOS extender</li>
<li>1988 &mdash; <a href="#xp">XP executable</a> for A. I. Architects/Ergo OS/286 DOS extender</li>
<li>1991 &mdash; <a href="#p3">P2/P3 executable</a> for Phar Lap DOS extenders</li>
<li>1984 &mdash; <a href="#rsrc">Macintosh resource</a> for Apple</li>
<li>1986 &mdash; <a href="#gsos_omf">Object Module Format</a> for Apple computers</li>
<li>1994 &mdash; <a href="#pef">Preferred Executable Format</a> (PEF) for Macintosh</li>
<li>1978 &mdash; <a href="#hunk">Hunk executable</a> for Amiga</li>
<li>1994 &mdash; <a href="#adam">Adam Seychell's DOS32 executable</a></li>
</ul>
<hr/>
<h1 id="aout">UNIX a.out file format (for <u>a</u>ssembly <u>out</u>put)</h1>
<dl>
<dt>File extensions</td>
<dd>&mdash;</dd>
<dl>
<dt>Magic code</td>
<dd>various: <tt><sub>x</sub>0107</tt>, <tt><sub>x</sub>0108</tt>, <tt><sub>x</sub>010B</tt>, <tt><sub>x</sub>0105</tt>, <tt><sub>x</sub>00CC</tt>, <tt><sub>x</sub>0101</tt>, <tt><sub>x</sub>0109</tt>, <tt><sub>x</sub>010C</tt>, <tt><sub>x</sub>010D</tt>, <tt><sub>x</sub>010E</tt>, <tt><sub>x</sub>0111</tt>, <tt><sub>x</sub>0118</tt>, <tt><sub>x</sub>0119</tt>, <tt><sub>x</sub>011F</tt></dd>
<dl>
<dt>Architecture</td>
<dd>DEC PDP-11, DEC VAX, Motorola 68000, Intel 386 and others (Interdata 7/32, IBM 370, MIPS, SPARC)</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>between 1969 and 1971-11-03: PDP-11 UNIX version 1 (old format)</li>
<li>1972-06-12: PDP-11 UNIX version 2</li>
<li>1979-06: UNIX/32V before System V</li>
<li>1983-11: SunOS 1.0</li>
<li>1989: DJGPP DOS extender before version 1.11</li>
<li>1991-09-17: Linux before version 1.2</li>
<li>1993-04-19: NetBSD before version 1.5</li>
<li>1993-11-01: FreeBSD up to 2.2 until version 2.2</li>
<li>1997-05-18: <a href="http://pdos.sourceforge.net/">PDOS32</a> 0.10</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>DEC PDP-11, DEC VAX, Motorola 68000, Intel 386 and others (Interdata 7/32, IBM 370, MIPS, SPARC)</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">a.out header</a>
<ol>
<li><a href="#">Magic numbers</a>
</li>
<li><a href="#">UNIX v1 PDP-11 a.out header</a>
</li>
<li><a href="#">UNIX 16-bit PDP-11 a.out header</a>
</li>
<li><a href="#">UNIX 32-bit a.out header</a>
<ol>
<li><a href="#">UNIX/32V for VAX</a>
</li>
<li><a href="#">System III format</a>
</li>
<li><a href="#">Ultrix</a>
</li>
<li><a href="#">SunOS</a>
</li>
<li><a href="#">Linux</a>
</li>
<li><a href="#">The BSDs</a>
</li>
</ol></li>
<li><a href="#">UNIX 32-bit Interdata 7/32 a.out header</a>
</li>
<li><a href="#">UNIX 32-bit IBM 370 a.out header</a>
</li>
<li><a href="#">UNIX 32-bit NS16032 a.out header</a>
</li>
<li><a href="#">Xenix b.out header</a>
</li>
<li><a href="#">HP-UX a.out header</a>
</li>
</ol></li>
<li><a href="#">Runtime memory layout</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>a.out header</h1>
<h3>Magic numbers</h2>
<p>The first word in an a.out file contains a 16-bit magic number, which specifies how the file should be processed, linked and loaded. The types and values have evolved through the various branches of UNIX-like systems.</p>
<p>The first versions of UNIX were produced by AT&T for the 16-bit PDP-11. Later these were ported to various 32-bit architectures, most notably the VAX, Motorola 68000 and Intel 80386. The AT&T versions progressed from version 1 to 7, after which UNIX was commercialized and sold as System III and then System V.</p>
<p>The other important branch are the BSD distributions. In this table we see mentions of versions 2.11BSD, which supported all Version 7 formats, then 3BSD, 4.1cBSD, after which the sources were reused by FreeBSD and NetBSD, OpenBSD. Linux is currently the most widely used UNIX-like system.</p>
<table border='1' align='center'>
<tr>
<td>Magic</td>
<td>Systems</td>
<td>Introduced</td>
<td>Dropped</td>
<td>Description</td></tr>
<tr>
<td><tt><sub>x</sub>00CC</tt></td>
<td>32</td>
<td>NetBSD 0.9<br>FreeBSD 2.0<br>Linux 0.99.13</td>
<td></td>
<td>(QMAGIC) compact demand load format</td></tr>
<tr>
<td><tt><sub>x</sub>0101</tt></td>
<td>16, 32</td>
<td>System III</td>
<td></td>
<td>UNIX/RT "lpd"</td></tr>
<tr>
<td><tt><sub>x</sub>0105</tt></td>
<td>16</td>
<td>Version 1</td>
<td>Version 2</td>
<td>Version 1 format</td></tr>
<tr>
<td><tt><sub>x</sub>0105</tt></td>
<td>16, 32</td>
<td>Version 7</td>
<td>4.1cBSD</td>
<td>overlay</td></tr>
<tr>
<td><tt><sub>x</sub>0107</tt></td>
<td>16, 32</td>
<td>Version 2</td>
<td></td>
<td>(OMAGIC) normal</td></tr>
<tr>
<td><tt><sub>x</sub>0108</tt></td>
<td>16, 32</td>
<td>Version 4</td>
<td></td>
<td>(NMAGIC) read-only text</td></tr>
<tr>
<td><tt><sub>x</sub>0109</tt></td>
<td>16, 32</td>
<td>Version 6</td>
<td>4.1cBSD</td>
<td>separated instruction and data</td></tr>
<tr>
<td><tt><sub>x</sub>010B</tt></td>
<td>16, 32</td>
<td>3BSD</td>
<td></td>
<td>(ZMAGIC) demand paged</td></tr>
<tr>
<td><tt><sub>x</sub>010C</tt></td>
<td>32</td>
<td>NetBSD</td>
<td></td>
<td>demand paged pure</td></tr>
<tr>
<td><tt><sub>x</sub>010C</tt></td>
<td>32</td>
<td>?</td>
<td></td>
<td>(SPRITE_ZMAGIC)</td></tr>
<tr>
<td><tt><sub>x</sub>010C</tt></td>
<td>32</td>
<td>NS16032</td>
<td></td>
<td>(XMAGIC) demand load (like ZMAGIC), locations 0-1023 unmapped</td></tr>
<tr>
<td><tt><sub>x</sub>010D</tt></td>
<td>32</td>
<td>?</td>
<td></td>
<td>(UNIX_ZMAGIC)</td></tr>
<tr>
<td><tt><sub>x</sub>010E</tt></td>
<td>32</td>
<td>NetBSD</td>
<td></td>
<td>readable demand paged pure</td></tr>
<tr>
<td><tt><sub>x</sub>0111</tt></td>
<td>32</td>
<td>Linux 0.96c</td>
<td></td>
<td>(CMAGIC) Linux core dump</td></tr>
<tr>
<td><tt><sub>x</sub>0118</tt></td>
<td>16</td>
<td>2.11</td>
<td>3BSD</td>
<td>overlay, non-separate</td></tr>
<tr>
<td><tt><sub>x</sub>0119</tt></td>
<td>16</td>
<td>2.11</td>
<td>3BSD</td>
<td>overlay, separate</td></tr>
<tr>
<td><tt><sub>x</sub>011F</tt></td>
<td>16, 32</td>
<td>System V</td>
<td></td>
<td>system overlay, separated instruction and data</td></tr>
</table>
<p>The following sections will discuss the layout of the headers of the various versions.</p>
<h3>UNIX v1 PDP-11 a.out header</h2>
<p>Version 1 had a different header format from later versions.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td><tt><sub>x</sub>0105</tt></td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Size of the combined program text (code) and initialized data segment</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Size of the symbol table</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>Relocation bits</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le</td>
<td>Size of uninitialized data (bss), not stored in binary</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i16le</td>
<td>unused</td></tr>
</table>
<h3>UNIX 16-bit PDP-11 a.out header</h2>
<p>This format was introduced in Version 2 and targetted the PDP-11 architecture.</p>
<p>The 16-bit header format evolved through various branches. Version 6 and 7 is the last common version, then it evolved separately at BSD (from 2.11BSD on) and AT&T. Version 7 was followed by System III then System V. Internally, Version 7 evolved to Version 8, 9, 10, separately from the commercial branch. These were allegedly based on the 4.1cBSD codebase and later, but the 16-bit a.out format is more similar to the commercial versions.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Magic number
<table border='1'>
<tr>
<td>0x0101</td>
<td>UNIX/RT "lpd"<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a> (System III)</td></tr>
<tr>
<td>0x0105</td>
<td>overlay<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a> (around Version 7, dropped support in 4.1cBSD<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a>)</td></tr>
<tr>
<td>0x0107</td>
<td>(OMAGIC) normal</td></tr>
<tr>
<td>0x0108</td>
<td>(NMAGIC) read-only text</td></tr>
<tr>
<td>0x0109</td>
<td>Separated instruction and data (dropped support in 4.1cBSD<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a>)</td></tr>
<tr>
<td>0x010B</td>
<td>(ZMAGIC) demand paged separated instruction and data (since 3BSD<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a>)</td></tr>
<tr>
<td>0x0118</td>
<td>2.11BSD overlay, non-separate (dropped support in 3BSD<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a>)</td></tr>
<tr>
<td>0x0119</td>
<td>2.11BSD overlay, separate (dropped support in 3BSD<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a>)</td></tr>
<tr>
<td>0x011F</td>
<td>system overlay, separated I&D (since System V)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Size of program text (code)</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Size of initialized data</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>Size of uninitialized data (bss), not stored in binary</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le</td>
<td>Size of symbol table</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i16le</td>
<td>Entry location<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a>, always 0 before version 4<a href="#UNIX2"><sup title="UNIX Programmer's Manual, Second Edition - K. Thompson, D. M. Ritchie, June 12, 1972">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i16le</td>
<td>reserved (stack required in version 2 and 3<a href="#UNIX2"><sup title="UNIX Programmer's Manual, Second Edition - K. Thompson, D. M. Ritchie, June 12, 1972">[2]</sup></a>)<br>(System III) environment stamp<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i16le</td>
<td>Non-zero if relocations have been suppressed<br>Xinu uses the least significant byte to mark Version 6 compatibility, and the most significant byte for its own flag<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
</table>
<p>Xenix also uses the System 7 format.<a href="#XENIX"><sup title="XENIX System V man page">[5]</sup></a></p>
<p>Overlays in 2.9BSD have an extended header with the following fields:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i16le</td>
<td>Maximum size of overlays</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i16le[7]</td>
<td>Size of each overlay</td></tr>
</table>
<p>They are extended in 2.11BSD to 15 overlays:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i16le</td>
<td>Maximum size of overlays</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i16le[15]</td>
<td>Size of each overlay</td></tr>
</table>
<p>Since System V, the final fields are slightly altered:<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i8</td>
<td>reserved</td></tr>
<tr>
<td><tt><sub>x</sub>0D</tt></td>	<td>i8</td>
<td>High bits of size of program text</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i8</td>
<td>Non-zero if relocations have been suppressed</td></tr>
<tr>
<td><tt><sub>x</sub>0F</tt></td>	<td>i8</td>
<td>Environment stamp</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32le</td>
<td>filler (only Version 8 and later)</td></tr>
</table>
<h3>UNIX 32-bit a.out header</h2>
<p>The first version was created for UNIX/32V for the VAX (little endian). It was later extended to other 32-bit targets as well. By System V, all 32-bit versions switched to COFF except for the IBM 370 (the Interdata 7/32 port was apparently not maintained). However, competitors to AT&T such as SunOS and the BSD variants still kept using the format.</p>
<p>While most formats had a similar layout, the first word was often subdivided into various fields for machine type and flags. Most variants use the native byte order to store the values, which further complicates determination of the file type.</p>
<h4>UNIX/32V for VAX</h3>
<p>The entries were extended from the 16-bit version to full 32 bits. Also the last two fields were replaced with the size of the relocation section for text and initialized data, respectively.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32</td>
<td>Magic number
<table border='1'>
<tr>
<td>0x00CC</td>
<td>(QMAGIC) compact demand load format (Linux, FreeBSD<a href="https://github.com/freebsd/freebsd-legacy/commit/2469c867a164210ce96143517059f21db7f1fd17" target="_blank"><sup title='since 1994-05-25'>*</sup></a>, NetBSD<a href="http://cvsweb.netbsd.org/bsdweb.cgi/src/sys/sys/exec.h?rev=1.2&content-type=text/x-cvsweb-markup" target="_blank"><sup title='since 1993-04-15'>*</sup></a>, OpenBSD)<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td>0x0101</td>
<td>UNIX/RT "lpd" (System III)</td></tr>
<tr>
<td>0x0105</td>
<td>overlay (dropped support in 4.1cBSD)</td></tr>
<tr>
<td>0x0107</td>
<td>(OMAGIC) normal (used by PDOS32 before switching to PE)</td></tr>
<tr>
<td>0x0108</td>
<td>(NMAGIC) read-only text</td></tr>
<tr>
<td>0x0109</td>
<td>separated instruction and data (dropped support in 4.1cBSD)</td></tr>
<tr>
<td>0x010B</td>
<td>(ZMAGIC) demand paged separated instruction and data (since 3BSD<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a>, used by early DJGPP)</td></tr>
<tr>
<td>0x010C</td>
<td>demand paged pure for NetBSD<a href="#MAGIC"><sup title="UNIX file magic numbers">[13]</sup></a></td></tr>
<tr>
<td>0x010C</td>
<td>(XMAGIC) demand load (like ZMAGIC), locations 0-1023 unmapped (NS16032)</td></tr>
<tr>
<td>0x010C</td>
<td>(SPRITE_ZMAGIC) ?</td></tr>
<tr>
<td>0x010D</td>
<td>(UNIX_ZMAGIC) UNIX binary compatible</td></tr>
<tr>
<td>0x010E</td>
<td>readable demand paged pure for NetBSD<a href="#MAGIC"><sup title="UNIX file magic numbers">[13]</sup></a></td></tr>
<tr>
<td>0x0111</td>
<td>(CMAGIC) core dump (Linux)<a href="#LINUX1"><sup title="a.out.h - Early Linux sources">[6]</sup></a></td></tr>
<tr>
<td>0x011F</td>
<td>system overlay, separated I&D (since System V and 3BSD)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td>Size of program text (code)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32</td>
<td>Size of initialized data</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32</td>
<td>Size of uninitialized data (bss), not stored in binary</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32</td>
<td>Size of symbol table</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32</td>
<td>Entry location</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32</td>
<td>Size of relocations for program text</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32</td>
<td>Size of relocations for initialized data</td></tr>
</table>
<h4>System III format</h3>
<p>Since System III, subfields of the extended magic number field got reused for additional information. The ways this was extended was sometimes incompatible between systems. System III VAX introduced an environment stamp, similarly to System III PDP-11 (albeit at a different position). 4.3BSD-Reno also switched over to this format for non-VAX targets, possibly to stay compatible with SunOS, and early NetBSD kept this format.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32</td>
<td>
<table border='1'>
<tr>
<td>Bits 0:15</td>
<td>Magic number</td></tr>
<tr>
<td>Bits 16:31</td>
<td>Environment stamp (System III VAX)<br>Machine type (4.3BSD-Reno)</td></tr>
</table>
</td></tr>
</table>
<h4>Ultrix</h3>
<p>Ultrix had a different use for the new field:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32</td>
<td>
<table border='1'>
<tr>
<td>Bits 0:15</td>
<td>Magic number</td></tr>
<tr>
<td>Bits 16:31</td>
<td>Mode (Ultrix)
<table border='1'>
<tr>
<td>0x0000</td>
<td>BSD executable</td></tr>
<tr>
<td>0x0001</td>
<td>System V compatible executable</td></tr>
<tr>
<td>0x0002</td>
<td>POSIX compatible executable</td></tr>
</table>
</td></tr>
</table>
</td></tr>
</table>
<h4>SunOS</h3>
<p>SunOS versions had a different format for the first word:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32</td>
<td>
<table border='1'>
<tr>
<td>Bits 0:15</td>
<td>Magic number</td></tr>
<tr>
<td>Bits 16:23</td>
<td>Machine type</td></tr>
<tr>
<td>Bits 24:30</td>
<td>Tool version</td></tr>
<tr>
<td>Bit 31</td>
<td>Dynamic</td></tr>
</table>
</td></tr>
</table>
<p>Sun 4 also offered a few additional fields:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32</td>
<td>Size of string segment</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i32</td>
<td>Size of sdata segment</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i32</td>
<td>Size of sdata relocations</td></tr>
<tr>
<td><tt><sub>x</sub>2C</tt></td>	<td>i32</td>
<td>0 (spare segment)</td></tr>
<tr>
<td><tt><sub>x</sub>30</tt></td>	<td>i32</td>
<td>0 (spare segment)</td></tr>
<tr>
<td><tt><sub>x</sub>34</tt></td>	<td>i32</td>
<td>0 (spare segment)</td></tr>
<tr>
<td><tt><sub>x</sub>38</tt></td>	<td>i32</td>
<td>0 (spare segment)</td></tr>
<tr>
<td><tt><sub>x</sub>3C</tt></td>	<td>i32</td>
<td>0 (spare segment)</td></tr>
</table>
<h4>Linux</h3>
<p>Linux used the following format:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32</td>
<td>
<table border='1'>
<tr>
<td>Bits 0:15</td>
<td>Magic number</td></tr>
<tr>
<td>Bits 16:23</td>
<td>Machine type</td></tr>
<tr>
<td>Bits 24:31</td>
<td>Flags (Linux)</td></tr>
</table>
</td></tr>
</table>
<h4>The BSDs</h3>
<p>4.4BSD-Lite2<a href="#44BSDLite2"><sup title="https://github.com/sergev/4.4BSD-Lite2">[14]</sup></a> used different versions for different targets: it used the UNIX/32V VAX version for VAX and Intel 386, the SunOS version (without additional fields) for SPARC, the System III format with machine type for HP300 and MIPS, and COFF for other systems.</p>
<p>Since FreeBSD 2.0 and NetBSD 0.9, the following layout is used for the magic number field. FreeBSD prior to 2.0 for all ports and NetBSD prior to 0.9 on VAX and 386 used the UNIX/32V VAX format.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32</td>
<td>
<table border='1'>
<tr>
<td>Bits 0:15</td>
<td>Magic number</td></tr>
<tr>
<td>Bits 16:25</td>
<td>Machine type
<table border='1'>
<tr>
<td>0x0000</td>
<td>unknown, old Sun-2</td></tr>
<tr>
<td>0x0001</td>
<td>SunOS, 68010+</td></tr>
<tr>
<td>0x0002</td>
<td>SunOS, 68020</td></tr>
<tr>
<td>0x0003</td>
<td>SunOS, SPARC (likely 4.0.3)</td></tr>
<tr>
<td>0x0064</td>
<td>Intel 80386 for PC (4.4BSD, Linux, FreeBSD, NetBSD, OpenBSD)</td></tr>
<tr>
<td>0x0065</td>
<td>AMD 29000 (4.4BSD)</td></tr>
<tr>
<td>0x0068</td>
<td>old IBM RT (OpenBSD)</td></tr>
<tr>
<td>0x0086</td>
<td>Intel 80386 BSD (FreeBSD, NetBSD, OpenBSD)</td></tr>
<tr>
<td>0x0087</td>
<td>Motorola 68K BSD with 8K pages (NetBSD, OpenBSD)</td></tr>
<tr>
<td>0x0088</td>
<td>Motorola 68K BSD with 4K pages (NetBSD, OpenBSD)</td></tr>
<tr>
<td>0x0089</td>
<td>National Semiconductor NS32532 (NetBSD, OpenBSD)</td></tr>
<tr>
<td>0x008A</td>
<td>Intel SPARC BSD (FreeBSD<a href="https://github.com/freebsd/freebsd-legacy/commit/9391975ae6f63570cc6e176352c93a0d4ddadf52" target="_blank"><sup title='since at least 1994-09-24'>*</sup></a>, NetBSD, OpenBSD)</td></tr>
<tr>
<td>0x008B</td>
<td>PMAX (MIPS R2000 based DECstation) (NetBSD, OpenBSD)</td></tr>
<tr>
<td>0x008C</td>
<td>VAX with 1K pages (NetBSD, OpenBSD)</td></tr>
<tr>
<td>0x008D</td>
<td>MIPS big endian (NetBSD, OpenBSD)</td></tr>
<tr>
<td>0x008D</td>
<td>Alpha code (NetBSD)<a href="#MAGIC"><sup title="UNIX file magic numbers">[13]</sup></a></td></tr>
<tr>
<td>0x008E</td>
<td>MIPS (NetBSD)<a href="#MAGIC"><sup title="UNIX file magic numbers">[13]</sup></a></td></tr>
<tr>
<td>0x008F</td>
<td>ARM6 (FreeBSD<a href="https://github.com/freebsd/freebsd-legacy/commit/7806cc81b8b8e21bbf283fba04d3b4c941741bef" target="_blank"><sup title='since 2004-05-05, note ARM specific definitions were present since 2001-01-04'>*</sup></a>, NetBSD, OpenBSD)</td></tr>
<tr>
<td>0x0090</td>
<td>Motorola 68K with 2K pages (NetBSD)</td></tr>
<tr>
<td>0x0091</td>
<td>SH3 (NetBSD, OpenBSD)</td></tr>
<tr>
<td>0x0094</td>
<td>PowerPC 64-bit big endian (NetBSD)</td></tr>
<tr>
<td>0x0095</td>
<td>PowerPC big endian (NetBSD, OpenBSD)</td></tr>
<tr>
<td>0x0096</td>
<td>VAX (NetBSD, OpenBSD)</td></tr>
<tr>
<td>0x0097</td>
<td>MIPS I R2000/R3000 (4.4BSD, NetBSD, Linux 1.3.48)</td></tr>
<tr>
<td>0x0097</td>
<td>SPARC 64-bit (OpenBSD)</td></tr>
<tr>
<td>0x0098</td>
<td>MIPS II (4.4BSD, NetBSD, OpenBSD)<br>(<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a> claims R4000 but actually that was MIPS III, this should be R6000)</td></tr>
<tr>
<td>0x0099</td>
<td>Motorola 88K BSD (NetBSD, OpenBSD)</td></tr>
<tr>
<td>0x009A</td>
<td>HP PA-RISC (NetBSD, OpenBSD)</td></tr>
<tr>
<td>0x009B</td>
<td>SH5 with LP64 model (NetBSD)</td></tr>
<tr>
<td>0x009C</td>
<td>SPARC with LP64 model (NetBSD)</td></tr>
<tr>
<td>0x009D</td>
<td>AMD64/x86-64 (NetBSD, OpenBSD)</td></tr>
<tr>
<td>0x009E</td>
<td>SH5 with ILP32 model (NetBSD)</td></tr>
<tr>
<td>0x009E</td>
<td>MIPS 64-bit big endian (OpenBSD)</td></tr>
<tr>
<td>0x009F</td>
<td>Intel Itanium (NetBSD)</td></tr>
<tr>
<td>0x009F</td>
<td>AArch64/ARM64 (OpenBSD)</td></tr>
<tr>
<td>0x00A0</td>
<td>PowerPC 64-bit big endian (OpenBSD)</td></tr>
<tr>
<td>0x00A1</td>
<td>RISC-V 64-bit little endian (OpenBSD)</td></tr>
<tr>
<td>0x00B7</td>
<td>AArch64/ARM64 (NetBSD)</td></tr>
<tr>
<td>0x00B8</td>
<td>OpenRISC 1000 (NetBSD)</td></tr>
<tr>
<td>0x00B9</td>
<td>RISC-V (NetBSD)</td></tr>
<tr>
<td>0x00C8</td>
<td>HP200 68010 (4.3BSD, FreeBSD, NetBSD)</td></tr>
<tr>
<td>0x012C</td>
<td>HP300 68020+68881 (4.3BSD, FreeBSD, NetBSD)</td></tr>
<tr>
<td>0x0208</td>
<td>HP s500<a href="#MAGIC"><sup title="UNIX file magic numbers">[13]</sup></a></td></tr>
<tr>
<td>0x020A</td>
<td>HP s200 2.x<a href="#MAGIC"><sup title="UNIX file magic numbers">[13]</sup></a></td></tr>
<tr>
<td>0x020B</td>
<td>HP/UX HP800 (4.3BSD, FreeBSD, NetBSD), PA-RISC1.0<a href="#MAGIC"><sup title="UNIX file magic numbers">[13]</sup></a></td></tr>
<tr>
<td>0x020C</td>
<td>HP/UX HP200 or HP300 (4.3BSD, NetBSD), PA-RISC1.0 (OpenBSD), HP s200<a href="#MAGIC"><sup title="UNIX file magic numbers">[13]</sup></a></td></tr>
<tr>
<td>0x0210</td>
<td>HP700 HP-UX PA-RISC1.1 (OpenBSD)<a href="#MAGIC"><sup title="UNIX file magic numbers">[13]</sup></a></td></tr>
<tr>
<td>0x0214</td>
<td>HP700 HP-UX PA-RISC2.0 (OpenBSD)<a href="#MAGIC"><sup title="UNIX file magic numbers">[13]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td>Bits 26:31</td>
<td>Flags (FreeBSD)<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td>Bit 30</td>
<td>Position independent code (FreeBSD, NetBSD)</td></tr>
<tr>
<td>Bit 31</td>
<td>Dynamic (SunOS, unknown version?, FreeBSD, NetBSD, OpenBSD)</td></tr>
</table>
</td></tr>
</table>
<p>In NetBSD and OpenBSD, the fields are in the native byte order, except for the magic number which is in the big endian ("network") format (most significant byte first, like the Motorola 68000). As an exception, on little endian machines, little endian order is allowed if the machine type field and flags are 0.</p>
<p>In FreeBSD since <a href="https://github.com/freebsd/freebsd-legacy/commit/8abf9484aa165999b93d86ff28183b14db4f75ab" target="_blank">2004-06-22</a>, entries are always stored in the little endian format (least significant byte first, like the VAX and Intel 80386). However since <a href="https://github.com/freebsd/freebsd-legacy/commit/2469c867a164210ce96143517059f21db7f1fd17" target="_blank">1994-05-25</a> it recognizes big endian entries for the magic number (the other entries are still read in the little endian order).</p>
<h3>UNIX 32-bit Interdata 7/32 a.out header</h2>
<p>This version was introduced in Version 7 for the Interdata 7/32 (big endian). It is identical to the PDP-11 version, except that the word sizes are 32-bit and the byte order is big endian.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32be</td>
<td>Magic number</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td>Size of program text (code)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32be</td>
<td>Size of initialized data</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32be</td>
<td>Size of uninitialized data (bss), not stored in binary</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32be</td>
<td>Size of symbol table</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32be</td>
<td>Entry location</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32be</td>
<td>reserved</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32be</td>
<td>Non-zero if relocations have been suppressed</td></tr>
</table>
<h3>UNIX 32-bit IBM 370 a.out header</h2>
<p>This version was introduced in System V for the IBM 370 (big endian). It is a variant of the VAX format.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32be</td>
<td>Magic number</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td>Stamp</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32be</td>
<td>Size of program text (code)</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32be</td>
<td>Size of initialized data</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32be</td>
<td>Size of uninitialized data (bss), not stored in binary</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32be</td>
<td>Size of symbol table</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32be</td>
<td>Entry location</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32be</td>
<td>Size of relocations for program text</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32be</td>
<td>Size of relocations for initialized data</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i32be</td>
<td>Starting address of binary image</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i32be</td>
<td>Size of program text without padding to page boundary</td></tr>
<tr>
<td><tt><sub>x</sub>2C</tt></td>	<td>i32be</td>
<td>Size of initialized data without padding to page boundary</td></tr>
</table>
<h3>UNIX 32-bit NS16032 a.out header</h2>
<p>There was a different version for National Semiconductor NS32K executables (little endian).</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>Magic number</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>Size of program text (code)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32le</td>
<td>Size of initialized data</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32le</td>
<td>Size of uninitialized data (bss), not stored in binary</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32le</td>
<td>Size of symbol table</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32le</td>
<td>Entry location</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32le</td>
<td>Entry mod</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32le</td>
<td>Size of relocations for program text</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32le</td>
<td>Size of relocations for initialized data</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i32le</td>
<td>Size of mod table, part of program text</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i32le</td>
<td>Size of link table, part of program text</td></tr>
<tr>
<td><tt><sub>x</sub>2C</tt></td>	<td>i32le</td>
<td>Size of string table</td></tr>
</table>
<h3>Xenix b.out header</h2>
<p>The Xenix b.out header is very similar to the 32-bit VAX a.out header, with the field order slightly changed:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32</td>
<td>Magic number</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td>Size of program text (code)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32</td>
<td>Size of initialized data</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32</td>
<td>Size of uninitialized data (bss), not stored in binary</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32</td>
<td>Size of symbol table</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32</td>
<td>Size of relocations for program text</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32</td>
<td>Size of relocations for initialized data</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32</td>
<td>Entry location</td></tr>
</table>
<h3>HP-UX a.out header</h2>
<p>HP-UX used a different format for a.out.<a href="#44BSDLite2"><sup title="https://github.com/sergev/4.4BSD-Lite2">[14]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32be</td>
<td>Magic number</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16be</td>
<td>Version ID</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16be</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32be</td>
<td>Miscellaneous information</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32be</td>
<td>Size of program text (code)</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32be</td>
<td>Size of initialized data</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32be</td>
<td>Size of uninitialized data (bss), not stored in binary</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32be[5]</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>2C</tt></td>	<td>i32be</td>
<td>Entry location</td></tr>
<tr>
<td><tt><sub>x</sub>30</tt></td>	<td>i32be[4]</td>
<td>Reserved</td></tr>
</table>
<h2>Runtime memory layout</h1>
<p>This section requires further work.</p>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="https://github.com/DoctorWkt/Apout" target='_blank'>Warren Toomey: Apout -- Simulate PDP-11 Unix a.out binaries</a></li>
<li>[2] UNIX Programmer's Manual, Second Edition - K. Thompson, D. M. Ritchie, June 12, 1972</li>
<li>[3] <a href="https://www.tuhs.org/cgi-bin/utree.pl" target='_blank'>The Unix Tree</a></li>
<li>[4] <a href="https://github.com/386bsd/386bsd/blob/2.0/usr/src/kernel/include/sys/exec.h" target='_blank'>exec.h - 386BSD sources</a></li>
<li>[5] <a href="http://www.polarhome.com/service/man/?qf=a.out&tf=2&of=Xenix&sf=F" target='_blank'>XENIX System V man page</a></li>
<li>[6] <a href="https://elixir.bootlin.com/linux/1.0/source/include/linux/a.out.h" target='_blank'>a.out.h - Early Linux sources</a></li>
<li>[7] <a href="https://elixir.bootlin.com/linux/v6.7-rc1/source/include/uapi/linux/a.out.h" target='_blank'>a.out.h - Linux 6.7 RC1 sources</a></li>
<li>[8] <a href="https://github.com/FreeBSDDesktop/freebsd-base/blob/master/sys/sys/imgact_aout.h" target='_blank'>imgact_aout.h - FreeBSD sources</a></li>
<li>[9] <a href="https://github.com/freebsd/freebsd-legacy/tree/master" target='_blank'>https://github.com/freebsd/freebsd-legacy/tree/master</a></li>
<li>[10] <a href="http://cvsweb.netbsd.org/bsdweb.cgi/src/sys/sys/exec_aout.h?rev=1.41&content-type=text/x-cvsweb-markup&only_with_tag=netbsd-9-3-RELEASE" target='_blank'>exec_aout.h - NetBSD sources</a></li>
<li>[11] <a href="http://cvsweb.netbsd.org/bsdweb.cgi/src/sys/sys/aout_mids.h?rev=1.7&content-type=text/x-cvsweb-markup&only_with_tag=netbsd-9-3-RELEASE" target='_blank'>aout_mids.h - NetBSD sources</a></li>
<li>[12] <a href="https://github.com/openbsd/src/blob/master/sys/sys/exec.h" target='_blank'>exec.h - OpenBSD sources</a></li>
<li>[13] UNIX file magic numbers</li>
<li>[14] <a href="https://github.com/sergev/4.4BSD-Lite2" target='_blank'>https://github.com/sergev/4.4BSD-Lite2</a></li>
</ul>
<hr/>
<h1 id="aout_minix">MINIX a.out file format</h1>
<dl>
<dt>File extensions</td>
<dd>&mdash;</dd>
<dl>
<dt>Magic code</td>
<dd><tt><sub>x</sub>01<sub>x</sub>03</tt></dd>
<dl>
<dt>Architecture</td>
<dd>various, typically Intel 8086/80286, Intel 80386, Motorola 68000, SPARC</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>1987: MINIX 1.0 before version 3.2</li>
<li>1999-05-20: ELKS (Linux-8086)</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>various, typically Intel 8086/80286, Intel 80386, Motorola 68000, SPARC</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#header">Header</a>
</li><li><a href="#_references">References</a></li>
</ol>
<a id="header"/>
<h2>Header</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8[2]</td>
<td><tt><sub>x</sub>01</tt>, <tt><sub>x</sub>03</tt></td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i8</td>
<td>Flags (<tt><sub>x</sub>10</tt> for combined text/data executables, <tt><sub>x</sub>20</tt> for split text/data executables)
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Unmapped zero page</td></tr>
<tr>
<td>Bit 1</td>
<td>Page aligned</td></tr>
<tr>
<td>Bit 2</td>
<td>New style symbol table</td></tr>
<tr>
<td>Bit 4</td>
<td>Executable</td></tr>
<tr>
<td>Bit 5</td>
<td>Separate instruction/data space</td></tr>
<tr>
<td>Bit 6</td>
<td>Pure text (not used)</td></tr>
<tr>
<td>Bit 7</td>
<td>Text overlay (not used)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>i8</td>
<td>CPU<br>Bit 0 encodes byte order in 16-bit word: 0 for little endian, 1 for big endian<br>Bit 1 encodes 16-bit word order in 32-bit longword: 0 for little endian, 1 for big endian
<table border='1'>
<tr>
<td>0x00</td>
<td>Unknown</td></tr>
<tr>
<td>0x04</td>
<td>Intel 8086</td></tr>
<tr>
<td>0x0B</td>
<td>Motorola 68000</td></tr>
<tr>
<td>0x0C</td>
<td>National Semiconductor 16032 (32016)</td></tr>
<tr>
<td>0x10</td>
<td>Intel 80368</td></tr>
<tr>
<td>0x17</td>
<td>Sun SPARC</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i8</td>
<td>Length of header, should be <tt><sub>x</sub>20</tt> or <tt><sub>x</sub>30</tt></td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i8</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16</td>
<td>Version stamp (unused)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32</td>
<td>Size of text segment</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32</td>
<td>Size of data segment</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32</td>
<td>Size of bss segment</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32</td>
<td>Entry point</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32</td>
<td>Total memory allocated, including heap</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32</td>
<td>Size of symbol table</td></tr>
</table>
<p>The following fields are optional and only appear for a header of length <tt><sub>x</sub>30</tt>.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32</td>
<td>Size of text relocations</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i32</td>
<td>Size of data relocations</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i32</td>
<td>Base of text relocations</td></tr>
<tr>
<td><tt><sub>x</sub>2C</tt></td>	<td>i32</td>
<td>Base of data relocations</td></tr>
</table>
<a id="_references"/>
<h2>References</h1>
<ul>
</ul>
<hr/>
<h1 id="coff">COFF format (Common Object File Format)</h1>
<dl>
<dt>File extensions</td>
<dd>&mdash;</dd>
<dl>
<dt>Magic code</td>
<dd>various, encodes architecture</dd>
<dl>
<dt>Architecture</td>
<dd>various</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>1983-01: UNIX System V Release 1.0</li>
<li>1985: Concurrent DOS 68K</li>
<li>1987-06: FlexOS 386</li>
<li>Around 1992: DJGPP DOS extender version 1.11</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>various</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#filehdr">File header</a>
<ol>
<li><a href="#">ECOFF file header</a>
</li>
<li><a href="#">XCOFF64 file header</a>
</li>
</ol></li>
<li><a href="#opthdr">Optional header</a>
<ol>
<li><a href="#">3B20 optional header</a>
</li>
<li><a href="#">NS32000 fields</a>
</li>
<li><a href="#">Concurrent DOS additional fields</a>
</li>
<li><a href="#">GNU_AOUT header fields</a>
</li>
<li><a href="#">Additional optional header fields for MIPS</a>
</li>
<li><a href="#">ECOFF optional header</a>
</li>
<li><a href="#">XCOFF32 additional fields</a>
</li>
<li><a href="#">XCOFF64 format</a>
</li>
</ol></li>
<li><a href="#secthdr">Section header</a>
<ol>
<li><a href="#">ECOFF section header</a>
</li>
<li><a href="#">XCOFF64 section header</a>
</li>
</ol></li>
<li><a href="#relocs">Relocation information</a>
<ol>
<li><a href="#">Concurrent DOS 68K relocation information</a>
</li>
</ol></li>
<li><a href="#linenos">Line numbers</a>
</li>
<li><a href="#symtab">Symbol table</a>
</li>
<li><a href="#strtab">String table</a>
</li>
<li><a href="#">Further work</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<table border='1' align='center'>
<tr>
<td>Optional MZ stub (DJGPP only)</td></tr>
<tr>
<td><a href="#filehdr">File header</a></td></tr>
<tr>
<td><a href="#opthdr">Optional header</a> (executables only)</td></tr>
<tr>
<td><a href="#secthdr">Section header</a></td></tr>
<tr>
<td>Section data</td></tr>
<tr>
<td><a href="#relocs">Relocation information</a></td></tr>
<tr>
<td><a href="#linenos">Line numbers</a></td></tr>
<tr>
<td><a href="#symtab">Symbol table</a></td></tr>
<tr>
<td><a href="#strtab">String table</a></td></tr>
</table>
<a id="filehdr"/>
<h2>File header</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16</td>
<td>f_magic, Magic number
<table border='1'>
<tr>
<td><tt><sub>x</sub>014C</tt></td>
<td><tt><sub>x</sub>4C</tt> <tt><sub>x</sub>01</tt></td>
<td>(SVR4) Intel 80386 programs<a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a><a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a> (used by DJGPP, reserved for Intel since SVR3)</td></tr>
<tr>
<td><tt><sub>x</sub>0150</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>50</tt></td>
<td>(SVR2) Motorola 68000<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a><a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a> (used by Concurrent DOS 68K)<br>Motorola MC68000<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0088</tt></td>
<td><tt><sub>x</sub>00</tt> <tt><sub>x</sub>88</tt></td>
<td>(SVR2) Motorola 68000<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0089</tt></td>
<td><tt><sub>x</sub>00</tt> <tt><sub>x</sub>89</tt></td>
<td>(SVR2) Motorola 68000 pure text<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0093</tt></td>
<td><tt><sub>x</sub>00</tt> <tt><sub>x</sub>93</tt></td>
<td>(Sun 4.1.4) "C30" magic<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0101</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>01</tt></td>
<td>(Magic number for a.out PDP-11 "UNIX-rt ldp"<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>0105</tt></td>
<td><tt><sub>x</sub>05</tt> <tt><sub>x</sub>01</tt></td>
<td>(Magic number for a.out PDP-11 overlay<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>0107</tt></td>
<td><tt><sub>x</sub>07</tt> <tt><sub>x</sub>01</tt></td>
<td>(Magic number for a.out PDP-11, pre-System V VAX executable<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>0108</tt></td>
<td><tt><sub>x</sub>08</tt> <tt><sub>x</sub>01</tt></td>
<td>(Magic number for a.out PDP-11, pre-System V VAX executable, pure<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>0109</tt></td>
<td><tt><sub>x</sub>09</tt> <tt><sub>x</sub>01</tt></td>
<td>(Magic number for a.out PDP-11 separate I&D<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>011F</tt></td>
<td><tt><sub>x</sub>1F</tt> <tt><sub>x</sub>01</tt></td>
<td>(Magic number for a.out PDP-11 kernel overlay<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>0140</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>40</tt></td>
<td>ECOFF MIPSEB, MIPS III<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0140</tt></td>
<td><tt><sub>x</sub>40</tt> <tt><sub>x</sub>01</tt></td>
<td>ECOFF MIPSEB-LE, MIPS III<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0142</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>42</tt></td>
<td>ECOFF MIPSEL-BE, MIPS III<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0142</tt></td>
<td><tt><sub>x</sub>42</tt> <tt><sub>x</sub>01</tt></td>
<td>ECOFF MIPSEL, MIPS III<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0142</tt></td>
<td><tt><sub>x</sub>42</tt> <tt><sub>x</sub>01</tt></td>
<td>(SVR1) Intel x86 "Basic-16"<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0143</tt></td>
<td><tt><sub>x</sub>43</tt> <tt><sub>x</sub>01</tt></td>
<td>(SVR1) Intel x86 "Basic-16" pure text<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0144</tt></td>
<td><tt><sub>x</sub>44</tt> <tt><sub>x</sub>01</tt></td>
<td>(SVR3) Intel x86 "IAPX16" (used with cross compilers)<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0145</tt></td>
<td><tt><sub>x</sub>45</tt> <tt><sub>x</sub>01</tt></td>
<td>(SVR3) Intel x86 "IAPX16" pure text (used with cross compilers)<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0146</tt></td>
<td><tt><sub>x</sub>46</tt> <tt><sub>x</sub>01</tt></td>
<td>(SVR3) Intel x86 "IAPX20" (used with cross compilers)<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0147</tt></td>
<td><tt><sub>x</sub>47</tt> <tt><sub>x</sub>01</tt></td>
<td>(SVR3) Intel x86 "IAPX20" pure text (used with cross compilers)<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0148</tt></td>
<td><tt><sub>x</sub>48</tt> <tt><sub>x</sub>01</tt></td>
<td>(SVR1) Intel x86<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0148</tt></td>
<td><tt><sub>x</sub>48</tt> <tt><sub>x</sub>01</tt></td>
<td>(Mach92) National Semiconductor NS160000</td></tr>
<tr>
<td><tt><sub>x</sub>0149</tt></td>
<td><tt><sub>x</sub>49</tt> <tt><sub>x</sub>01</tt></td>
<td>(SVR1) Intel x86 pure text<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>014A</tt></td>
<td><tt><sub>x</sub>4A</tt> <tt><sub>x</sub>01</tt></td>
<td>(SVR3) Intel 80286 small model program<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>014D</tt></td>
<td></td>
<td>(SVR4) Intel i860</td></tr>
<tr>
<td><tt><sub>x</sub>014D</tt></td>
<td><tt><sub>x</sub>4D</tt> <tt><sub>x</sub>01</tt></td>
<td>(Mach92) National Semiconductor NS160000 pure text</td></tr>
<tr>
<td><tt><sub>x</sub>014E</tt></td>
<td><tt><sub>x</sub>4E</tt> <tt><sub>x</sub>01</tt></td>
<td>(SVR3) Reserved for Intel<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>014F</tt></td>
<td><tt><sub>x</sub>4F</tt> <tt><sub>x</sub>01</tt></td>
<td>(SVR3) Reserved for Intel<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0151</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>51</tt></td>
<td>(SVR2) Motorola MC68000 pure text<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0152</tt></td>
<td><tt><sub>x</sub>52</tt> <tt><sub>x</sub>01</tt></td>
<td>(SVR3) Intel 80286 large model program<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0152</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>52</tt></td>
<td>(SVR3) Motorola MC68000 demand paged text segment<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0154</tt></td>
<td><tt><sub>x</sub>54</tt> <tt><sub>x</sub>01</tt></td>
<td>(SVR3) Reserved for National Semiconductor<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0154</tt></td>
<td><tt><sub>x</sub>54</tt> <tt><sub>x</sub>01</tt></td>
<td>(Mach92) National Semiconductor NS32000</td></tr>
<tr>
<td><tt><sub>x</sub>0154</tt></td>
<td><tt><sub>x</sub>54</tt> <tt><sub>x</sub>01</tt></td>
<td>Linux 2.6.33.2 unused but mentioned for 386 PTX<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0155</tt></td>
<td><tt><sub>x</sub>55</tt> <tt><sub>x</sub>01</tt></td>
<td>(SVR3) Reserved for National Semiconductor<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0155</tt></td>
<td><tt><sub>x</sub>55</tt> <tt><sub>x</sub>01</tt></td>
<td>(Mach92) National Semiconductor NS32000 pure text</td></tr>
<tr>
<td><tt><sub>x</sub>0158</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>58</tt></td>
<td>(SVR2) IBM 370<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0159</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>59</tt></td>
<td>(SVR3) Amdahl 470/580<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>015A</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>5A</tt></td>
<td>(SVR3) Reserved for IBM 370</td></tr>
<tr>
<td><tt><sub>x</sub>015B</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>5B</tt></td>
<td>(SVR3) Reserved for IBM 370</td></tr>
<tr>
<td><tt><sub>x</sub>015C</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>5C</tt></td>
<td>(SVR3) Amdahl 470/580 pure text segments<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>015D</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>5D</tt></td>
<td>(SVR2) IBM 370 pure text<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0160</tt></td>
<td></td>
<td>(SVR2 only) XL<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0160</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>60</tt></td>
<td>ECOFF MIPSEB<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0160</tt></td>
<td><tt><sub>x</sub>60</tt> <tt><sub>x</sub>01</tt></td>
<td>ECOFF MIPSEB-LE<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0160</tt></td>
<td></td>
<td>(OpenBSD 4.6) i960<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0161</tt></td>
<td></td>
<td>(OpenBSD 4.6) i960 pure<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0162</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>62</tt></td>
<td>ECOFF MIPSEL-BE<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0162</tt></td>
<td><tt><sub>x</sub>62</tt> <tt><sub>x</sub>01</tt></td>
<td>ECOFF MIPSEL<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0163</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>63</tt></td>
<td>ECOFF MIPSEB MIPS II<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0163</tt></td>
<td><tt><sub>x</sub>63</tt> <tt><sub>x</sub>01</tt></td>
<td>ECOFF MIPSEB-LE MIPS II<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0164</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>64</tt></td>
<td>(SVR3) Reserved for Zilog<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a> (presumably the Z8000/Z80000)</td></tr>
<tr>
<td><tt><sub>x</sub>0165</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>65</tt></td>
<td>(SVR3) Reserved for Zilog<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a> (presumably the Z8000/Z80000)</td></tr>
<tr>
<td><tt><sub>x</sub>0166</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>66</tt></td>
<td>ECOFF MIPSEL-BE MIPS II<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0166</tt></td>
<td><tt><sub>x</sub>66</tt> <tt><sub>x</sub>01</tt></td>
<td>ECOFF MIPSEL MIPS II<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0168</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>68</tt></td>
<td>(SVR1) AT&T 3B20<a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0168</tt></td>
<td><tt><sub>x</sub>68</tt> <tt><sub>x</sub>01</tt></td>
<td>(NetBSD 5.0.2) SH3 little endian<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0169</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>69</tt></td>
<td>(SVR1) AT&T 3B20 pure text<a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>016C</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>6C</tt></td>
<td>UniSoft 68K Binary Compatibility Standard<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>016D</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>6D</tt></td>
<td>UniSoft 88K Binary Compatibility Standard<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0170</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>70</tt></td>
<td>(SVR1) AT&T 3B2, 3B15<a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a>, WE 32000<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a>, MAC-80/MAC-32</td></tr>
<tr>
<td><tt><sub>x</sub>0171</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>71</tt></td>
<td>(SVR1) AT&T 3B2, 3B15, WE 32000 pure text<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a>, MAC-80/MAC-32</td></tr>
<tr>
<td><tt><sub>x</sub>0172</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>72</tt></td>
<td>(SVR2) Reserved for AT&T 3B2, 3B15, WE 32000 pure text<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a>, MAC-80/MAC-32</td></tr>
<tr>
<td><tt><sub>x</sub>0175</tt></td>
<td><tt><sub>x</sub>75</tt> <tt><sub>x</sub>01</tt></td>
<td>(OpenBSD 4.6) 386 Danbury AIX C<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0178</tt></td>
<td><tt><sub>x</sub>78</tt> <tt><sub>x</sub>01</tt></td>
<td>(SVR1) VAX<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>017A</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>7A</tt></td>
<td>(OpenBSD 4.6) Am29K big endian<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>017B</tt></td>
<td><tt><sub>x</sub>7B</tt> <tt><sub>x</sub>01</tt></td>
<td>(OpenBSD 4.6) Am29K little endian<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>017D</tt></td>
<td><tt><sub>x</sub>7D</tt> <tt><sub>x</sub>01</tt></td>
<td>(SVR1) VAX pure text<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a>, CLIPPER (VAX)<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>017F</tt></td>
<td></td>
<td>CLIPPER<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0180</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>80</tt></td>
<td>ECOFF MIPSEB u-code<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0182</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>82</tt></td>
<td>ECOFF MIPSEL-BE u-code<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0183</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>83</tt></td>
<td>ECOFF Alpha for Digital UNIX<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a><a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0185</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>85</tt></td>
<td>ECOFF NetBSD Alpha<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0188</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>88</tt></td>
<td>ECOFF Alpha compressed COFF<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a><a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>018F</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>8F</tt></td>
<td>ECOFF Alpha u-code object<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a>, obsolete<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0194</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>94</tt></td>
<td>Apollo Motorola 88K COFF<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0197</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>97</tt></td>
<td>Apollo Motorola 68K COFF<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>01DF</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>DF</tt></td>
<td>XCOFF 32-bit PowerPC<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>01F7</tt></td>
<td><tt><sub>x</sub>01</tt> <tt><sub>x</sub>F7</tt></td>
<td>XCOFF 64-bit PowerPC<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>1572</tt></td>
<td><tt><sub>x</sub>15</tt> <tt><sub>x</sub>72</tt></td>
<td>Am29K "prebar"<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>521C</tt></td>
<td><tt><sub>x</sub>1C</tt> <tt><sub>x</sub>52</tt></td>
<td>DSP21k<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a><br>SHARC<a href="#MAGIC"><sup title="UNIX file magic numbers">[7]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16</td>
<td>f_nscns, Number of Sections</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td>f_timdat, Time stamp, (CDOS COFF utility<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>: 0)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32</td>
<td>f_symptr, Offset to symbol table (CDOS COFF utility<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>: 0)</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32</td>
<td>f_nsyms, Number of symbols in symbol table (CDOS COFF utility<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>: 0)</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i16</td>
<td>f_opthdr, Size of optional header
<table border='1'>
<tr>
<td>28</td>
<td>Standard UNIX a.out header (AOUTHDR)<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a><a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a> (used by DJGPP<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a>)</td></tr>
<tr>
<td>32</td>
<td>GNU extensions (GNU_AOUT)<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a></td></tr>
<tr>
<td>36</td>
<td>CDOS coff utility<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i16</td>
<td>f_flags, Flags (CDOS utility: <tt><sub>x</sub>020F</tt>)
<table border='1'>
<tr>
<td>Bit 0</td>
<td>F_RELFLG, No relocations<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a><a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a><a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>, also in XCOFF<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a> and ECOFF<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td>Bit 1</td>
<td>F_EXEC, No unresolved symbols, executable<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a><a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a><a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>, also in XCOFF<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a> and ECOFF<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td>Bit 2</td>
<td>F_LNNO, No line number information<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a><a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a><a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>, also in XCOFF<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a> and ECOFF<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td>Bit 3</td>
<td>F_LSYMS, No local symbols<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a><a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a><a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>, also in XCOFF<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a> and ECOFF<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td>Bit 4</td>
<td>F_MINMAL, "minimal object file"<a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a>, produced by <tt>fextract</tt><a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><br>F_FDPR_PROF (XCOFF), profiled using <tt>fdpr</tt><a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a><br>F_NO_SHARED (ECOFF), unused<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td>Bit 5</td>
<td>F_UPDATE, "update file", produced by <tt>ogen</tt><a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><br>F_FDPR_OPTI (XCOFF), reordered using <tt>fdpr</tt><a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a><br>F_NO_CALL_SHARED (ECOFF), cannot be used to create dynamic executable file<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td>Bit 6</td>
<td>F_SWABD, file is "pre-swabbed"<a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a>, in name<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><br>F_DSA (XCOFF), very large program support<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a><br>F_LOMAP (ECOFF), static executable may be loaded below VM_MIN_ADDRESS (<tt><sub>x</sub>10000</tt>), invalid for dynamic executables<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td>Bit 7</td>
<td>F_AR16WR, Little endian, 16-bit (like PDP-11/70)<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a><a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><br>F_DEP_1 (XCOFF), data-execute permissions<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a></td></tr>
<tr>
<td>Bit 8</td>
<td>F_AR32WR, Little endian, 32-bit (like VAX)<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a><a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a><br>F_VARPG (XCOFF), the medium page size specified in the auxiliary header is 0<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a></td></tr>
<tr>
<td>Bit 9</td>
<td>F_AR32W, Big endian, 32-bit, "non-DEC host" (like 3B)<a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a><br>reserved (XCOFF)<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a></td></tr>
<tr>
<td>Bit 10</td>
<td>F_PATCH, optional header contains "patch" list<a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><br>F_NODF, minimal object files contain no decision functions for replaced functions<a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><br>F_LPTEXT (XCOFF), reserved<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a></td></tr>
<tr>
<td>Bit 11</td>
<td>F_LPDATA (XCOFF), requires large page data<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a></td></tr>
<tr>
<td>Bit 12</td>
<td>F_BM32RST, contains "restore work-around"<a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a><br>F_LPTEXT (XCOFF), reserved<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a></td></tr>
<tr>
<td>Bit 13-15</td>
<td>F_BM32ID, Bellmac-32/WE32000 family ID fields (V9 and later)<a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td>Bit 13</td>
<td>F_BM32B, contains WE32100 instructions (V9 and later)<a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td>Bit 14</td>
<td>F_BM32MAU, requires "math arithmetic unit" (V10 and later)<a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td>Bit 12</td>
<td>F_80186, contains Intel 80186 instructions (V10 and later)<a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td>Bit 13</td>
<td>F_80286, contains Intel 80286 instructions (V10 and later)<a href="#SCOFH"><sup title="filehdr(FP) - SCO OpenServer 5 Documentation">[2]</sup></a><a href="#TUHS"><sup title="The Unix Tree">[3]</sup></a></td></tr>
<tr>
<td>Bit 12</td>
<td>F_DYNLOAD (XCOFF), dynamically executable<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a></td></tr>
<tr>
<td>Bit 12-13</td>
<td>(ECOFF)
<table border='1'>
<tr>
<td>0x2000</td>
<td>F_SHARABLE, shared library<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td>0x3000</td>
<td>F_CALL_SHARED, dynamic executable file<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td>Bit 13</td>
<td>F_SHROBJ (XCOFF), shared library<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a></td></tr>
<tr>
<td>Bit 14</td>
<td>F_LOADONLY (XCOFF), for shared objects, ignore when part of a library<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a><br>F_NO_REORG (ECOFF), do not reorder sections<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td>Bit 15</td>
<td>F_DEP_1 (XCOFF), data-execute permissions<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a><br>F_NO_REMOVE (ECOFF), do not remove NOPs<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
</table>
</td></tr>
</table>
<h3>ECOFF file header</h2>
<p>The ECOFF header is nearly identical to the standard COFF header, with one field enlarged.<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16</td>
<td>f_magic, Magic number</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16</td>
<td>f_nscns, Number of Sections</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td>f_timdat, Time stamp</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i64</td>
<td>f_symptr, Offset to symbol table</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32</td>
<td>f_nsyms, Number of symbols in symbol table</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i16</td>
<td>f_opthdr, Size of optional header</td></tr>
<tr>
<td><tt><sub>x</sub>16</tt></td>	<td>i16</td>
<td>f_flags, Flags</td></tr>
</table>
<h3>XCOFF64 file header</h2>
<p>The XCOFF32 header is identical to the standard COFF header. However, the XCOFF64 header has an 8-byte <tt>f_symptr</tt> entry, requiring <tt>f_nsyms</tt> to be moved after the final field.<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16</td>
<td>f_magic, Magic number</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16</td>
<td>f_nscns, Number of Sections</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td>f_timdat, Time stamp</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i64</td>
<td>f_symptr, Offset to symbol table</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i16</td>
<td>f_opthdr, Size of optional header</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i16</td>
<td>f_flags, Flags</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32</td>
<td>f_nsyms, Number of symbols in symbol table</td></tr>
</table>
<a id="opthdr"/>
<h2>Optional header</h1>
<p>The two variants we will consider are the standard Unix a.out header (AOUTHDR) and its extension used on Concurrent DOS 68K.</p>
<p>Only present in executable files.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16</td>
<td><tt>magic</tt> - Magic (CDOS COFF utility<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>: 0)
<table border='1'>
<tr>
<td><tt><sub>x</sub>0107</tt></td>
<td>OMAGIC<br>Contiguous text and data segments<br>Text segment is not write-protected or sharable<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0108</tt></td>
<td>NMAGIC<br>Data segment starts at segment boundary following text segment<br>Text segment is write-protected<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>010B</tt></td>
<td>ZMAGIC (used by DJGPP<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a>)<br>Text and data segments are page aligned<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0123</tt></td>
<td>SHMAGIC<a href="#GNU"><sup title="Binutils sources">[6]</sup></a><br>Shared library<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16</td>
<td><tt>vstamp</tt> - Version stamp<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a><a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a> (DJGPP ignores this field<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a>, CDOS COFF utility<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>: 0)</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td><tt>tsize</tt> - Text size in bytes (DJGPP ignores this field<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32</td>
<td><tt>dsize</tt> - Data size in bytes (DJGPP ignores this field<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32</td>
<td><tt>bsize</tt> - Bss size in byte (DJGPP ignores this field<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32</td>
<td><tt>entry</tt> - Entry point (CDOS COFF utility<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>: 0)</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32</td>
<td><tt>text_start</tt> - Address of text start (DJGPP ignores this field<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a>, CDOS COFF utility<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>: 0)</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32</td>
<td><tt>data_start</tt> - Address of data start (DJGPP ignores this field<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a>)</td></tr>
</table>
<h3>3B20 optional header</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16</td>
<td><tt>magic</tt> - Magic (CDOS COFF utility<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>: 0)</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16</td>
<td><tt>vstamp</tt> - Version stamp<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a><a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a> (DJGPP ignores this field<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a>, CDOS COFF utility<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>: 0)</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td><tt>tsize</tt> - Text size in bytes (DJGPP ignores this field<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32</td>
<td><tt>dsize</tt> - Data size in bytes (DJGPP ignores this field<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32</td>
<td><tt>bsize</tt> - Bss size in byte (DJGPP ignores this field<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>c[8]</td>
<td>Padding</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32</td>
<td><tt>entry</tt> - Entry point (CDOS COFF utility<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>: 0)</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32</td>
<td><tt>text_start</tt> - Address of text start (DJGPP ignores this field<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a>, CDOS COFF utility<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>: 0)</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32</td>
<td><tt>data_start</tt> - Address of data start (DJGPP ignores this field<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a>)</td></tr>
</table>
<h3>NS32000 fields</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16</td>
<td><tt>magic</tt> - Magic</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16</td>
<td><tt>vstamp</tt> - Version stamp</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td><tt>tsize</tt> - Text size in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32</td>
<td><tt>dsize</tt> - Data size in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32</td>
<td><tt>bsize</tt> - Bss size in byte</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32</td>
<td><tt>msize</tt> - Module size in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32</td>
<td><tt>mod_start</tt> - Address of module</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32</td>
<td><tt>entry</tt> - Entry point</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32</td>
<td><tt>text_start</tt> - Address of text start</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32</td>
<td><tt>data_start</tt> - Address of data start</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i16</td>
<td><tt>entry_mod</tt> - Entry module</td></tr>
<tr>
<td><tt><sub>x</sub>26</tt></td>	<td>i16</td>
<td><tt>flags</tt>
<table border='1'>
<tr>
<td>Bits 0:2</td>
<td>section alignment
<table border='1'>
<tr>
<td>0x00</td>
<td>fullword alignment</td></tr>
<tr>
<td>0x01</td>
<td>512 B</td></tr>
<tr>
<td>0x02</td>
<td>1 KiB</td></tr>
<tr>
<td>0x03</td>
<td>2 KiB</td></tr>
<tr>
<td>0x04</td>
<td>4 KiB</td></tr>
<tr>
<td>0x05</td>
<td>8 KiB</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 3</td>
<td>data</td></tr>
<tr>
<td>Bit 4</td>
<td>text</td></tr>
<tr>
<td>Bit 5</td>
<td>module</td></tr>
<tr>
<td>Bit 8</td>
<td>System V relocations</td></tr>
<tr>
<td>Bit 9</td>
<td>SVR4.2 BSD relocations</td></tr>
</table>
</td></tr>
</table>
<h3>Concurrent DOS additional fields</h2>
<p>The following additional fields are defined:<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32</td>
<td><tt>relptr</tt> - Relocation information (CDOS coff utility: directly after text, data and bss images)</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32</td>
<td><tt>ssize</tt> - Stack size</td></tr>
</table>
<h3>GNU_AOUT header fields</h2>
<p>DJGPP seems to support the following format side from the original System V format<sup>[<a href="https://www.pcorner.com/list/UPLOAD/DPMIGCC5.ZIP/GNUAOUT.H/" target="_blank">GNUAOUT.H</a>]</sup></p>
<h3>Additional optional header fields for MIPS</h2>
<p>The following fields are used additionally for MIPS.<a href="#MIPS"><sup title="https://web.archive.org/web/20140723105157/http://www-scf.usc.edu/~csci402/ncode/coff_8h-source.html">[10]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32</td>
<td><tt>bss_start</tt> - Address of bss start</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32</td>
<td><tt>gprmask</tt> - general purpose register mask</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i32[4]</td>
<td><tt>cprmask</tt> - coprocessor purpose register masks</td></tr>
<tr>
<td><tt><sub>x</sub>34</tt></td>	<td>i32</td>
<td><tt>gp_value</tt> - the gp value for this object</td></tr>
</table>
<h3>ECOFF optional header</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16</td>
<td><tt>magic</tt> - Magic</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16</td>
<td><tt>vstamp</tt> - Version stamp, must be <tt><sub>x</sub>030D</tt><a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16</td>
<td><tt>bldrev</tt> - Revision number of the build tools
<table border='1'>
<tr>
<td>0x0000</td>
<td>1.2</td></tr>
<tr>
<td>0x0002</td>
<td>1.3</td></tr>
<tr>
<td>0x0004</td>
<td>2.0</td></tr>
<tr>
<td>0x0006</td>
<td>3.0</td></tr>
<tr>
<td>0x0008</td>
<td>3.2</td></tr>
<tr>
<td>0x000A</td>
<td>4.0</td></tr>
<tr>
<td>0x000C</td>
<td>5.0</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16</td>
<td><tt>padcell</tt> - Unused</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i64</td>
<td><tt>tsize</tt> - Text size in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i64</td>
<td><tt>dsize</tt> - Data size in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i64</td>
<td><tt>bsize</tt> - Bss size in byte</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i64</td>
<td><tt>entry</tt> - Entry point</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i64</td>
<td><tt>text_start</tt> - Address of text start</td></tr>
<tr>
<td><tt><sub>x</sub>30</tt></td>	<td>i64</td>
<td><tt>data_start</tt> - Address of data start</td></tr>
<tr>
<td><tt><sub>x</sub>38</tt></td>	<td>i64</td>
<td><tt>bss_start</tt> - Address of bss start</td></tr>
<tr>
<td><tt><sub>x</sub>40</tt></td>	<td>i32</td>
<td><tt>gprmask</tt> - Unused</td></tr>
<tr>
<td><tt><sub>x</sub>44</tt></td>	<td>i32</td>
<td><tt>fprmask</tt> - Unused</td></tr>
<tr>
<td><tt><sub>x</sub>48</tt></td>	<td>i64</td>
<td><tt>gp_value</tt> - Initial value of the GP (global pointer) register</td></tr>
</table>
<h3>XCOFF32 additional fields</h2>
<p>XCOFF redefines the value of the <tt>magic</tt> field.<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16</td>
<td><tt>mflag</tt> - Flags, only used if <tt>vstamp</tt> is greater than 1, or 1 in XCOFF32 with <tt>flags</tt> having _AOUT_ALGNTDATA set
<table border='1'>
<tr>
<td>0x003F</td>
<td>Bits for ASLR properties in XCOFF32 executable</td></tr>
<tr>
<td>0x03FF</td>
<td>Bits for ASLR properties in XCOFF64 executable</td></tr>
<tr>
<td>0x3C00</td>
<td>Reserved</td></tr>
<tr>
<td>0x4000</td>
<td>AOUT_MFLAG_ASLR_TEXTRLD, the text section has relocations</td></tr>
<tr>
<td>0x8000</td>
<td>AOUT_MFLAG_ASLR_MARKED, uses address space layout randomization fields</td></tr>
</table>
</td></tr>
</table>
<p>The following additional fields are defined:<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32</td>
<td><tt>toc</tt> - Address of TOC (table of contents) anchor</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32</td>
<td><tt>snentry</tt> - Entry point section number</td></tr>
<tr>
<td><tt><sub>x</sub>22</tt></td>	<td>i16</td>
<td><tt>sntext</tt> - Section number for text segment</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i16</td>
<td><tt>sndata</tt> - Section number for data segment</td></tr>
<tr>
<td><tt><sub>x</sub>26</tt></td>	<td>i16</td>
<td><tt>sntoc</tt> - Section number for TOC segment</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i16</td>
<td><tt>snloader</tt> - Section number for loader data</td></tr>
<tr>
<td><tt><sub>x</sub>2A</tt></td>	<td>i16</td>
<td><tt>snbss</tt> - Section number for bss segment</td></tr>
<tr>
<td><tt><sub>x</sub>2C</tt></td>	<td>i16</td>
<td><tt>algntext</tt> - Maximum alignment for text segment</td></tr>
<tr>
<td><tt><sub>x</sub>2E</tt></td>	<td>i16</td>
<td><tt>algndata</tt> - Maximum alignment for data segment</td></tr>
<tr>
<td><tt><sub>x</sub>30</tt></td>	<td>i16</td>
<td><tt>modtype</tt> - Module type</td></tr>
<tr>
<td><tt><sub>x</sub>32</tt></td>	<td>i8</td>
<td><tt>cpuflag</tt> - CPU flag (reserved)</td></tr>
<tr>
<td><tt><sub>x</sub>33</tt></td>	<td>i8</td>
<td><tt>cputype</tt> - CPU type (reserved)</td></tr>
<tr>
<td><tt><sub>x</sub>34</tt></td>	<td>i32</td>
<td><tt>maxstack</tt> - Maximum stack</td></tr>
<tr>
<td><tt><sub>x</sub>38</tt></td>	<td>i32</td>
<td><tt>maxdata</tt> - Maximum data</td></tr>
<tr>
<td><tt><sub>x</sub>3C</tt></td>	<td>i32</td>
<td><tt>debugger</tt> - Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>40</tt></td>	<td>i8</td>
<td><tt>textpsize</tt> - Text page size</td></tr>
<tr>
<td><tt><sub>x</sub>41</tt></td>	<td>i8</td>
<td><tt>datapsize</tt> - Data page size</td></tr>
<tr>
<td><tt><sub>x</sub>42</tt></td>	<td>i8</td>
<td><tt>stackpsize</tt> - Stack page size</td></tr>
<tr>
<td><tt><sub>x</sub>43</tt></td>	<td>i8</td>
<td><tt>flags</tt> - Flags
<table border='1'>
<tr>
<td>Bit 0-3</td>
<td>_AOUT_ALGNTDATA, alignment of thread-local data
<table border='1'>
<tr>
<td>0x0-0x8</td>
<td>Base 2 logarithm of alignment</td></tr>
<tr>
<td>0xC</td>
<td>4KiB page alignment</td></tr>
<tr>
<td>0xD</td>
<td>64KiB page alignment</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 6</td>
<td>_AOUT_RAS, key and recovery safe kernel extension</td></tr>
<tr>
<td>Bit 7</td>
<td>_AOUT_TLS_LE, uses local-exec model, cannot be loaded dynamically</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>44</tt></td>	<td>i16</td>
<td><tt>sntdata</tt> - Section number for tdata segment</td></tr>
<tr>
<td><tt><sub>x</sub>46</tt></td>	<td>i16</td>
<td><tt>sntbss</tt> - Section number for tbss segment</td></tr>
</table>
<h3>XCOFF64 format</h2>
<p>The 64-bit version enlarges some fields and moves them around, maintaining their natural alignment:<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16</td>
<td><tt>mflag</tt> - Flags</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16</td>
<td><tt>vstamp</tt> - Version stamp</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td><tt>debugger</tt> - Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i64</td>
<td><tt>text_start</tt> - Address of text start</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i64</td>
<td><tt>data_start</tt> - Address of data start</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i64</td>
<td><tt>toc</tt> - Address of TOC (table of contents) anchor</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32</td>
<td><tt>snentry</tt> - Entry point section number</td></tr>
<tr>
<td><tt><sub>x</sub>22</tt></td>	<td>i16</td>
<td><tt>sntext</tt> - Section number for text segment</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i16</td>
<td><tt>sndata</tt> - Section number for data segment</td></tr>
<tr>
<td><tt><sub>x</sub>26</tt></td>	<td>i16</td>
<td><tt>sntoc</tt> - Section number for TOC segment</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i16</td>
<td><tt>snloader</tt> - Section number for loader data</td></tr>
<tr>
<td><tt><sub>x</sub>2A</tt></td>	<td>i16</td>
<td><tt>snbss</tt> - Section number for bss segment</td></tr>
<tr>
<td><tt><sub>x</sub>2C</tt></td>	<td>i16</td>
<td><tt>algntext</tt> - Maximum alignment for text segment</td></tr>
<tr>
<td><tt><sub>x</sub>2E</tt></td>	<td>i16</td>
<td><tt>algndata</tt> - Maximum alignment for data segment</td></tr>
<tr>
<td><tt><sub>x</sub>30</tt></td>	<td>i16</td>
<td><tt>modtype</tt> - Module type</td></tr>
<tr>
<td><tt><sub>x</sub>32</tt></td>	<td>i8</td>
<td><tt>cpuflag</tt> - CPU flag (reserved)</td></tr>
<tr>
<td><tt><sub>x</sub>33</tt></td>	<td>i8</td>
<td><tt>cputype</tt> - CPU type (reserved)</td></tr>
<tr>
<td><tt><sub>x</sub>34</tt></td>	<td>i8</td>
<td><tt>textpsize</tt> - Text page size</td></tr>
<tr>
<td><tt><sub>x</sub>35</tt></td>	<td>i8</td>
<td><tt>datapsize</tt> - Data page size</td></tr>
<tr>
<td><tt><sub>x</sub>36</tt></td>	<td>i8</td>
<td><tt>stackpsize</tt> - Stack page size</td></tr>
<tr>
<td><tt><sub>x</sub>37</tt></td>	<td>i8</td>
<td><tt>flags</tt> - Flags</td></tr>
<tr>
<td><tt><sub>x</sub>38</tt></td>	<td>i64</td>
<td><tt>tsize</tt> - Text size in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>40</tt></td>	<td>i64</td>
<td><tt>dsize</tt> - Data size in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>48</tt></td>	<td>i64</td>
<td><tt>bsize</tt> - Bss size in byte</td></tr>
<tr>
<td><tt><sub>x</sub>50</tt></td>	<td>i64</td>
<td><tt>entry</tt> - Entry point</td></tr>
<tr>
<td><tt><sub>x</sub>58</tt></td>	<td>i64</td>
<td><tt>maxstack</tt> - Maximum stack</td></tr>
<tr>
<td><tt><sub>x</sub>60</tt></td>	<td>i64</td>
<td><tt>maxdata</tt> - Maximum data</td></tr>
<tr>
<td><tt><sub>x</sub>68</tt></td>	<td>i16</td>
<td><tt>sntdata</tt> - Section number for tdata segment</td></tr>
<tr>
<td><tt><sub>x</sub>6A</tt></td>	<td>i16</td>
<td><tt>sntbss</tt> - Section number for tbss segment</td></tr>
<tr>
<td><tt><sub>x</sub>6C</tt></td>	<td>i16</td>
<td><tt>x64flags</tt> - XCOFF64 flags</td></tr>
<tr>
<td><tt><sub>x</sub>6E</tt></td>	<td>i16</td>
<td><tt>shmpsize64</tt> - Shared memory page size</td></tr>
</table>
<a id="secthdr"/>
<h2>Section header</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[8]</td>
<td><tt>s_name</tt> - Section name, padded with nulls</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32</td>
<td><tt>s_paddr</tt> - Physical address for section data</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32</td>
<td><tt>s_vaddr</tt> - Virtual address (identical to physical address for DJGPP<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a> and CDOS<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32</td>
<td><tt>s_size</tt> - Size of data in image in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32</td>
<td><tt>s_scnptr</tt> - Offset to section data from COFF file start</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32</td>
<td><tt>s_relptr</tt> - Offset to relocation data (CDOS coff utility<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>: 0)</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32</td>
<td><tt>s_lnnoptr</tt> - Offset to line number entries (CDOS coff utility<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>: 0)</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i16</td>
<td><tt>s_nreloc</tt> - Number of relocations (CDOS coff utility<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>: 0)</td></tr>
<tr>
<td><tt><sub>x</sub>22</tt></td>	<td>i16</td>
<td><tt>s_nlnno</tt> - Number of line numbers (CDOS coff utility<a href="#CDOS"><sup title="COFF.C source from Concurrent DOS 68K disks">[5]</sup></a>: 0)</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i32</td>
<td><tt>s_flags</tt> - Flags
<table border='1'>
<tr>
<td><tt><sub>x</sub>00000000</tt></td>
<td><tt>STYP_REG</tt> - Regular section (allocated, relocated, loaded)<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a>, also ECOFF<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a>, reserved in XCOFF<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00000001</tt></td>
<td><tt>STYP_DSECT</tt> - Dummy section (not allocated, relocated, not loaded)<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00000002</tt></td>
<td><tt>STYP_NOLOAD</tt> - Noload section (allocated, relocated, not loaded)<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00000004</tt></td>
<td><tt>STYP_GROUP</tt> - Grouped section<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00000008</tt></td>
<td><tt>STYP_PAD</tt> - Padding section (not allocated, not relocated, loaded)<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a> also XCOFF<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00000010</tt></td>
<td><tt>STYP_COPY</tt> - Copy section, for a decision function used in updating fields<br>(not allocated, not relocated, loaded, relocation and line numbers are processed normally)<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a><br><tt>STYP_DWARF</tt> (XCOFF) - DWARF debugging section<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00000020</tt></td>
<td><tt>STYP_TEXT</tt> - Executable text code, also XCOFF<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a> and ECOFF<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00000040</tt></td>
<td><tt>STYP_DATA</tt> - Initialized data, also XCOFF<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a> and ECOFF<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00000080</tt></td>
<td><tt>STYP_BSS</tt> - Uninitialized data, also XCOFF<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a> and ECOFF<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00000100</tt></td>
<td><tt>STYP_EXCEPT</tt> (XCOFF) - Exception section<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a><br><tt>STYP_RDATA</tt> (ECOFF) - Read-only data<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00000200</tt></td>
<td><tt>STYP_INFO</tt> - Comment section (not allocated, not relocated, not loaded)<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a>, also XCOFF<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a><br><tt>STYP_SDATA</tt> (ECOFF) - Small initialized data<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00000400</tt></td>
<td><tt>STYP_OVER</tt> - Overlay section (not allocated, relocated, not loaded)<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a><br><tt>STYP_TDATA</tt> (XCOFF) - thread-local initialized data section<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a><br><tt>STYP_SBSS</tt> (ECOFF) - Small uninitialized data<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00000800</tt></td>
<td><tt>STYP_LIB</tt> - .lib section, treated like a comment section<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a><br><tt>STYP_TBSS</tt> (XCOFF) - thread-local uninitialized data section<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a><br><tt>STYP_UCODE</tt> (ECOFF) - Obsolete<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00001000</tt></td>
<td><tt>STYP_LOADER</tt> (XCOFF) - Loader section<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a><br><tt>STYP_GOT</tt> (ECOFF) - Global offset table<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00002000</tt></td>
<td><tt>STYP_DEBUG</tt> (XCOFF) - Debug section<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a><br><tt>STYP_DYNAMIC</tt> (ECOFF) - Dynamic linking information<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00004000</tt></td>
<td><tt>STYP_TYPCHK</tt> (XCOFF) - Type-check section<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a><br><tt>STYP_DYNSYM</tt> (ECOFF) - Dynamic linking symbol table<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00008000</tt></td>
<td><tt>STYP_OVRFLO</tt> (XCOFF32 only) - Overflow section<a href="#XCOFF"><sup title="XCOFF Object File Format">[8]</sup></a><br><tt>STYP_REL_DYN</tt> (ECOFF) - Dynamic relocation information<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00010000</tt></td>
<td><tt>STYP_DYNSTR</tt> (ECOFF) - Dynamic linking symbol table<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00020000</tt></td>
<td><tt>STYP_HASH</tt> (ECOFF) - Dynamic symbol hash table<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00040000</tt></td>
<td><tt>STYP_DSOLIST</tt> (ECOFF) - Shared library dependency list<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00080000</tt></td>
<td><tt>STYP_MSYM</tt> (ECOFF) - Additional dynamic linking symbol table<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0FF00000</tt></td>
<td><tt>STYP_EXTMASK</tt> (ECOFF) - Mask for multiple bit flag values<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>00100000</tt></td>
<td><tt>STYP_CONFLICT</tt> (ECOFF) - Additional dynamic linking information<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>01000000</tt></td>
<td><tt>STYP_FINI</tt> (ECOFF) - Termination text only<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>02000000</tt></td>
<td><tt>STYP_COMMENT</tt> (ECOFF) - Comment section<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>02200000</tt></td>
<td><tt>STYP_RCONST</tt> (ECOFF) - Read-only constants<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>02400000</tt></td>
<td><tt>STYP_XDATA</tt> (ECOFF) - Exception scope table<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>02500000</tt></td>
<td><tt>STYP_TLSDATA</tt> (ECOFF) - Initialized TLS data<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>02600000</tt></td>
<td><tt>STYP_TLSBSS</tt> (ECOFF) - Uninitialized TLS data<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>02700000</tt></td>
<td><tt>STYP_TLSINIT</tt> (ECOFF) - Initialization for TLS data<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>02800000</tt></td>
<td><tt>STYP_PDATA</tt> (ECOFF) - Exception procedure table<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>04000000</tt></td>
<td><tt>STYP_LITA</tt> (ECOFF) - Address literals only<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>08000000</tt></td>
<td><tt>STYP_LIT8</tt> (ECOFF) - 8-byte literals only<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>10000000</tt></td>
<td><tt>STYP_LIT4</tt> (ECOFF) - 4-byte literals only<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>20000000</tt></td>
<td><tt>S_NRELOC_OVFL</tt> (ECOFF) - The <tt>s_nreloc</tt> field has overflowed and contains <tt><sub>x</sub>FFFF</tt><a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a><br>In this case, the first relocation entry contains the actual relocation count</td></tr>
<tr>
<td><tt><sub>x</sub>80000000</tt></td>
<td><tt>STYP_INIT</tt> (ECOFF) - Initialization text only<a href="#ECOFF"><sup title="Tru64 UNIX (eCOFF)">[9]</sup></a></td></tr>
</table>
</td></tr>
</table>
<h3>ECOFF section header</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[8]</td>
<td><tt>s_name</tt> - Section name, padded with nulls</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i64</td>
<td><tt>s_paddr</tt> - Physical address for section data</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i64</td>
<td><tt>s_vaddr</tt> - Virtual address</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i64</td>
<td><tt>s_size</tt> - Size of data in image in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i64</td>
<td><tt>s_scnptr</tt> - Offset to section data from COFF file start</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i64</td>
<td><tt>s_relptr</tt> - Offset to relocation data</td></tr>
<tr>
<td><tt><sub>x</sub>30</tt></td>	<td>i64</td>
<td><tt>s_lnnoptr</tt> - Offset to line number entries</td></tr>
<tr>
<td><tt><sub>x</sub>38</tt></td>	<td>i16</td>
<td><tt>s_nreloc</tt> - Number of relocations</td></tr>
<tr>
<td><tt><sub>x</sub>3A</tt></td>	<td>i16</td>
<td><tt>s_nlnno</tt> - Number of line numbers</td></tr>
<tr>
<td><tt><sub>x</sub>3C</tt></td>	<td>i32</td>
<td><tt>s_flags</tt> - Flags</td></tr>
</table>
<h3>XCOFF64 section header</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[8]</td>
<td><tt>s_name</tt> - Section name, padded with nulls</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i64</td>
<td><tt>s_paddr</tt> - Physical address for section data</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i64</td>
<td><tt>s_vaddr</tt> - Virtual address</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i64</td>
<td><tt>s_size</tt> - Size of data in image in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i64</td>
<td><tt>s_scnptr</tt> - Offset to section data from COFF file start</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i64</td>
<td><tt>s_relptr</tt> - Offset to relocation data</td></tr>
<tr>
<td><tt><sub>x</sub>30</tt></td>	<td>i64</td>
<td><tt>s_lnnoptr</tt> - Offset to line number entries</td></tr>
<tr>
<td><tt><sub>x</sub>38</tt></td>	<td>i32</td>
<td><tt>s_nreloc</tt> - Number of relocations</td></tr>
<tr>
<td><tt><sub>x</sub>3C</tt></td>	<td>i32</td>
<td><tt>s_nlnno</tt> - Number of line numbers</td></tr>
<tr>
<td><tt><sub>x</sub>40</tt></td>	<td>i32</td>
<td><tt>s_flags</tt> - Flags</td></tr>
</table>
<a id="relocs"/>
<h2>Relocation information</h1>
<p>The typical relocation information is a sequence of relocation records as shown below.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32</td>
<td><tt>r_vaddr</tt> - Virtual address of reference</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td><tt>r_symndx</tt> - Symbol table index</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16</td>
<td><tt>r_type</tt> - Symbol type
<table border='1'>
<tr>
<td><tt><sub>x</sub>00</tt></td>
<td><tt>R_ABS</tt> - Absolute reference, no relocation necessary<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>
<td><tt>R_DIR16</tt> - (80286 only) Direct 16-bit reference to symbol's virtual address<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>
<td><tt>R_REL16</tt> - (80286 only) PC-relative 16-bit reference to symbol's virtual address<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>
<td><tt>R_DIR32</tt> - Direct 32-bit reference to symbol's virtual address<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a><br><tt>RELOC_ADDR32</tt> for DJGPP<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>09</tt></td>
<td><tt>R_SEG12</tt> - (80286 only) Direct 16-bit reference to symbol's segment-selector bits of a 32-bit virtual address<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>
<td><tt>R_PCRLONG</tt> - (80386 only) PC-relative 32-bit reference to symbol's virtual address<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a><br><tt>RELOC_REL32</tt> for DJGPP<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a></td></tr>
</table>
</td></tr>
</table>
<h3>Concurrent DOS 68K relocation information</h2>
<p>Concurrent DOS 68K uses a different relocation structure. Its position is stored in the optional header instead of the file header. The contents of the relocations are identical to crunched relocations in the CP/M-68K file format.</p>
<a id="linenos"/>
<h2>Line numbers</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32</td>
<td>Symbol table index (if line number is 0) or virtual address</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16</td>
<td>1-based line number<br>0 for symbol table index</td></tr>
</table>
<a id="symtab"/>
<h2>Symbol table</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[8]</td>
<td><tt>name</tt> - Symbol name, zero-padded (first 4 bytes should not be all zero)</td></tr>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32</td>
<td><tt>zeroes</tt> - If zero, the symbol is inlined</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td><tt>offset</tt> - Offset to name in symbol table (only if first 4 bytes are zero)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32</td>
<td><tt>value</tt> - Value of symbol</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i16</td>
<td><tt>scnum</tt> - Section number, 1-based
<table border='1'>
<tr>
<td>0x0000</td>
<td><tt>N_UNDEF</tt> - External/undefined symbol</td></tr>
<tr>
<td>0xFFFF</td>
<td><tt>N_ABS</tt> - Absolute symbol</td></tr>
<tr>
<td>0xFFFE</td>
<td><tt>N_DEBUG</tt> - Debugging symbol</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i16</td>
<td><tt>type</tt> - Symbol type: base type
<table border='1'>
<tr>
<td><tt><sub>x</sub>0000</tt></td>
<td><tt>T_NULL</tt> - No symbol</td></tr>
<tr>
<td><tt><sub>x</sub>0001</tt></td>
<td><tt>T_ARG</tt> - Function argument<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a><br><tt>T_VOID</tt> - void<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0002</tt></td>
<td><tt>T_CHAR</tt> - char, int8</td></tr>
<tr>
<td><tt><sub>x</sub>0003</tt></td>
<td><tt>T_SHORT</tt> - short int, int16</td></tr>
<tr>
<td><tt><sub>x</sub>0004</tt></td>
<td><tt>T_INT</tt> - int</td></tr>
<tr>
<td><tt><sub>x</sub>0005</tt></td>
<td><tt>T_LONG</tt> - long int, int32</td></tr>
<tr>
<td><tt><sub>x</sub>0006</tt></td>
<td><tt>T_FLOAT</tt> - float</td></tr>
<tr>
<td><tt><sub>x</sub>0007</tt></td>
<td><tt>T_DOUBLE</tt> - double</td></tr>
<tr>
<td><tt><sub>x</sub>0008</tt></td>
<td><tt>T_STUCT</tt> - struct ...</td></tr>
<tr>
<td><tt><sub>x</sub>0009</tt></td>
<td><tt>T_UNION</tt> - union ...</td></tr>
<tr>
<td><tt><sub>x</sub>000A</tt></td>
<td><tt>T_ENUM</tt> - enum ...</td></tr>
<tr>
<td><tt><sub>x</sub>000B</tt></td>
<td><tt>T_MOE</tt> - Member in enumeration</td></tr>
<tr>
<td><tt><sub>x</sub>000C</tt></td>
<td><tt>T_UCHAR</tt> - unsigned char, uint8</td></tr>
<tr>
<td><tt><sub>x</sub>000D</tt></td>
<td><tt>T_USHORT</tt> - unsigned short int, uint16</td></tr>
<tr>
<td><tt><sub>x</sub>000E</tt></td>
<td><tt>T_UINT</tt> - unsigned int</td></tr>
<tr>
<td><tt><sub>x</sub>000F</tt></td>
<td><tt>T_ULONG</tt> - unsigned long int, uint32</td></tr>
<tr>
<td><tt><sub>x</sub>0010</tt></td>
<td><tt>T_LNGDBL</tt> - long double<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0000</tt></td>
<td><tt>DT_NON</tt> - Not a derived type</td></tr>
<tr>
<td><tt><sub>x</sub>0010</tt></td>
<td><tt>DT_PTR</tt> - Pointer</td></tr>
<tr>
<td><tt><sub>x</sub>0020</tt></td>
<td><tt>DT_FUN</tt> - Function</td></tr>
<tr>
<td><tt><sub>x</sub>0030</tt></td>
<td><tt>DT_ARY</tt> - Array</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i8</td>
<td><tt>sclass</tt> - Storage class
<table border='1'>
<tr>
<td><tt><sub>x</sub>00</tt></td>
<td><tt>C_NULL</tt> - No entry</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>
<td><tt>C_AUTO</tt> - Automatic</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>
<td><tt>C_EXT</tt> - External/public</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>
<td><tt>C_STAT</tt> - Static/private</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>
<td><tt>C_REG</tt> - Register</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>
<td><tt>C_EXTDEF</tt> - External definition</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>
<td><tt>C_LABEL</tt> - Label</td></tr>
<tr>
<td><tt><sub>x</sub>07</tt></td>
<td><tt>C_ULABEL</tt> - Undefined label</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>
<td><tt>C_MOS</tt> - Member of structure</td></tr>
<tr>
<td><tt><sub>x</sub>09</tt></td>
<td><tt>C_ARG</tt> - Function argument</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>
<td><tt>C_STRTAG</tt> - Structure tag</td></tr>
<tr>
<td><tt><sub>x</sub>0B</tt></td>
<td><tt>C_MOU</tt> - Member of union</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>
<td><tt>C_UNTAG</tt> - Union tag</td></tr>
<tr>
<td><tt><sub>x</sub>0D</tt></td>
<td><tt>C_TPDEF</tt> - Type definition</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>
<td><tt>C_USTATIC</tt> - Undefined static</td></tr>
<tr>
<td><tt><sub>x</sub>0F</tt></td>
<td><tt>C_ENTAG</tt> - Enumeration tag</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>
<td><tt>C_MOE</tt> - Member of enumeration</td></tr>
<tr>
<td><tt><sub>x</sub>11</tt></td>
<td><tt>C_REGPARM</tt> - Register parameter</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>
<td><tt>C_FIELD</tt> - Bitfield</td></tr>
<tr>
<td><tt><sub>x</sub>13</tt></td>
<td><tt>C_AUTOARG</tt> - Auto argument<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>
<td><tt>C_LASTENT</tt> - Dummy argument<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>64</tt></td>
<td><tt>C_BLOCK</tt> - Beginning/end of block (.bb, .eb)</td></tr>
<tr>
<td><tt><sub>x</sub>65</tt></td>
<td><tt>C_FCN</tt> - Beginning/end of function (.bf, .ef)</td></tr>
<tr>
<td><tt><sub>x</sub>66</tt></td>
<td><tt>C_EOS</tt> - End of structure</td></tr>
<tr>
<td><tt><sub>x</sub>67</tt></td>
<td><tt>C_FILE</tt> - File name</td></tr>
<tr>
<td><tt><sub>x</sub>68</tt></td>
<td><tt>C_LINE</tt> - Line number as symbol<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a>, Used only by utility programs<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>69</tt></td>
<td><tt>C_ALIAS</tt> - Duplicated tag</td></tr>
<tr>
<td><tt><sub>x</sub>6A</tt></td>
<td><tt>C_HIDDEN</tt> - Shadow symbol<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a>, ext symbol in dmert public lib<a href="#DJGPP"><sup title="DJGPP COFF Spec">[4]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>6B</tt></td>
<td><tt>C_WEAKEXT</tt> - Weak linkage C_EXT<a href="#SCO"><sup title="Common Object File Format (COFF) - SCO OpenServer 5 Documentation">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>FF</tt></td>
<td><tt>C_EFCN</tt> - Physical end of function</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>11</tt></td>	<td>i8</td>
<td><tt>numaux</tt> - Number of auxiliary entries, each entry occupying a symbol record</td></tr>
</table>
<a id="strtab"/>
<h2>String table</h1>
<p>A sequence of null-terminated strings. The first 4 bytes specify the size of the string table in bytes, including the first 4 bytes. References to string must be between 4 and this value.</p>
<h2>Further work</h1>
<p>The XCOFF and ECOFF formats require further work.</p>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="http://osr507doc.sco.com/en/topics/COFF.html" target='_blank'>Common Object File Format (COFF) - SCO OpenServer 5 Documentation</a></li>
<li>[2] <a href="http://osr507doc.sco.com/en/man/html.FP/filehdr.FP.html" target='_blank'>filehdr(FP) - SCO OpenServer 5 Documentation</a></li>
<li>[3] <a href="https://www.tuhs.org/cgi-bin/utree.pl" target='_blank'>The Unix Tree</a></li>
<li>[4] <a href="http://www.delorie.com/djgpp/doc/coff/" target='_blank'>DJGPP COFF Spec</a></li>
<li>[5] <a href="http://www.cpm.z80.de/download/cdos3.zip" target='_blank'>COFF.C source from Concurrent DOS 68K disks</a></li>
<li>[6] <a href="https://github.com/aixoss/binutils" target='_blank'>Binutils sources</a></li>
<li>[7] UNIX file magic numbers</li>
<li>[8] <a href="https://www.ibm.com/docs/en/aix/7.3?topic=formats-xcoff-object-file-format" target='_blank'>XCOFF Object File Format</a></li>
<li>[9] <a href="https://web.archive.org/web/20160305114748/http://h41361.www4.hp.com/docs/base_doc/DOCUMENTATION/V50A_ACRO_SUP/OBJSPEC.PDF" target='_blank'>Tru64 UNIX (eCOFF)</a></li>
<li>[10] <a href="https://web.archive.org/web/20140723105157/http://www-scf.usc.edu/~csci402/ncode/coff_8h-source.html" target='_blank'>https://web.archive.org/web/20140723105157/http://www-scf.usc.edu/~csci402/ncode/coff_8h-source.html</a></li>
</ul>
<hr/>
<h1 id="xout">XENIX x.out file format</h1>
<dl>
<dt>File extensions</td>
<dd>&mdash;</dd>
<dl>
<dt>Magic code</td>
<dd><tt><sub>x</sub>0206</tt></dd>
<dl>
<dt>Architecture</td>
<dd>various, including PDP-11, Z8000, Intel 8086/80186/80286 and Intel 80386, Motorola 68000, Zilog Z80, VAX, NS32000</dd>
<dl>
<dt>Operating systems</td>
<dd>1984: XENIX Release 3</dd>
</dl>
<dl>
<dt>Influences</td>
<dd>various, including PDP-11, Z8000, Intel 8086/80186/80286 and Intel 80386, Motorola 68000, Zilog Z80, VAX, NS32000</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#header">Header</a>
</li>
<li><a href="#extheader">Header extension</a>
</li>
<li><a href="#segtab">Segment table</a>
</li>
<li><a href="#">Further work</a>
</li><li><a href="#_references">References</a></li>
</ol>
<a id="header"/>
<h2>Header</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16</td>
<td>x_magic, <tt><sub>x</sub>0206</tt></td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16</td>
<td>x_ext, size of <a href="#extheader">Header extension</a></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td>x_text, size of text segment<br>for segmented images, sum of all the corresponding segment sizes (xs_psize or xs_vsize)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32</td>
<td>x_data, size of initialized data segment<br>for segmented images, sum of all the corresponding segment sizes (xs_psize or xs_vsize)</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32</td>
<td>x_bss, size of uninitialized data segment<br>for segmented images, sum of all the corresponding segment sizes (xs_psize or xs_vsize)</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32</td>
<td>x_syms, size of symbol table<br>for segmented images, sum of all the corresponding segment sizes (xs_psize or xs_vsize)</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32</td>
<td>x_reloc, size of relocation table<br>for segmented images, sum of all the corresponding segment sizes (xs_psize or xs_vsize)</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32</td>
<td>x_entry, entry point</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i8</td>
<td>x_cpu, CPU type and word order
<table border='1'>
<tr>
<td>Bits 0:4</td>
<td>
<table border='1'>
<tr>
<td>0x01</td>
<td>PDP-11</td></tr>
<tr>
<td>0x02</td>
<td>PDP-11/23 (?)</td></tr>
<tr>
<td>0x03</td>
<td>Zilog Z8000</td></tr>
<tr>
<td>0x04</td>
<td>Intel 8086</td></tr>
<tr>
<td>0x05</td>
<td>Motorola 68000</td></tr>
<tr>
<td>0x06</td>
<td>Zilog Z80</td></tr>
<tr>
<td>0x07</td>
<td>VAX 780/750</td></tr>
<tr>
<td>0x08</td>
<td>National Semiconductor 32000 (NS16032)</td></tr>
<tr>
<td>0x09</td>
<td>Intel 80286</td></tr>
<tr>
<td>0x29</td>
<td>Intel 80286 (?)</td></tr>
<tr>
<td>0x0A</td>
<td>Intel 80386</td></tr>
<tr>
<td>0x0B</td>
<td>Intel 80186</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 5</td>
<td>set if least significant word comes first in 32-bit word (little-endian)</td></tr>
<tr>
<td>Bit 6</td>
<td>set if most significant byte comes first in 16-bit word (big-endian)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>1D</tt></td>	<td>i8</td>
<td>x_relsym, relocation & symbol format, only valid for non-segmented binaries
<table border='1'>
<tr>
<td>Bits 0:3</td>
<td>symbol table format</td></tr>
<tr>
<td>Bits 4:7</td>
<td>relocation table format</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>1E</tt></td>	<td>i16</td>
<td>x_renv, run-time environment
<table border='1'>
<tr>
<td>Bit 0</td>
<td>XE_EXEC, executable</td></tr>
<tr>
<td>Bit 1</td>
<td>XE_SEP, separate I & D</td></tr>
<tr>
<td>Bit 2</td>
<td>XE_PURE, pure text</td></tr>
<tr>
<td>Bit 3</td>
<td>XE_FS, fixed stack</td></tr>
<tr>
<td>Bit 4</td>
<td>XE_OVER, text overlay</td></tr>
<tr>
<td>Bit 5</td>
<td>XE_LDATA, large model data</td></tr>
<tr>
<td>Bit 6</td>
<td>XE_LTEXT, large model text</td></tr>
<tr>
<td>Bit 7</td>
<td>XE_FPH, floating point hardware required</td></tr>
<tr>
<td>Bit 8</td>
<td>XE_HDATA, XE_VMOD, virtual module or huge model data (not used)</td></tr>
<tr>
<td>Bit 9</td>
<td>XE_ITER, iterated text/data present</td></tr>
<tr>
<td>Bit 10</td>
<td>XE_ABS, absolute memory image with physical addresses, standalone</td></tr>
<tr>
<td>Bit 11</td>
<td>XE_SEG, segment table present</td></tr>
<tr>
<td>Bit 12</td>
<td>XE_LOCK, use advisory locking (0)</td></tr>
<tr>
<td>Bit 13</td>
<td>XE_5_3, 5.3 functionality required (0)</td></tr>
<tr>
<td>Bits 14:15</td>
<td>XE_VERS, Version
<table border='1'>
<tr>
<td>0x40</td>
<td>XE_V2, Version 2.x</td></tr>
<tr>
<td>0x80</td>
<td>XE_V3, Version 3.x</td></tr>
<tr>
<td>0xC0</td>
<td>XE_OSV, XE_V5, Version 5.x</td></tr>
</table>
</td></tr>
</table>
</td></tr>
</table>
<p>On a 386, bits 0, 8, 10 of x_renv must take one the following values:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>0001</tt></td>
<td>executable, no shared libraries</td></tr>
<tr>
<td><tt><sub>x</sub>0100</tt></td>
<td>shared library</td></tr>
<tr>
<td><tt><sub>x</sub>0101</tt></td>
<td>executable, uses shared libraries</td></tr>
<tr>
<td><tt><sub>x</sub>0401</tt></td>
<td>standalone program, kernel</td></tr>
<tr>
<td><tt><sub>x</sub>0500</tt></td>
<td>virtual kernel module</td></tr>
</table>
<a id="extheader"/>
<h2>Header extension</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32</td>
<td>xe_trsize, size of text relocations<br>for segmented images, sum of all corresponding segment sizes<br>not used</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i32</td>
<td>xe_drsize, size of initialized data relocations<br>for segmented images, sum of all corresponding segment sizes<br>not used</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i32</td>
<td>xe_tbase, text relocation base<br>unused for segmented images<br>not used</td></tr>
<tr>
<td><tt><sub>x</sub>2C</tt></td>	<td>i32</td>
<td>xe_dbase, text relocation base<br>unused for segmented images<br>not used</td></tr>
<tr>
<td><tt><sub>x</sub>30</tt></td>	<td>i32</td>
<td>xe_stksize, fixed stack size, only if XE_FS is set</td></tr>
</table>
<p>The following fields are mandatory in segmented executables:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>34</tt></td>	<td>i32</td>
<td>xe_segpos, offset to <a href="#segtab">Segment table</a></td></tr>
<tr>
<td><tt><sub>x</sub>38</tt></td>	<td>i32</td>
<td>xe_segsize, size of <a href="#segtab">Segment table</a></td></tr>
<tr>
<td><tt><sub>x</sub>3C</tt></td>	<td>i32</td>
<td>xe_mdtpos, offset to machine dependent table</td></tr>
<tr>
<td><tt><sub>x</sub>40</tt></td>	<td>i32</td>
<td>xe_mdtsize, size of machine dependent table</td></tr>
<tr>
<td><tt><sub>x</sub>44</tt></td>	<td>i8</td>
<td>xe_mdttype, type of machine dependent table
<table border='1'>
<tr>
<td>0x00</td>
<td>XE_MDTNONE</td></tr>
<tr>
<td>0x01</td>
<td>XE_MDT286, Intel 80286 LDT</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>45</tt></td>	<td>i8</td>
<td>xe_pagesize, size of file page, in 512 bytes</td></tr>
<tr>
<td><tt><sub>x</sub>46</tt></td>	<td>i8</td>
<td>xe_ostype, type of operating system
<table border='1'>
<tr>
<td>0x00</td>
<td>XE_OSNONE</td></tr>
<tr>
<td>0x01</td>
<td>XE_OSXENIX, Xenix</td></tr>
<tr>
<td>0x02</td>
<td>XE_OSRMX, Intel iRMX</td></tr>
<tr>
<td>0x03</td>
<td>XE_OSCCPM, Concurrent CP/M</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>47</tt></td>	<td>i8</td>
<td>xe_osvers, version of operating system
<table border='1'>
<tr>
<td>0x00</td>
<td>XE_OSXV2, Xenix 2.x</td></tr>
<tr>
<td>0x01</td>
<td>XE_OSXV3, Xenix 3.x</td></tr>
<tr>
<td>0x02</td>
<td>XE_OSXV5, Xenix 5.x</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>48</tt></td>	<td>i16</td>
<td>xe_eseg, segment for entry (machine dependent)</td></tr>
<tr>
<td><tt><sub>x</sub>4A</tt></td>	<td>i16</td>
<td>xe_sres, reserved</td></tr>
</table>
<a id="segtab"/>
<h2>Segment table</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16</td>
<td>xs_type, type of segment
<table border='1'>
<tr>
<td>0x00</td>
<td>XS_TNULL, unused</td></tr>
<tr>
<td>0x01</td>
<td>XS_TTEXT, text segment</td></tr>
<tr>
<td>0x02</td>
<td>XS_TDATA, data segment</td></tr>
<tr>
<td>0x03</td>
<td>XS_TSYMS, symbol table segment</td></tr>
<tr>
<td>0x04</td>
<td>XS_TREL, relocation segment</td></tr>
<tr>
<td>0x05</td>
<td>XS_TSESTR, string table for segment table</td></tr>
<tr>
<td>0x06</td>
<td>XS_TGRPS, group definition segment</td></tr>
<tr>
<td>0x40</td>
<td>XS_TIDATA, iterated data</td></tr>
<tr>
<td>0x41</td>
<td>XS_TTSS, TSS segment</td></tr>
<tr>
<td>0x42</td>
<td>XS_TLFIX, "lodfix"</td></tr>
<tr>
<td>0x43</td>
<td>XS_TDNAME, descriptor names</td></tr>
<tr>
<td>0x44</td>
<td>XS_TDTEXT/XS_TIDBG, debug text segment</td></tr>
<tr>
<td>0x45</td>
<td>XS_TDFIX, debug relocation</td></tr>
<tr>
<td>0x46</td>
<td>XS_TOVTAB, overlay table</td></tr>
<tr>
<td>0x47</td>
<td>XS_T71</td></tr>
<tr>
<td>0x48</td>
<td>XS_TSYSTR, string table for symbols</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16</td>
<td>xs_attr, attributes
<table border='1'>
<tr>
<td>Bit 0</td>
<td>XS_AITER, contains iteration records (XS_TTEXT/XS_TDATA)</td></tr>
<tr>
<td>Bit 1</td>
<td>XS_AHUGE, contains huge elements (XS_TTEXT/XS_TDATA)</td></tr>
<tr>
<td>Bit 2</td>
<td>XS_ABSS, contains implicit bss (XS_TTEXT/XS_TDATA)</td></tr>
<tr>
<td>Bit 3</td>
<td>XS_APURE, read-only shareable (XS_TTEXT/XS_TDATA)</td></tr>
<tr>
<td>Bit 4</td>
<td>XS_AEDOWN, expand down segment such as stack (XS_TTEXT/XS_TDATA)</td></tr>
<tr>
<td>Bit 5</td>
<td>XS_APRIV, segment may not be combined, private (XS_TTEXT/XS_TDATA)</td></tr>
<tr>
<td>Bit 6</td>
<td>XS_A32BIT, 32-bit segment</td></tr>
<tr>
<td>Bits 0:14</td>
<td>for XS_TSYMS segment, symbol table format
<table border='1'>
<tr>
<td>0x0000</td>
<td>Bell 5.2</td></tr>
<tr>
<td>0x0001</td>
<td>x.out segmented</td></tr>
<tr>
<td>0x0002</td>
<td>island debugger support</td></tr>
</table>
</td></tr>
<tr>
<td>Bits 0:14</td>
<td>for XS_TREL segment, enumerated relocation table format
<table border='1'>
<tr>
<td>0x0001</td>
<td>x.out segmented</td></tr>
<tr>
<td>0x0002</td>
<td>8086 x.out segmented</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 15</td>
<td>XS_AMEM, segment represents memory image</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16</td>
<td>xs_seg, segment number</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i8</td>
<td>xs_align, alignment, as base 2 logarithm</td></tr>
<tr>
<td><tt><sub>x</sub>07</tt></td>	<td>i8</td>
<td>xs_cres, unused</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32</td>
<td>xs_filpos, offset to segment image in file, in pages for 386 (see xe_pagesize)</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32</td>
<td>xs_psize, size of segment in file</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32</td>
<td>xs_vsize, size of segment in memory</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32</td>
<td>xs_rbase, base address for relocations, modulo page size for 386 (see xe_pagesize)</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i16</td>
<td>xs_noff, offset to segment name in string table</td></tr>
<tr>
<td><tt><sub>x</sub>1A</tt></td>	<td>i16</td>
<td>xs_sres, reserved</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32</td>
<td>xs_lres, reserved</td></tr>
</table>
<h2>Further work</h1>
<p>This format requires further research.</p>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="# p141" target='_blank'>XENIX 286 C Library Guide, Appendix B (1984-11)</a></li>
<li>[2] ACS-586 XENIX C Compiler Release Notes (1984-05-29)</li>
<li>[3] XENIX System V Development System C Language Guide, Section 7.17 (1987-06-28)</li>
<li>[4] XENIX System V Development System C Language Guide, Section 7.17 (1988-10)</li>
<li>[5] <a href="# p415" target='_blank'>XENIX System V Operating System User's Guide</a></li>
</ul>
<hr/>
<h1 id="macho">Mach-O format (for Mach object)</h1>
<dl>
<dt>File extensions</td>
<dd>&mdash;</dd>
<dl>
<dt>Magic code</td>
<dd><tt><sub>x</sub>FEEDFACE</tt> for 32-bit, <tt><sub>x</sub>FEEDFACF</tt> for 64-bit, <tt><sub>x</sub>CA<sub>x</sub>FE<sub>x</sub>BA<sub>x</sub>BE</tt> for fat binary</dd>
<dl>
<dt>Architecture</td>
<dd>various</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>not before 1985: Mach</li>
<li>1988-10-12: NeXTSTEP 0.8</li>
<li>1992-01: OSF/1<sup>?</sup></li>
<li>2001-03-24: Mac OS X/macOS, iOS</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>various</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Further work</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Further work</h1>
<p>This format requires documentation.</p>
<a id="_references"/>
<h2>References</h1>
<ul>
</ul>
<hr/>
<h1 id="elf">ELF format (Executable and Linkable Format)</h1>
<dl>
<dt>File extensions</td>
<dd><tt>.exe</tt> for OS/2 Warp PowerPC Edition</dd>
<dl>
<dt>Magic code</td>
<dd><tt>"\x<sup>7F</sup>ELF"</tt></dd>
<dl>
<dt>Architecture</td>
<dd>various</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>1988-10-18: System V Release 4.0 (replacing <a href="#coff">COFF</a>)</li>
<li>1995-03: Linux 1.2 (replacing <a href="#aout32">a.out</a>)</li>
<li>1995-12: OS/2 Warp PowerPC Edition (replacing <a href="#le">LE</a>)</li>
<li>1997-05-12<sup>?</sup>: PowerUP for Amiga (replacing <a href="#hunk">Hunk</a>)</li>
<li>2004-04: AmigaOS 4.0 (replacing and complementing <a href="#hunk">Hunk</a>)</li>
<li>1998-10: FreeBSD 3.0 (replacing <a href="aout32">a.out</a>)</li>
<li>1998-11-04: BeOS Release 4 on Intel 80386 (replacing <a href="#pe">PE</a>)</li>
<li>2000-12: NetBSD 1.5 (replacing <a href="aout32">a.out</a>)</li>
<li>2012-02-29: MINIX 3.2.0 (replacing <a href="aout_minix">a.out for MINIX</a>)</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>various</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#eheader">ELF header</a>
</li>
<li><a href="#pheader">Program header</a>
</li>
<li><a href="#sheader">Section header</a>
<ol>
<li><a href="#">Symbol table</a>
</li>
</ol></li>
<li><a href="#">OS/2 resource file format</a>
<ol>
<li><a href="#">Resource collection array entry</a>
</li>
<li><a href="#">Resource collection</a>
</li>
</ol></li>
<li><a href="#">OS/2 operating system information (<tt>.osinfo</tt>)</a>
</li>
<li><a href="#">OS/2 import table (<tt>.imports</tt>)</a>
</li>
<li><a href="#">OS/2 export table (<tt>.exports</tt>)</a>
</li>
<li><a href="#">Segment contents</a>
</li>
<li><a href="#">Dynamic linking</a>
</li>
<li><a href="#">Further work</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<table border='1' align='center'>
<tr>
<td><a href="#eheader">ELF header</a></td></tr>
<tr>
<td><a href="#pheader">Program header</a>, optional for objects, required for executables</td></tr>
<tr>
<td>Segment/section data</td></tr>
<tr>
<td><a href="#sheader">Section header</a>, required for objects, optional for executables</td></tr>
</table>
<a id="eheader"/>
<h2>ELF header</h1>
<table border='1' align='center'>
<tr>
<td colspan='2'><tt><sub>x</sub>00</tt></td>	<td colspan='2'>c[0x10]</td>
<td><tt>e_ident</tt>, machine-independent data to interpret the file's content, such as word size and byte order
<table border='1'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[4]</td>
<td><tt>EI_MAG = ELFMAG = "\x7F" "ELF"</tt>, signature</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i8</td>
<td><tt>EI_CLASS</tt>, file class
<table border='1'>
<tr>
<td>0</td>
<td><tt>ELFCLASSNONE</tt>, invalid</td></tr>
<tr>
<td>1</td>
<td><tt>ELFCLASS32</tt>, offsets and addresses are encoded as 32-bit fields</td></tr>
<tr>
<td>2</td>
<td><tt>ELFCLASS64</tt>, offsets and addresses are encoded as 64-bit fields</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i8</td>
<td><tt>EI_DATA</tt>, data encoding
<table border='1'>
<tr>
<td>0</td>
<td><tt>ELFDATANONE</tt>, invalid</td></tr>
<tr>
<td>1</td>
<td><tt>ELFDATA2LSB</tt>, 2's complement, least significant byte first (little endian)</td></tr>
<tr>
<td>2</td>
<td><tt>ELFDATA2MSB</tt>, 2's complement, most significant byte first (big endian)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i8</td>
<td><tt>EI_VERSION</tt>, file version
<table border='1'>
<tr>
<td>0</td>
<td><tt>EV_NONE</tt>, invalid</td></tr>
<tr>
<td>1</td>
<td><tt>EV_CURRENT</tt>, current version</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>07</tt></td>	<td>i8</td>
<td><tt>EI_OSABI</tt>, operating system and ABI</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i8</td>
<td><tt>EI_ABIVERSION</tt>, ABI version</td></tr>
<tr>
<td><tt><sub>x</sub>09</tt></td>	<td>c[9]</td>
<td><tt>EI_PAD</tt>, padding, filled with zeros</td></tr>
<tr>
<td><tt><sub>x</sub>0F</tt></td>	<td></td>
<td><tt>EI_NIDENT</tt>, end of <tt>e_ident</tt></td></tr>
</table>
</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>10</tt></td>	<td colspan='2'>i16</td>
<td><tt>e_type</tt>, object type
<table border='1'>
<tr>
<td>0x0000</td>
<td><tt>ET_NONE</tt>, no type</td></tr>
<tr>
<td>0x0001</td>
<td><tt>ET_REL</tt>, relocatable</td></tr>
<tr>
<td>0x0002</td>
<td><tt>ET_EXEC</tt>, executable</td></tr>
<tr>
<td>0x0003</td>
<td><tt>ET_DYN</tt>, shared object</td></tr>
<tr>
<td>0x0004</td>
<td><tt>ET_CORE</tt>, core dump</td></tr>
<tr>
<td>0xFE00</td>
<td><tt>ET_LOOS</tt>, first operating system specific</td></tr>
<tr>
<td>0xFEFF</td>
<td><tt>ET_HIOS</tt>, last operating system specific</td></tr>
<tr>
<td>0xFF00</td>
<td><tt>ET_LOPROC</tt>, first processor specific</td></tr>
<tr>
<td>0xFFFF</td>
<td><tt>ET_HIPROC</tt>, last processor specific</td></tr>
</table>
</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>12</tt></td>	<td colspan='2'>i16</td>
<td><tt>e_machine</tt>, architecture type
<table border='1'>
<tr>
<td>0x0000</td>
<td><tt>EM_NONE</tt>, no machine</td></tr>
<tr>
<td>0x0001</td>
<td><tt>EM_M32</tt>, "AT&T WE 32100"</td></tr>
<tr>
<td>0x0002</td>
<td><tt>EM_SPARC</tt>, "SPARC"</td></tr>
<tr>
<td>0x0003</td>
<td><tt>EM_386</tt>, "Intel 80386"</td></tr>
<tr>
<td>0x0004</td>
<td><tt>EM_68K</tt>, "Motorola 68000"</td></tr>
<tr>
<td>0x0005</td>
<td><tt>EM_88K</tt>, "Motorola 88000"</td></tr>
<tr>
<td>0x0008</td>
<td><tt>EM_MIPS</tt>, "MIPS I"</td></tr>
<tr>
<td>0x0014</td>
<td><tt>EM_PPC</tt>, 32-bit "PowerPC"</td></tr>
<tr>
<td>0x0015</td>
<td><tt>EM_PPC64</tt>, "64-bit PowerPC"</td></tr>
<tr>
<td>0x0028</td>
<td><tt>EM_ARM</tt>, "ARM 32-bit architecture (AARCH32)"</td></tr>
<tr>
<td>0x0029</td>
<td><tt>EM_ALPHA</tt>, "Digital Alpha"</td></tr>
<tr>
<td>0x002B</td>
<td><tt>EM_SPARCV9</tt>, "SPARC Version 9"</td></tr>
<tr>
<td>0x0032</td>
<td><tt>EM_IA_64</tt>, "Intel IA-64 processor architecture", Itanium</td></tr>
<tr>
<td>0x003E</td>
<td><tt>EM_X86_64</tt>, "AMD x86-64 architecture", AMD64</td></tr>
<tr>
<td>0x0040</td>
<td><tt>EM_PDP10</tt>, "Digital Equipment Corp. PDP-10"</td></tr>
<tr>
<td>0x0041</td>
<td><tt>EM_PDP11</tt>, "Digital Equipment Corp. PDP-11"</td></tr>
<tr>
<td>0x004B</td>
<td><tt>EM_VAX</tt>, "Digital VAX"</td></tr>
<tr>
<td>0x0050</td>
<td><tt>EM_MMIX</tt>, "Donald Knuth's educational 64-bit processor"</td></tr>
<tr>
<td>0x005C</td>
<td><tt>EM_OPENRISC</tt>, "OpenRISC 32-bit embedded processor"</td></tr>
<tr>
<td>0x0061</td>
<td><tt>EM_NS32K</tt>, "National Semiconductor 32000 series"</td></tr>
<tr>
<td>0x00B7</td>
<td><tt>EM_AARCH64</tt>, "ARM 64-bit architecture (AARCH64)"</td></tr>
<tr>
<td>0x00DC</td>
<td><tt>EM_Z80</tt>, "Zilog Z80"</td></tr>
<tr>
<td>0x00F3</td>
<td><tt>EM_RISCV</tt>, "RISC-V"</td></tr>
<tr>
<td>0x00F4</td>
<td><tt>EM_LANAI</tt>, "Lanai 32-bit processor"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x00F5</td>
<td><tt>EM_CEVA</tt>, "CEVA Processor Architecture Family"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x00F6</td>
<td><tt>EM_CEVA_X2</tt>, "CEVA X2 Processor Family"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x00F7</td>
<td><tt>EM_BPF</tt>, "Linux BPF"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x00F8</td>
<td><tt>EM_GRAPHCORE_IPU</tt>, "Graphcore Intelligent Processing Unit"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x00F9</td>
<td><tt>EM_IMG1</tt>, "Imagination Technologies"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x00FA</td>
<td><tt>EM_NFP</tt>, "Netronome Flow Processor"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x00FB</td>
<td><tt>EM_VE</tt>, "NEC Vector Engine"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x00FC</td>
<td><tt>EM_CSKY</tt>, "C-SKY processor family"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x00FD</td>
<td><tt>EM_ARC_COMPACT3_64</tt>, "Synopsys ARCv2.3 64-bit"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x00FE</td>
<td><tt>EM_MCS6502</tt>, "MOS Technologies MCS 6502 processor"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x00FF</td>
<td><tt>EM_ARC_COMPACT3</tt>, "Synopsys ARCv2.3 32-bit"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x0100</td>
<td><tt>EM_KVX</tt>, "Kalray VLIW core of the MPPA processor family"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x0101</td>
<td><tt>EM_65816</tt>, "WDC 65816/65C816"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x0102</td>
<td><tt>EM_LOONGARCH</tt>, "LoongArch"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x0103</td>
<td><tt>EM_KF32</tt>, "ChipON KungFu32"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x0104</td>
<td><tt>EM_U16_U8CORE</tt>, "LAPIS nX-U16/U8"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x0105</td>
<td><tt>EM_TACHYUM</tt>, "Tachyum"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x0106</td>
<td><tt>EM_56800EF</tt>, "NXP 56800EF Digital Signal Controller (DSC)"<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>0x1966</td>
<td><tt>EM_MOS</tt>, MOS 6502 family (duplicates EM_MCS6502 and EM_65816)<a href="https://llvm-mos.org/wiki/ELF_specification" target="_blank"><sup>LLVM-MOS</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>14</tt></td>	<td colspan='2'>i32</td>
<td><tt>e_version</tt>, object file format version
<table border='1'>
<tr>
<td>0</td>
<td><tt>EV_NONE</tt>, invalid</td></tr>
<tr>
<td>1</td>
<td><tt>EV_CURRENT</tt>, current version</td></tr>
</table>
</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>18</tt></td>	<td>i32</td><td>i64</td>
<td><tt>e_entry</tt>, virtual address of entry point</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td><td><tt><sub>x</sub>20</tt></td>	<td>i32</td><td>i64</td>
<td><tt>e_phoff</tt>, offset to <a href="#pheader">Program header</a> in bytes from file start</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td><td><tt><sub>x</sub>28</tt></td>	<td>i32</td><td>i64</td>
<td><tt>e_shoff</tt>, offset to <a href="#sheader">Section header</a> in bytes from file start</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td><td><tt><sub>x</sub>30</tt></td>	<td colspan='2'>i32</td>
<td><tt>e_flags</tt>, processor specific flags</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td><td><tt><sub>x</sub>32</tt></td>	<td colspan='2'>i16</td>
<td><tt>e_ehsize</tt>, size of <a href="#eheader">ELF header</a> in bytes<br>for <tt>EV_CURRENT</tt>, it should be <tt><sub>x</sub>34</tt> for 32-bit objects, <tt><sub>x</sub>3E</tt> for 64-bit objects</td></tr>
<tr>
<td><tt><sub>x</sub>2A</tt></td><td><tt><sub>x</sub>34</tt></td>	<td colspan='2'>i16</td>
<td><tt>e_phentsize</tt>, size of a single entry in <a href="#pheader">Program header</a> in bytes<br>for <tt>EV_CURRENT</tt>, if non-zero, it should be <tt><sub>x</sub>20</tt> for 32-bit objects, <tt><sub>x</sub>38</tt> for 64-bit objects</td></tr>
<tr>
<td><tt><sub>x</sub>2C</tt></td><td><tt><sub>x</sub>36</tt></td>	<td colspan='2'>i16</td>
<td><tt>e_phnum</tt>, number of entries in <a href="#pheader">Program header</a></td></tr>
<tr>
<td><tt><sub>x</sub>2E</tt></td><td><tt><sub>x</sub>38</tt></td>	<td colspan='2'>i16</td>
<td><tt>e_shentsize</tt>, size of a single entry in <a href="#sheader">Section header</a> in bytes<br>for <tt>EV_CURRENT</tt>, if non-zero, it should be <tt><sub>x</sub>28</tt> for 32-bit objects, <tt><sub>x</sub>40</tt> for 64-bit objects</td></tr>
<tr>
<td><tt><sub>x</sub>30</tt></td><td><tt><sub>x</sub>3A</tt></td>	<td colspan='2'>i16</td>
<td><tt>e_shnum</tt>, number of entries in <a href="#sheader">Section header</a><br>If greater or equal than <tt><sub>x</sub>FF00</tt>, 0 is stored here, and the <tt>sh_size</tt> field in the first entry of the <a href="#sheader">Section header</a> contains the value</td></tr>
<tr>
<td><tt><sub>x</sub>32</tt></td><td><tt><sub>x</sub>3C</tt></td>	<td colspan='2'>i16</td>
<td><tt>e_shstrndx</tt>, section header index for section name string table<br>If greater or equal than <tt><sub>x</sub>FF00</tt>, 0 is stored here, and the <tt>sh_link</tt> field in the first entry of the <a href="#sheader">Section header</a></td></tr>
</table>
<a id="pheader"/>
<h2>Program header</h1>
<p>A single entry has the following form. Note that the offset between entries is <tt>e_phentsize</tt> as found in the <a href="#eheader">ELF header</a>. Its format is slightly different between 32-bit and 64-bit versions.</p>
<table border='1' align='center'>
<tr>
<td colspan='2'><tt><sub>x</sub>00</tt></td>	<td colspan='2'>i32</td>
<td><tt>p_type</tt>
<table border='1'>
<tr>
<td><tt><sub>x</sub>00000000</tt></td>
<td><tt>PT_NULL</tt>, unused</td></tr>
<tr>
<td><tt><sub>x</sub>00000001</tt></td>
<td><tt>PT_LOAD</tt>, loadable segment</td></tr>
<tr>
<td><tt><sub>x</sub>00000002</tt></td>
<td><tt>PT_DYNAMIC</tt>, dynamic linking information</td></tr>
<tr>
<td><tt><sub>x</sub>00000003</tt></td>
<td><tt>PT_INTERP</tt>, null-terminated path name for interpreter to invoke<br>must have at most 1 entry, only defined for executables</td></tr>
<tr>
<td><tt><sub>x</sub>00000004</tt></td>
<td><tt>PT_NOTE</tt>, auxiliary information</td></tr>
<tr>
<td><tt><sub>x</sub>00000005</tt></td>
<td><tt>PT_SHLIB</tt>, reserved</td></tr>
<tr>
<td><tt><sub>x</sub>00000006</tt></td>
<td><tt>PT_PHDR</tt>, program header, must have at most 1 entry<br>only occurs if program header is part of memory image, must precede all other segment entries</td></tr>
<tr>
<td><tt><sub>x</sub>00000007</tt></td>
<td><tt>PT_TLS</tt>, thread-local storage template</td></tr>
<tr>
<td><tt><sub>x</sub>60000000</tt></td>
<td><tt>PT_LOOS</tt>, first operating system specific type</td></tr>
<tr>
<td><tt><sub>x</sub>6FFFFFFF</tt></td>
<td><tt>PT_HIOS</tt>, last operating system specific type</td></tr>
<tr>
<td><tt><sub>x</sub>70000000</tt></td>
<td><tt>PT_LOPROC</tt>, first processor specific type</td></tr>
<tr>
<td><tt><sub>x</sub>7FFFFFFF</tt></td>
<td><tt>PT_HIPROC</tt>, last processor specific type</td></tr>
<tr>
<td><tt><sub>x</sub>80000000</tt></td>
<td><tt>PT_LOUSER</tt>, first application specific type</td></tr>
<tr>
<td><tt><sub>x</sub>8FFFFFFF</tt></td>
<td><tt>PT_HIUSER</tt>, last application specific type</td></tr>
<tr>
<td><tt><sub>x</sub>60000001</tt></td>
<td><tt>PT_OS</tt>, IBM OS/2 extension, identifies the target operating system<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>60000002</tt></td>
<td><tt>PT_RES</tt>, IBM OS/2 extension, read-only resource data<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>6474E550</tt></td>
<td><tt>PT_SUNW_EH_FRAME</tt>, <tt>PT_GNU_EH_FRAME</tt>, Solaris extension, frame unwind information<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>6474E551</tt></td>
<td><tt>PT_GNU_STACK</tt>, GNU extension, stack flags<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>6474E552</tt></td>
<td><tt>PT_GNU_RELRO</tt>, GNU extension, read-only after relocation<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>6474E553</tt></td>
<td><tt>PT_GNU_PROPERTY</tt>, GNU extension, GNU property<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>6474E554</tt></td>
<td><tt>PT_GNU_SFRAME</tt>, GNU extension, stack trace information<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>6474E555</tt></td>
<td><tt>PT_GNU_MBIND_LO</tt>, GNU extension<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>6474F554</tt></td>
<td><tt>PT_GNU_MBIND_HI</tt>, GNU extension<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>65A3DBE5</tt></td>
<td><tt>PT_OPENBSD_MUTABLE</tt>, OpenBSD extension, mutable .bss<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>65A3DBE6</tt></td>
<td><tt>PT_OPENBSD_RANDOMIZE</tt>, OpenBSD extension, fill with random data<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>65A3DBE7</tt></td>
<td><tt>PT_OPENBSD_WXNEEDED</tt>, OpenBSD extension, program does W^X violation<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>65A3DBE8</tt></td>
<td><tt>PT_OPENBSD_NOBTCFI</tt>, OpenBSD extension, no branch target CFI<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>65A41BE6</tt></td>
<td><tt>PT_OPENBSD_BOOTDATA</tt>, OpenBSD extension, section for boot arguments<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td style='background:gray;'>&nbsp;&nbsp;&nbsp;</td><td><tt><sub>x</sub>04</tt></td>	<td style='background:gray;'>&nbsp;&nbsp;&nbsp;</td><td>i32</td>
<td><tt>p_flags</tt>
<table border='1'>
<tr>
<td>Bit 0</td>
<td><tt>PF_X</tt>, executable</td></tr>
<tr>
<td>Bit 1</td>
<td><tt>PF_W</tt>, writable</td></tr>
<tr>
<td>Bit 2</td>
<td><tt>PF_R</tt>, readable</td></tr>
<tr>
<td>Bits 20:27</td>
<td><tt>PF_MASKOS</tt>, operating system specific</td></tr>
<tr>
<td>Bits 28:31</td>
<td><tt>PF_MASKPROC</tt>, processor specific</td></tr>
<tr>
<td>Bit 24</td>
<td><tt>PF_S</tt>, IBM OS/2 extension, shared segment<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></td></tr>
<tr>
<td>Bit 25</td>
<td><tt>PF_K</tt>, IBM OS/2 extension, mapped to kernel address space<br>kernel extension, executes at supervisor privilege, implicitly memory resident<br>only valid for DLLs, must be specified for all <tt>PT_LOAD</tt> segments if used<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></td></tr>
<tr>
<td>Bit 26</td>
<td><tt>PF_M</tt>, IBM OS/2 extension, memory resident<br>must be specified for all <tt>PT_LOAD</tt> segments if used<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td><td><tt><sub>x</sub>08</tt></td>	<td>i32</td><td>i64</td>
<td><tt>p_offset</tt>, offset to data from start of file</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td><td><tt><sub>x</sub>10</tt></td>	<td>i32</td><td>i64</td>
<td><tt>p_vaddr</tt>, virtual address to load at</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td><td><tt><sub>x</sub>18</tt></td>	<td>i32</td><td>i64</td>
<td><tt>p_paddr</tt>, physical address to load at, unused for System V executables and shared objects</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td><td><tt><sub>x</sub>20</tt></td>	<td>i32</td><td>i64</td>
<td><tt>p_filesz</tt>, number of bytes in the file image</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td><td><tt><sub>x</sub>28</tt></td>	<td>i32</td><td>i64</td>
<td><tt>p_memsz</tt>, number of bytes in the memory image</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td><td style='background:gray;'>&nbsp;&nbsp;&nbsp;</td>	<td>i32</td><td style='background:gray;'>&nbsp;&nbsp;&nbsp;</td>
<td><tt>p_flags</tt>, see above</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td><td><tt><sub>x</sub>30</tt></td>	<td>i32</td><td>i64</td>
<td><tt>p_align</tt>, alignment constraint, 0 or 1 means no constraint, otherwise must be a power of 2</td></tr>
</table>
<a id="sheader"/>
<h2>Section header</h1>
<p>A single entry has the following form. Note that the offset between entries is <tt>e_shentsize</tt> as found in the <a href="#eheader">ELF header</a>. Its format is slightly different between 32-bit and 64-bit versions.</p>
<table border='1' align='center'>
<tr>
<td colspan='2'><tt><sub>x</sub>00</tt></td>	<td colspan='2'>i32</td>
<td><tt>sh_name</tt>, index into the section header table (<tt>e_shstrndx</tt>) for the name, or 0</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>04</tt></td>	<td colspan='2'>i32</td>
<td><tt>sh_type</tt>
<table border='1'>
<tr>
<td><tt><sub>x</sub>00000000</tt></td>
<td><tt>SHT_NULL</tt>, inactive entry, entry 0 must be of this type</td></tr>
<tr>
<td><tt><sub>x</sub>00000001</tt></td>
<td><tt>SHT_PROGBITS</tt>, program data (instructions, initialized data, etc.)</td></tr>
<tr>
<td><tt><sub>x</sub>00000002</tt></td>
<td><tt>SHT_SYMTAB</tt>, symbol table, expected to have at most 1, used for linking</td></tr>
<tr>
<td><tt><sub>x</sub>00000003</tt></td>
<td><tt>SHT_STRTAB</tt>, string table</td></tr>
<tr>
<td><tt><sub>x</sub>00000004</tt></td>
<td><tt>SHT_RELA</tt>, relocation table with explicit addends</td></tr>
<tr>
<td><tt><sub>x</sub>00000005</tt></td>
<td><tt>SHT_HASH</tt>, symbol hash table, expected to have at most 1</td></tr>
<tr>
<td><tt><sub>x</sub>00000006</tt></td>
<td><tt>SHT_DYNAMIC</tt>, information for dynamic linking, expected to have at most 1</td></tr>
<tr>
<td><tt><sub>x</sub>00000007</tt></td>
<td><tt>SHT_NOTE</tt>, information to mark the file</td></tr>
<tr>
<td><tt><sub>x</sub>00000008</tt></td>
<td><tt>SHT_NOBITS</tt>, program data, not present in file (uninitialized data)</td></tr>
<tr>
<td><tt><sub>x</sub>00000009</tt></td>
<td><tt>SHT_REL</tt>, relocation table without explicit addends</td></tr>
<tr>
<td><tt><sub>x</sub>0000000A</tt></td>
<td><tt>SHT_SHLIB</tt>, reserved</td></tr>
<tr>
<td><tt><sub>x</sub>0000000B</tt></td>
<td><tt>SHT_DYNSYM</tt>, symbol table, expected to have at most 1, used for dynamic linking</td></tr>
<tr>
<td><tt><sub>x</sub>0000000E</tt></td>
<td><tt>SHT_INIT_ARRAY</tt></td></tr>
<tr>
<td><tt><sub>x</sub>0000000F</tt></td>
<td><tt>SHT_FINI_ARRAY</tt></td></tr>
<tr>
<td><tt><sub>x</sub>00000010</tt></td>
<td><tt>SHT_PREINIT_ARRAY</tt></td></tr>
<tr>
<td><tt><sub>x</sub>00000011</tt></td>
<td><tt>SHT_GROUP</tt>, defines a group of sections, only allowed in relocatable objects, entry must precede contained sections</td></tr>
<tr>
<td><tt><sub>x</sub>00000012</tt></td>
<td><tt>SHT_SYMTAB_SHNDX</tt></td></tr>
<tr>
<td><tt><sub>x</sub>60000000</tt></td>
<td><tt>SHT_LOOS</tt>, first operating system specific type</td></tr>
<tr>
<td><tt><sub>x</sub>6FFFFFFF</tt></td>
<td><tt>SHT_HIOS</tt>, last operating system specific type</td></tr>
<tr>
<td><tt><sub>x</sub>70000000</tt></td>
<td><tt>SHT_LOPROC</tt>, first processor specific type</td></tr>
<tr>
<td><tt><sub>x</sub>7FFFFFFF</tt></td>
<td><tt>SHT_HIPROC</tt>, last processor specific type</td></tr>
<tr>
<td><tt><sub>x</sub>80000000</tt></td>
<td><tt>SHT_LOUSER</tt>, first application specific type</td></tr>
<tr>
<td><tt><sub>x</sub>8FFFFFFF</tt></td>
<td><tt>SHT_HIUSER</tt>, last application specific type</td></tr>
<tr>
<td><tt><sub>x</sub>60000001</tt></td>
<td><tt>SHT_OS</tt>, IBM OS/2 extension, identifies the target operating system<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>60000002</tt></td>
<td><tt>SHT_IMPORTS</tt>, IBM OS/2 extension, external symbol references<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>60000003</tt></td>
<td><tt>SHT_EXPORTS</tt>, IBM OS/2 extension, exported symbols<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>60000004</tt></td>
<td><tt>SHT_RES</tt>, IBM OS/2 extension, read-only resource data<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>6FFF4700</tt></td>
<td><tt>SHT_GNU_INCREMENTAL_INPUTS</tt>, GNU extension, incremental build data<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>6FFFFFF5</tt></td>
<td><tt>SHT_GNU_ATTRIBUTES</tt>, GNU extension, object attributes<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>6FFFFFF6</tt></td>
<td><tt>SHT_GNU_HASH</tt>, GNU extension, GNU style symbol hash table<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>6FFFFFF7</tt></td>
<td><tt>SHT_GNU_LIBLIST</tt>, GNU extension, list of prelinked dependencies<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>6FFFFFFD</tt></td>
<td><tt>SHT_SUNW_verdef</tt>, <tt>SHT_GNU_verdef</tt>, Solaris extension, versions defined by file<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>6FFFFFFE</tt></td>
<td><tt>SHT_SUNW_verneed</tt>, <tt>SHT_GNU_verneed</tt>, Solaris extension, versions needed by file<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>6FFFFFFF</tt></td>
<td><tt>SHT_SUNW_versym</tt>, <tt>SHT_GNU_versym</tt>, Solaris extension, symbol versions<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>08</tt></td>	<td>i32</td><td>i64</td>
<td><tt>sh_flags</tt>, section properties
<table border='1'>
<tr>
<td>Bit 0</td>
<td><tt>SHF_WRITE</tt>, writable during execution</td></tr>
<tr>
<td>Bit 1</td>
<td><tt>SHF_ALLOC</tt>, resides in memory during execution</td></tr>
<tr>
<td>Bit 2</td>
<td><tt>SHF_EXECINSTR</tt>, contains machine instructions</td></tr>
<tr>
<td>Bit 4</td>
<td><tt>SHF_MERGE</tt>, data may be merged during linking, <tt>sh_entsize</tt> contains an element size, unless <tt>SHF_STRINGS</tt> is set</td></tr>
<tr>
<td>Bit 5</td>
<td><tt>SHF_STRINGS</tt>, contains null-terminated strings, <tt>sh_entsize</tt> gives the character size</td></tr>
<tr>
<td>Bit 6</td>
<td><tt>SHF_INFO_LINK</tt>, <tt>sh_info</tt> contains a section header index</td></tr>
<tr>
<td>Bit 7</td>
<td><tt>SHF_LINK_ORDER</tt>, must preserve order with section index <tt>sh_link</tt> when linking</td></tr>
<tr>
<td>Bit 8</td>
<td><tt>SHF_OS_NONCONFORMING</tt>, requires OS-specific processing</td></tr>
<tr>
<td>Bit 9</td>
<td><tt>SHF_GROUP</tt>, member of a section group</td></tr>
<tr>
<td>Bit 10</td>
<td><tt>SHF_TLS</tt>, holds thread-local storage, each thread will have a separate copy during execution</td></tr>
<tr>
<td>Bit 11</td>
<td><tt>SHF_COMPRESSED</tt>, data is compressed, must not be used for <tt>SHT_NOBITS</tt> or together with <tt>SHF_ALLOC</tt></td></tr>
<tr>
<td>Bits 20:27</td>
<td><tt>SHF_MASKOS</tt>, mask for operating system semantics</td></tr>
<tr>
<td>Bits 24:27</td>
<td>Value for <tt>SHF_MASKOS</tt> before 1999-10-04<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>Bits 28:31</td>
<td><tt>SHF_MASKPROC</tt>, mask for processor semantics</td></tr>
<tr>
<td>Bit 24</td>
<td><tt>SHF_BEGIN</tt>, IBM OS/2 extension, signals that this must be placed before other like-named sections<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></td></tr>
<tr>
<td>Bit 25</td>
<td><tt>SHF_END</tt>, IBM OS/2 extension, signals that this must be placed after other like-named sections<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></td></tr>
<tr>
<td>Bit 21</td>
<td><tt>SHF_GNU_RETAIN</tt>, GNU extension, section should not be garbage collected by linker<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>Bit 24</td>
<td><tt>SHF_GNU_MBIND</tt>, GNU extension<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
<tr>
<td>Bit 31</td>
<td><tt>SHF_EXCLUDE</tt>, exclude from linking into non-relocatable objects<a href="#binutils"><sup title="common.h - GNU Binutils sources">[2]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td><td><tt><sub>x</sub>10</tt></td>	<td>i32</td><td>i64</td>
<td><tt>sh_addr</tt>, address at which section should appear, or 0</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td><td><tt><sub>x</sub>18</tt></td>	<td>i32</td><td>i64</td>
<td><tt>sh_offset</tt>, offset to section data from start of file; a section of type <tt>SHT_NOBITS</tt> will contain a conceptual offset</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td><td><tt><sub>x</sub>20</tt></td>	<td>i32</td><td>i64</td>
<td><tt>sh_size</tt>, size of section in bytes; unless <tt>sh_type</tt> is <tt>SHT_NOBITS</tt>, this many bytes appear in the file</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td><td><tt><sub>x</sub>28</tt></td>	<td colspan='2'>i32</td>
<td><tt>sh_link</tt></td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td><td><tt><sub>x</sub>2C</tt></td>	<td colspan='2'>i32</td>
<td><tt>sh_info</tt></td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td><td><tt><sub>x</sub>30</tt></td>	<td>i32</td><td>i64</td>
<td><tt>sh_addralign</tt>, alignment constraint, 0 or 1 mean no alignment, otherwise it must be a power of 2</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td><td><tt><sub>x</sub>38</tt></td>	<td>i32</td><td>i64</td>
<td><tt>sh_entsize</tt>, for tables, the size of a single entry</td></tr>
</table>
<p>Sections are indexed from 0, but the first section entry should be an <tt>SHT_NULL</tt> type with all fields, except for <tt>sh_size</tt> which contains the number of sections if greater or equal to <tt><sub>x</sub>FF00</tt>, and <tt>sh_link</tt> which contains the index of of the section header string table if greater or equal to <tt><sub>x</sub>FF00</tt>.</p>
<p>Some section values are reserved and have special semantics:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>0000</tt></td>
<td><tt>SHN_UNDEF</tt>, section index is missing or irrelevant</td></tr>
<tr>
<td><tt><sub>x</sub>FF00</tt></td>
<td><tt>SHN_LORESERVE</tt>, first special semantics</td></tr>
<tr>
<td><tt><sub>x</sub>FF00</tt></td>
<td><tt>SHN_LOPROC</tt>, first processor specific entry</td></tr>
<tr>
<td><tt><sub>x</sub>FF1F</tt></td>
<td><tt>SHN_HIPROC</tt>, last processor specific entry</td></tr>
<tr>
<td><tt><sub>x</sub>FF20</tt></td>
<td><tt>SHN_LOOS</tt>, first operating system specific entry</td></tr>
<tr>
<td><tt><sub>x</sub>FF3F</tt></td>
<td><tt>SHN_HIOS</tt>, last operating system specific entry</td></tr>
<tr>
<td><tt><sub>x</sub>FFF1</tt></td>
<td><tt>SHN_ABS</tt>, absolute reference, no associated section</td></tr>
<tr>
<td><tt><sub>x</sub>FFF2</tt></td>
<td><tt>SHN_COMMON</tt>, unallocated variables (FORTRAN COMMON, C external uninitialized)</td></tr>
<tr>
<td><tt><sub>x</sub>FFFF</tt></td>
<td><tt>SHN_XINDEX</tt>, signals that actual value greater or equal than <tt><sub>x</sub>FF00</tt></td></tr>
<tr>
<td><tt><sub>x</sub>FFFF</tt></td>
<td><tt>SHN_HIRESERVE</tt>, last special semantics</td></tr>
</table>
<p>The field entries <tt>sh_link</tt> and <tt>sh_info</tt> have semantics that depend on the section type:</p>
<table border='1' align='center'>
<tr>
<td>name</td>
<td><tt>sh_link</tt></td>
<td><tt>sh_info</tt></td></tr>
<tr>
<td><tt>SHT_DYNAMIC</tt></td>
<td>string table</td>
<td>0</td></tr>
<tr>
<td><tt>SHT_HASH</tt></td>
<td>symbol table</td>
<td>0</td></tr>
<tr>
<td><tt>SHT_REL</tt><br><tt>SHT_RELA</tt></td>
<td>symbol table</td>
<td>section to relocate</td></tr>
<tr>
<td><tt>SHT_SYMTAB</tt><br><tt>SHT_DYNSYM</tt></td>
<td>string table</td>
<td>index after last local symbol (<tt>STB_LOCAL</tt>)</td></tr>
<tr>
<td><tt>SHT_GROUP</tt></td>
<td>symbol table</td>
<td>symbol table index for group signature</td></tr>
<tr>
<td><tt>SHT_SYMTAB_SHNDX</tt></td>
<td>symbol table</td>
<td>0</td></tr>
<tr>
<td><tt>SHT_IMPORTS</tt></td>
<td>string table</td>
<td>0</td></tr>
<tr>
<td><tt>SHT_EXPORTS</tt></td>
<td>symbol table</td>
<td>string table</td></tr>
</table>
<p>Some sections have special semantics.</p>
<table border='1' align='center'>
<tr>
<td>name</td>
<td>type</td>
<td>attributes</td></tr>
<tr>
<td><tt>.bss</tt></td>
<td><tt>SHT_NOBITS</tt></td>
<td><tt>SHF_ALLOC+SHF_WRITE</tt></td></tr>
<tr>
<td><tt>.data</tt></td>
<td><tt>SHT_PROGBITS</tt></td>
<td><tt>SHF_ALLOC+SHF_WRITE</tt></td></tr>
<tr>
<td><tt>.debug</tt></td>
<td><tt>SHT_PROGBITS</tt></td>
<td>0</td></tr>
<tr>
<td><tt>.dynamic</tt></td>
<td><tt>SHT_DYNAMIC</tt></td>
<td><tt>SHF_ALLOC</tt>, depending on processor, also <tt>SHF_WRITE</tt></td></tr>
<tr>
<td><tt>.dynstr</tt></td>
<td><tt>SHT_STRTAB</tt></td>
<td><tt>SHF_ALLOC</tt></td></tr>
<tr>
<td><tt>.dynsym</tt></td>
<td><tt>SHT_DYNSYM</tt></td>
<td><tt>SHF_ALLOC</tt></td></tr>
<tr>
<td><tt>.got</tt></td>
<td><tt>SHT_PROGBITS</tt></td>
<td>???</td></tr>
<tr>
<td><tt>.hash</tt></td>
<td><tt>SHT_HASH</tt></td>
<td><tt>SHF_ALLOC</tt></td></tr>
<tr>
<td><tt>.interp</tt></td>
<td><tt>SHT_PROGBITS</tt></td>
<td>optionally <tt>SHF_ALLOC</tt></td></tr>
<tr>
<td><tt>.line</tt></td>
<td><tt>SHT_PROGBITS</tt></td>
<td>0</td></tr>
<tr>
<td><tt>.plt</tt></td>
<td><tt>SHT_PROGBITS</tt></td>
<td>???</td></tr>
<tr>
<td><tt>.rel</tt><i>name</i></td>
<td><tt>SHT_REL</tt></td>
<td>optionally <tt>SHF_ALLOC</tt></td></tr>
<tr>
<td><tt>.rodata</tt></td>
<td><tt>SHT_PROGBITS</tt></td>
<td><tt>SHF_ALLOC</tt></td></tr>
<tr>
<td><tt>.shstrtab</tt></td>
<td><tt>SHT_STRTAB</tt></td>
<td>0</td></tr>
<tr>
<td><tt>.strtab</tt></td>
<td><tt>SHT_STRTAB</tt></td>
<td>optionally <tt>SHF_ALLOC</tt></td></tr>
<tr>
<td><tt>.symtab</tt></td>
<td><tt>SHT_SYMTAB</tt></td>
<td>optionally <tt>SHF_ALLOC</tt></td></tr>
<tr>
<td><tt>.tbss</tt></td>
<td><tt>SHT_NOBITS</tt></td>
<td><tt>SHF_ALLOC+SHF_WRITE+SHF_TLS</tt></td></tr>
<tr>
<td><tt>.tdata</tt></td>
<td><tt>SHT_PROGBITS</tt></td>
<td><tt>SHF_ALLOC+SHF_WRITE+SHF_TLS</tt></td></tr>
<tr>
<td><tt>.text</tt></td>
<td><tt>SHT_PROGBITS</tt></td>
<td><tt>SHF_ALLOC+SHF_EXECINSTR</tt></td></tr>
<tr>
<td><tt>.osinfo</tt></td>
<td><tt>SHT_OS</tt></td>
<td>0</td></tr>
<tr>
<td><tt>.imports</tt></td>
<td><tt>SHT_IMPORTS</tt></td>
<td><tt>SHF_ALLOC</tt></td></tr>
<tr>
<td><tt>.exports</tt></td>
<td><tt>SHT_EXPORTS</tt></td>
<td><tt>SHF_ALLOC</tt></td></tr>
<tr>
<td><tt>.res</tt></td>
<td><tt>SHT_RES</tt></td>
<td>0</td></tr>
</table>
<h3>Symbol table</h2>
<p>A symbol table is a section that contains an array of the following entries.</p>
<table border='1' align='center'>
<tr>
<td colspan='2'><tt><sub>x</sub>00</tt></td>	<td colspan='2'>i32</td>
<td><tt>st_name</tt></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td><td style='background:gray;'>&nbsp;&nbsp;&nbsp;</td>	<td>i32</td><td style='background:gray;'>&nbsp;&nbsp;&nbsp;</td>
<td><tt>st_value</tt>, semantics depend on type</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td><td style='background:gray;'>&nbsp;&nbsp;&nbsp;</td>	<td>i32</td><td style='background:gray;'>&nbsp;&nbsp;&nbsp;</td>
<td><tt>st_size</tt>, size of symbol or 0 if unknown</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td><td><tt><sub>x</sub>04</tt></td>	<td colspan='2'>i8</td>
<td><tt>st_info</tt>
<table border='1'>
<tr>
<td>Bits 0:3</td>
<td><tt>st_type</tt>
<table border='1'>
<tr>
<td><tt><sub>x</sub>0</tt></td>
<td><tt>STT_NOTYPE</tt>, unspecified</td></tr>
<tr>
<td><tt><sub>x</sub>1</tt></td>
<td><tt>STT_OBJECT</tt>, symbol is a data object (variable, array)</td></tr>
<tr>
<td><tt><sub>x</sub>2</tt></td>
<td><tt>STT_FUNC</tt>, symbol is a function</td></tr>
<tr>
<td><tt><sub>x</sub>3</tt></td>
<td><tt>STT_SECTION</tt>, symbol is a section, typically <tt>STB_LOCAL</tt></td></tr>
<tr>
<td><tt><sub>x</sub>4</tt></td>
<td><tt>STT_FILE</tt>, symbol name is the source file name<br>if present, it conventionally precedes all other symbols, has section <tt>SHN_ABS</tt> and type <tt>SHB_LOCAL</tt></td></tr>
<tr>
<td><tt><sub>x</sub>5</tt></td>
<td><tt>STT_COMMON</tt>, symbol for an uninitialized common block</td></tr>
<tr>
<td><tt><sub>x</sub>6</tt></td>
<td><tt>STT_TLS</tt>, symbol for a thread-local storage entry, contains the offset, not the address of the symbol</td></tr>
<tr>
<td><tt><sub>x</sub>A</tt></td>
<td><tt>STT_LOOS</tt>, first operating system specific symbol type</td></tr>
<tr>
<td><tt><sub>x</sub>C</tt></td>
<td><tt>STT_HIOS</tt>, last operating system specific symbol type</td></tr>
<tr>
<td><tt><sub>x</sub>D</tt></td>
<td><tt>STT_LOPROC</tt>, first processor specific symbol type</td></tr>
<tr>
<td><tt><sub>x</sub>F</tt></td>
<td><tt>STT_HIPROC</tt>, last processor specific symbol type</td></tr>
<tr>
<td><tt><sub>x</sub>B</tt></td>
<td><tt>STT_IMPORT</tt>, IBM OS/2 extension: a function symbol that must be imported, <tt>st_value</tt> contains offset of import table entry<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td>Bits 4:7</td>
<td><tt>st_bind</tt>
<table border='1'>
<tr>
<td><tt><sub>x</sub>0</tt></td>
<td><tt>STB_LOCAL</tt>, not visible outside object file</td></tr>
<tr>
<td><tt><sub>x</sub>1</tt></td>
<td><tt>STB_GLOBAL</tt>, visible to all files, undefined symbols will match a global symbol</td></tr>
<tr>
<td><tt><sub>x</sub>2</tt></td>
<td><tt>STB_WEAK</tt>, global symbol of lower precedence when matching</td></tr>
<tr>
<td><tt><sub>x</sub>A</tt></td>
<td><tt>STB_LOOS</tt>, first operating system specific binding type</td></tr>
<tr>
<td><tt><sub>x</sub>C</tt></td>
<td><tt>STB_HIOS</tt>, last operating system specific binding type</td></tr>
<tr>
<td><tt><sub>x</sub>D</tt></td>
<td><tt>STB_LOPROC</tt>, first processor specific binding type</td></tr>
<tr>
<td><tt><sub>x</sub>F</tt></td>
<td><tt>STB_HIPROC</tt>, last processor specific binding type</td></tr>
<tr>
<td><tt><sub>x</sub>C</tt></td>
<td><tt>STB_ENTRY</tt>, IBM OS/2 extension: entry point<br>only for relocatable objects, must have at most 1<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0D</tt></td><td><tt><sub>x</sub>05</tt></td>	<td colspan='2'>i8</td>
<td><tt>st_other</tt>
<table border='1'>
<tr>
<td>Bits 0:1</td>
<td><tt>st_visibility</tt>
<table border='1'>
<tr>
<td><tt><sub>x</sub>00</tt></td>
<td><tt>STV_DEFAULT</tt></td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>
<td><tt>STV_INTERNAL</tt></td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>
<td><tt>STV_HIDDEN</tt></td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>
<td><tt>STV_PROTECTED</tt></td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td><td><tt><sub>x</sub>06</tt></td>	<td colspan='2'>i16</td>
<td><tt>st_shndx</tt>, section relative to which this symbol is defined
<table border='1'>
<tr>
<td><tt>SHN_ABS</tt></td>
<td><tt>st_value</tt> is an absolute value</td></tr>
<tr>
<td><tt>SHN_COMMON</tt></td>
<td><tt>st_value</tt> contains an alignment constraint</td></tr>
<tr>
<td><tt>SHN_UNDEF</tt></td>
<td>the symbol is undefined, must be defined in another object</td></tr>
<tr>
<td><tt>SHN_XINDEX</tt></td>
<td>actual value is stored in a section of type <tt>SHT_SYMTAB_SHNDX</tt></td></tr>
</table>
</td></tr>
<tr>
<td style='background:gray;'>&nbsp;&nbsp;&nbsp;</td><td><tt><sub>x</sub>08</tt></td>	<td style='background:gray;'>&nbsp;&nbsp;&nbsp;</td><td>i64</td>
<td><tt>st_value</tt>, semantics depend on type</td></tr>
<tr>
<td style='background:gray;'>&nbsp;&nbsp;&nbsp;</td><td><tt><sub>x</sub>10</tt></td>	<td style='background:gray;'>&nbsp;&nbsp;&nbsp;</td><td>i64</td>
<td><tt>st_size</tt>, size of symbol or 0 if unknown</td></tr>
</table>
<p>Symbols are indexed from 0, but the first symbol entry should contain all zeroes and <tt>st_shndx</tt> should be <tt>SHN_UNDEF</tt>.</p>
<h2>OS/2 resource file format</h1>
<p>A resource file begins with a <tt>Res32_File</tt> header.<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[0x10]</td>
<td><tt>rf_ident</tt>
<table border='1'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[4]</td>
<td><tt>RF_MAG = '\x02RES'</tt>, signature</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i8</td>
<td><tt>RF_CLASS</tt>, file class
<table border='1'>
<tr>
<td>0</td>
<td><tt>RESCLASSNONE</tt>, invalid</td></tr>
<tr>
<td>1</td>
<td><tt>RESCLASS32</tt>, offsets and addresses are encoded as 32-bit fields</td></tr>
<tr>
<td>2</td>
<td><tt>RESCLASS64</tt>, reserved for 64-bit architectures</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i8</td>
<td><tt>RF_DATA</tt>, data encoding
<table border='1'>
<tr>
<td>0</td>
<td><tt>RESDATANONE</tt>, invalid</td></tr>
<tr>
<td>1</td>
<td><tt>RESDATA2LSB</tt>, 2's complement, least significant byte first (little endian)</td></tr>
<tr>
<td>2</td>
<td><tt>RESDATA2MSB</tt>, 2's complement, most significant byte first (big endian)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i8</td>
<td><tt>RF_VERSION</tt>, file version
<table border='1'>
<tr>
<td>0</td>
<td><tt>RV_NONE</tt>, invalid</td></tr>
<tr>
<td>1</td>
<td><tt>RV_CURRENT</tt>, current version</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>07</tt></td>	<td>c[0xB]</td>
<td><tt>RF_PAD</tt>, padding, filled with zeros</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32</td>
<td><tt>rf_rfsize</tt>, size of header</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32</td>
<td><tt>rf_rcnum</tt>, number of resource collections</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32</td>
<td><tt>rf_rcoff</tt>, offset of resource collection array, from the start of the resource file<br>expected value: <tt><sub>x</sub>1C</tt></td></tr>
</table>
<h3>Resource collection array entry</h2>
<p>A resource collection array entry is a <tt>Res32_Col</tt> structure.<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32</td>
<td><tt>rc_collection</tt>, offset to the resource collection relative to the resource file, must be word aligned</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td><tt>rc_size</tt>, total size of the resource collection in bytes</td></tr>
</table>
<h3>Resource collection</h2>
<p>A resource collection starts with the following header <tt>Res32_Hdr</tt>.<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16</td>
<td><tt>rh_version</tt>, version of resource collection, should be 1</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16</td>
<td><tt>rh_flags</tt>, currently no flags are defined</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td><tt>rh_name</tt>, index into the resource string table</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32</td>
<td><tt>rh_rioff</tt>, offset to resource item array</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32</td>
<td><tt>rh_rientsize</tt>, size of a resource item array entry, should be <tt><sub>x</sub>14</tt></td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32</td>
<td><tt>rh_rinum</tt>, number of resources</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32</td>
<td><tt>rh_rhsize</tt>, header's size in bytes, should be <tt><sub>x</sub>20</tt></td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32</td>
<td><tt>rh_strtab</tt>, offset to resource string table, relative to start of resource collection</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32</td>
<td><tt>rh_locale</tt>, offset to the locale information, relative to the start of the resource collection<br>if present, it should follow the header</td></tr>
</table>
<p>The resource collection locale information, if present, is a <tt>Res32_Locale</tt> structure.<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>c16[2]</td>
<td><tt>rl_country</tt>, two UCS-2 characters</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>c16[2]</td>
<td><tt>rl_language</tt>, two UCS-2 characters</td></tr>
</table>
<p>An array of <tt>Res32_Item</tt> entries follow.<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32</td>
<td><tt>ri_type</tt></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td><tt>ri_ordinal</tt>, each resource has a unique ordinal within its resource type</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32</td>
<td><tt>ri_name</tt>, offset to the resource string table</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32</td>
<td><tt>ri_data</tt>, data offset, relative to the start of the resource collection</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32</td>
<td><tt>ri_size</tt>, size of resource data</td></tr>
</table>
<h2>OS/2 operating system information (<tt>.osinfo</tt>)</h1>
<p>The system information is stored in a structure named <tt>Elf32_Os</tt>.<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32</td>
<td><tt>os_type</tt>
<table border='1'>
<tr>
<td><tt><sub>x</sub>00000000</tt></td>
<td><tt>EOS_NONE</tt></td></tr>
<tr>
<td><tt><sub>x</sub>00000001</tt></td>
<td><tt>EOS_PN</tt>, IBM Microkernel personality neutral</td></tr>
<tr>
<td><tt><sub>x</sub>00000002</tt></td>
<td><tt>EOS_SVR4</tt>, UNIX System V Release 4</td></tr>
<tr>
<td><tt><sub>x</sub>00000003</tt></td>
<td><tt>EOS_AIX</tt>, IBM AIX</td></tr>
<tr>
<td><tt><sub>x</sub>00000004</tt></td>
<td><tt>EOS_OS2</tt>, IBM OS/2, 32-bit environment</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td><tt>os_size</tt>, size of operating system specific information directly following this entry<br>for OS/2 it should be <tt><sub>x</sub>10</tt></td></tr>
</table>
<p>For OS/2, the following entries should be part of the structure <tt>Elf32_OS2Info</tt>.<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i8</td>
<td><tt>os2_sessiontype</tt>
<table border='1'>
<tr>
<td><tt><sub>x</sub>00</tt></td>
<td><tt>OS2_SES_NONE</tt>, only valid for DLLs</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>
<td><tt>OS2_SES_FS</tt>, full screen session</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>
<td><tt>OS2_SES_PM</tt>, presentation manager session</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>
<td><tt>OS2_SES_VIO</tt>, Windows character mode session</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>09</tt></td>	<td>i8</td>
<td><tt>os2_sessionflags</tt>, session flags, none currently defined</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>c[0xE]</td>
<td><tt>os2_reserved</tt>, reserved</td></tr>
</table>
<h2>OS/2 import table (<tt>.imports</tt>)</h1>
<p>Each import table entry has the following structure.<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32</td>
<td><tt>imp_ordinal</tt>, ordinal number of export, or -1 if referenced by name</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td><tt>imp_name</tt>, string table index for name, or 0 if referenced by ordinal</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32</td>
<td><tt>imp_info</tt>
<table border='1'>
<tr>
<td>Bits 0:23</td>
<td><tt>imp_dll</tt>, interpretation depends on the type</td></tr>
<tr>
<td>Bits 24:31</td>
<td><tt>imp_type</tt>
<table border='1'>
<tr>
<td><tt><sub>x</sub>00</tt></td>
<td><tt>IMP_IGNORED</tt>, ignored</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>
<td><tt>IMP_STR_IDX</tt>, value is string table index of name of load module</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>
<td><tt>IMP_DT_IDX</tt>, value is a 1-based reference to a <tt>DT_NEEDED</tt> entry in the dynamic segment</td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32</td>
<td><tt>imp_reserved</tt>, reserved</td></tr>
</table>
<h2>OS/2 export table (<tt>.exports</tt>)</h1>
<p>Each export table entry has the following structure.<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32</td>
<td><tt>exp_ordinal</tt>, ordinal number of export, or -1 if exported by name</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32</td>
<td><tt>exp_symbol</tt>, symbol table index</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32</td>
<td><tt>exp_name</tt>, string table index for name, or 0 if exported by ordinal</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32</td>
<td><tt>exp_reserved</tt>, reserved</td></tr>
</table>
<h2>Segment contents</h1>
<p>A <tt>PT_INTERP</tt> segment will contain an <tt>.interp</tt> section.</p>
<p>A <tt>PT_PHDR</tt> segment will point to the program header section.</p>
<p>A text segment will contain <tt>.text</tt>, <tt>.rodata</tt>, <tt>.hash</tt>, <tt>.dynsym</tt>, <tt>.dynstr</tt>, <tt>.plt</tt>, <tt>.rel.got</tt> sections.</p>
<p>A data segment will contain <tt>.data</tt>, <tt>.dynamic</tt>, <tt>.got</tt>, <tt>.bss</tt> sections.</p>
<p>A <tt>PT_DYNAMIC</tt> segment will point to a <tt>.dynamic</tt> section.</p>
<p>A <tt>PT_OS</tt> segment will contain a <tt>.osinfo</tt> section. It should precede all other segments.<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></p>
<p>A <tt>PT_RES</tt> segment will contain a <tt>.res</tt> section. It should follow all other segments.<a href="#OS2"><sup title="OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08">[3]</sup></a></p>
<h2>Dynamic linking</h1>
<p>TODO</p>
<h2>Further work</h1>
<p>This format requires documentation.</p>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="https://www.sco.com/developers/gabi/latest/contents.html" target='_blank'>System V Application Binary Interface (Draft, 2013-06-10)</a></li>
<li>[2] <a href="https://github.com/bminor/binutils-gdb/blob/master/include/elf/common.h" target='_blank'>common.h - GNU Binutils sources</a></li>
<li>[3] <a href="https://archive.org/details/OS2PowerPCBinaryInterface" target='_blank'>OS/2 Application Binary Interface for PowerPC (32-bit), 1995-12-08</a></li>
</ul>
<hr/>
<h1 id="cpm">flat binary CP/M</h1>
<dl>
<dt>File extensions</td>
<dd><tt>.com</tt>, but <tt>.r</tt> for Human68k</dd>
<dl>
<dt>Magic code</td>
<dd>&mdash;</dd>
<dl>
<dt>Architecture</td>
<dd>usually Intel 8080, Zilog Z80 (CP/M-80), Intel 8086 (MS-DOS) or Motorola 68000 (Human68k), but MOS 6502 (OUP/M, DOS/65), PDP-11 (DX-DOS) are also possible</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>1974: CP/M-80 and compatibles</li>
<li>1981-08-12: MS-DOS 1.0 and compatibles</li>
<li>1983: <a href="https://archive.org/details/OUPMA6502OperatingSystem/mode/2up">OUP/M</a></li>
<li>1987-03-28: Human68k</li>
<li>1989: <a href="http://www.vcfed.org/forum/archive/index.php/t-10780.html">DOS/65</a></li>
<li>1995: DX-DOS</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>usually Intel 8080, Zilog Z80 (CP/M-80), Intel 8086 (MS-DOS) or Motorola 68000 (Human68k), but MOS 6502 (OUP/M, DOS/65), PDP-11 (DX-DOS) are also possible</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#pifed">Program Information</a>
</li><li><a href="#_references">References</a></li>
</ol>
<a id="pifed"/>
<h2>Program Information</h1>
<p>For MS-DOS <tt>.com</tt> files, the <tt>PIFED</tt><a href="#PIFED"><sup title="Concurrent DOS 386 PIFED.EXE">[1]</sup></a> utility from Concurrent DOS 386 embeds a special structure to encode program information data. It immediately follows the last data byte in the file. It can be recognized by its special signature. For the layout, refer to the <a href='pifed'>Program Information section</a> for the MZ format.</p>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] Concurrent DOS 386 PIFED.EXE</li>
</ul>
<hr/>
<h1 id="cmd_flex">FLEX executable (.CMD)</h1>
<dl>
<dt>File extensions</td>
<dd><tt>.cmd</tt></dd>
<dl>
<dt>Magic code</td>
<dd><tt><sub>x</sub>02</tt></dd>
<dl>
<dt>Architecture</td>
<dd>Motorola 6800, Motorola 6809</dd>
<dl>
<dt>Operating systems</td>
<dd>1976: FLEX</dd>
</dl>
<dl>
<dt>Influences</td>
<dd>Motorola 6800, Motorola 6809</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#">Binary record</a>
</li>
<li><a href="#">Transfer address record</a>
</li>
<li><a href="#">Terminating record</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<p>A binary file is composed of several binary records.</p>
<h2>Binary record</h1>
<p>Load a series of bytes into a specified address in memory.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>02</tt></td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i16be</td>
<td>Load address</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>i8</td>
<td>Number of following bytes in record<a href="#FLEXEMU"><sup title="Flexemu emulator">[2]</sup></a> (Note: <a href="#APG"><sup title="FLEX Advanced Programmer's Guide">[1]</sup></a> claims this includes first 4 bytes, disk image does not comply with this)</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>c[*]</td>
<td>Binary data</td></tr>
</table>
<h2>Transfer address record</h1>
<p>Specifies the entry point of a command.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>16</tt><a href="#FLEXEMU"><sup title="Flexemu emulator">[2]</sup></a> (Note: <a href="#APG"><sup title="FLEX Advanced Programmer's Guide">[1]</sup></a> is claims this is an ACK but actually it's a SYN)</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i16be</td>
<td>Transfer address</td></tr>
</table>
<p>Only the last transfer address is used</p>
<h2>Terminating record</h1>
<p>Terminates the list of records.<a href="#FLEXEMU"><sup title="Flexemu emulator">[2]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>00</tt></td></tr>
</table>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="http://www.flexusergroup.com/flexusergroup/pdfs/flexapg.pdf" target='_blank'>FLEX Advanced Programmer's Guide</a></li>
<li>[2] <a href="https://github.com/aladur/flexemu" target='_blank'>Flexemu emulator</a></li>
</ul>
<hr/>
<h1 id="prl">Page relocatable</h1>
<dl>
<dt>File extensions</td>
<dd><ul>
<li><tt>.prl</tt> (Page Relocatable) for programs (replaced by <tt>.cmd</tt> in MP/M-86)</li>
<li><tt>.spr</tt> (System PRL) for system modules (replaced by <tt>.obj</tt> in CP/M-86 Plus, <tt>.mpm</tt> in MP/M-86, <tt>.con</tt> in Concurrent CP/M-86)</li>
<li><tt>.rsp</tt> for resident system processes</li>
<li><tt>.brs</tt> for banked RSP (MP/M 2)</li>
<li><tt>.ovl</tt> for overlays (replaced by <tt>.ovr</tt> in CP/M-86)</li>
<li><tt>.rsx</tt> for resident system extensions</li>
<li><tt>.rsm</tt> for resident system modules (RSXs backported to CP/M 2)</li>
<li><tt>.fid</tt> for Amstrad CP/M field installable device drivers</li>
</ul></dd>
<dl>
<dt>Magic code</td>
<dd><tt><sub>x</sub>00</tt></dd>
<dl>
<dt>Architecture</td>
<dd>Intel 8080 and Zilog Z80</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>1979: MP/M-80</li>
<li>1983: CP/M-80 Plus</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>Intel 8080 and Zilog Z80</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#header">Executable Header</a>
</li>
<li><a href="#relocs">Relocation information</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<table border='1' align='center'>
<tr>
<td><a href="#header">Executable Header</a></td></tr>
<tr>
<td>Program image</td></tr>
<tr>
<td><a href="#relocs">Relocation information</a></td></tr>
</table>
<a id="header"/>
<h2>Executable Header</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i16le</td>
<td>Size of program image in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>i8</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Size of bss, data to clear out</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i8</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>07</tt></td>	<td>i16le</td>
<td>Load address, only used for <tt>.ovl</tt>, 0 for other files.<br><tt>.prl</tt> and <tt>.rsp</tt> files are assembled to be loaded at <tt><sub>x</sub>0100</tt>, <tt>.spr</tt> files at <tt><sub>x</sub>0000</tt>.</td></tr>
<tr>
<td><tt><sub>x</sub>09</tt></td>	<td>i8</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i16le</td>
<td>Base address of code group, only used with LINK-80</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>c[0xF4]</td>
<td>Reserved, must be 0</td></tr>
</table>
<a id="relocs"/>
<h2>Relocation information</h1>
<p>Except for <tt>.ovl</tt> files, a bitmap follows with one bit for each byte in the program image, for a total of (size + 7) / 8 bytes. Each bit specifies whether the corresponding byte in the image encodes the most significant byte of an address, which the system can use to relocate the image to another 256 byte page boundary.</p>
<p>The first byte of the image corresponds to the most significant bit of the first byte of the relocations.</p>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="http://www.seasip.info/Cpm/prl.html" target='_blank'>PRL file format (John Elliot's homepage)</a></li>
</ul>
<hr/>
<h1 id="cpm3">CP/M-80 Plus executable (.COM)</h1>
<dl>
<dt>File extensions</td>
<dd><tt>.com</tt></dd>
<dl>
<dt>Magic code</td>
<dd><tt><sub>x</sub>C9</tt></dd>
<dl>
<dt>Architecture</td>
<dd>Intel 8080 and Zilog Z80</dd>
<dl>
<dt>Operating systems</td>
<dd>1983: CP/M-80 Plus</dd>
</dl>
<dl>
<dt>Influences</td>
<dd>Intel 8080 and Zilog Z80</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#header">Executable Header</a>
<ol>
<li><a href="#rsxrec">RSX record</a>
</ol></li>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<table border='1' align='center'>
<tr>
<td><a href="#header">Executable Header</a></td></tr>
<tr>
<td>Program image</td></tr>
<tr>
<td>RSX 1 image</td></tr>
<tr>
<td>RSX 2 image</td></tr>
<tr>
<td>...</td></tr>
</table>
<a id="header"/>
<h2>Executable Header</h1>
<p>When this header is present, the entire file is loaded at address <tt><sub>x</sub>0100</tt>. After the pre-initialization code is executed, the header is removed and the image is relocated to address <tt><sub>x</sub>0100</tt> from the previous <tt><sub>x</sub>0200</tt>.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>C9</tt>, corresponds to an Intel 8080/Zilog Z80 <tt>RET</tt> instruction that would immediately return to the system</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i16le</td>
<td>Size of program image in bytes, without this header or the RSX images</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>c[10]</td>
<td>Pre-initialization code, executed before relocating the image, must return with <tt>RET</tt>. Intended for SCBs.</td></tr>
<tr>
<td><tt><sub>x</sub>0D</tt></td>	<td>i8</td>
<td>Loader flag: normally if no RSXs are present, the loader does not stay active after loading
<table border='1'>
<tr>
<td>0xFF</td>
<td>No RSXs are attached, but Loader must remain active</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i8</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>0F</tt></td>	<td>i8</td>
<td>Number of RSXs</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>c[0xF0]</td>
<td>Up to 15 RSX records</td></tr>
</table>
<a id="rsxrec"/>
<h3>RSX record</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Offset of RSX image from file base</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Size of RSX initialized data</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i8</td>
<td>Non-banked flag
<table border='1'>
<tr>
<td>0xFF</td>
<td>RSX must only be loaded for non-banked systems</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i8</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>c[8]</td>
<td>Original RSX filename</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>c[2]</td>
<td>Reserved</td></tr>
</table>
<p>The actual RSX image comes without the PRL header, but with relocations present.</p>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="http://www.seasip.info/Cpm/rsxrec.html" target='_blank'>CP/M 3 COM file header (John Elliot's homepage)</a></li>
</ul>
<hr/>
<h1 id="cmd">CP/M-86 executable (.CMD)</h1>
<dl>
<dt>File extensions</td>
<dd><ul>
<li><tt>.cmd</tt> for applications</li>
<li><tt>.sys</tt> for drivers</li>
<li><tt>.mpm</tt> (MP/M-86) or <tt>.con</tt> (Concurrent CP/M-86, Concurrent DOS, Multiuser DOS) for system modules</li>
<li><tt>.rsp</tt> for resident system processes</li>
<li><tt>.ovr</tt> for overlays</li>
<li><tt>.rsx</tt> for resident system extensions</li>
<li><tt>.186</tt> for FlexOS 186 applications</li>
<li><tt>.286</tt> for FlexOS 286 applications</li>
<li><tt>.srl</tt> for FlexOS 286 shared run-time libraries</li>
</ul></dd>
<dl>
<dt>Magic code</td>
<dd>&mdash;</dd>
<dl>
<dt>Architecture</td>
<dd>Intel 8086/80286</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>1981-09-25: MP/M-86 2.0</li>
<li>1981-11: CP/M-86 1.0</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>Intel 8086/80286</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#header">Executable Header</a>
<ol>
<li><a href="#srtlid">SRTL identifier</a>
</li>
</ol></li>
<li><a href="#srtl">Shared run-time library group</a>
</li>
<li><a href="#fastload">FASTLOAD group</a>
</li>
<li><a href="#relocs">Relocation data</a>
</li>
<li><a href="#rsxindex">RSX index</a>
</li>
<li><a href="#">CP/M-86 runtime layout</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<p>The CMD file format has evolved through several versions. The original version only contained the header and group data, with relocations and RSXs added later. Later FlexOS added shared run-time library (SRTL) support, and then a fast load section.</p>
<table border='1' align='center'>
<tr>
<td><a href="#header">Executable Header</a></td></tr>
<tr>
<td><a href="#srtl">Shared run-time library group</a> (FlexOS only)</td></tr>
<tr>
<td><a href="#fastload">FASTLOAD group</a> (FlexOS only)</td></tr>
<tr>
<td>Group 1 image</td></tr>
<tr>
<td>Group 2 image</td></tr>
<tr>
<td>...</td></tr>
<tr>
<td><a href="#relocs">Relocation data</a></td></tr>
<tr>
<td><a href="#rsxindex">RSX index</a> (CP/M Plus and DOSPlus only)</td></tr>
</table>
<a id="header"/>
<h2>Executable Header</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[9 &times; 8]</td>
<td>Up to 8 descriptors
<table border='1'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Group type (only the low 4 bits are actually used<a href="#CPMSG"><sup title="CP/M-86 System Guide">[1]</sup></a>)
<table border='1'>
<tr>
<td>0x00</td>
<td>End of descriptors (not a descriptor)</td></tr>
<tr>
<td>0x01</td>
<td>Code, may be written to (loaded into CS, also DS and ES if no data/extra groups provided)</td></tr>
<tr>
<td>0x02</td>
<td>Data (loaded into DS, also ES if no extra group provided)</td></tr>
<tr>
<td>0x03</td>
<td>Extra (loaded into ES)</td></tr>
<tr>
<td>0x04</td>
<td>Stack (<b>not</b> loaded into SS)</td></tr>
<tr>
<td>0x05</td>
<td>Auxiliary 1 (not FlexOS)</td></tr>
<tr>
<td>0x06</td>
<td>Auxiliary 2 (not FlexOS)</td></tr>
<tr>
<td>0x07</td>
<td>Auxiliary 3 (not FlexOS)</td></tr>
<tr>
<td>0x08</td>
<td>Auxiliary 4 (not FlexOS)<br>Relocations<a href="#FLEXOS"><sup title="FlexOS 286 Supplement">[4]</sup></a> (FlexOS, group is optional)</td></tr>
<tr>
<td>0x09</td>
<td>Pure code, can be shared between processes (loaded into CS)</td></tr>
<tr>
<td>0x0A-0x0E</td>
<td>Reserved</td></tr>
<tr>
<td>0x0F</td>
<td>Escape code for additional types (not FlexOS)</td></tr>
<tr>
<td>0xFE</td>
<td>FASTLOAD group descriptor (must appear at <tt><sub>x</sub>51</tt>)</td></tr>
<tr>
<td>0xFF</td>
<td>Shared run-time library group descriptor (must appear at <tt><sub>x</sub>48</tt>)<a href="#FLEXOS"><sup title="FlexOS 286 Supplement">[4]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i16le</td>
<td>Length of group in 16 byte paragraphs, as stored in file</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>i16le</td>
<td>Base address of group in 16 byte paragraphs, 0 if relocatable (normally non-zero only in executable files)</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i16le</td>
<td>Minimum size in memory in 16 byte paragraphs (corresponds to data and bss)</td></tr>
<tr>
<td><tt><sub>x</sub>07</tt></td>	<td>i16le</td>
<td>Maximum size in memory in 16 byte paragraphs (includes heap)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>48</tt></td>	<td>c[9]</td>
<td>(FlexOS only): <a href="#srtl">Shared run-time library group</a> descriptor (GDSRTL)
<table border='1'>
<tr>
<td>0xFF</td>
<td><a href="#srtl">Shared run-time library group</a> present, program includes shared libraries<a href="#FLEXOS"><sup title="FlexOS 286 Supplement">[4]</sup></a> (the group sizes seem to be filled<a href="#OWN"><sup title="own research">[6]</sup></a>)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>51</tt></td>	<td>c[9]</td>
<td>(FlexOS only): File is in fast load format
<table border='1'>
<tr>
<td>0xFE</td>
<td><a href="#fastload">FASTLOAD group</a><a href="#OWN"><sup title="own research">[6]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>5A</tt></td>	<td>c[6]</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>60</tt></td>	<td>c[0x10]</td>
<td>(FlexOS only): <a href="#srtlid">SRTL identifier</a>, present for shared run-time libraries<a href="#FLEXOS"><sup title="FlexOS 286 Supplement">[4]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>70</tt></td>	<td>c[0x0B]</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>7B</tt></td>	<td>i16le</td>
<td>Offset to <a href="#rsxindex">RSX index</a> in 128 byte records<a href="#JE"><sup title="CP/M-86 executables (.CMD) (John Elliot's homepage)">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>7D</tt></td>	<td>i16le</td>
<td>Offset to <a href="#relocs">Relocation data</a> in 128 byte records</td></tr>
<tr>
<td><tt><sub>x</sub>7F</tt></td>	<td>i8</td>
<td>Bit field
<table border='1'>
<tr>
<td>Bit 3</td>
<td>Must be suspended when running in background, used for applications with direct video access<a href="#CDOSXM"><sup title="Concurrent DOS Programmer's Guide">[2]</sup></a></td></tr>
<tr>
<td>Bit 4</td>
<td>This is an RSX (system extension) file, not a CMD (command) file<a href="#JE"><sup title="CP/M-86 executables (.CMD) (John Elliot's homepage)">[3]</sup></a></td></tr>
<tr>
<td>Bits 5:6</td>
<td>8087 usage
<table border='1'>
<tr>
<td>0</td>
<td>Does not use 8087</td></tr>
<tr>
<td>1</td>
<td>Requires 8087</td></tr>
<tr>
<td>2</td>
<td>Optional 8087 support</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 7</td>
<td>Requires relocation</td></tr>
</table>
</td></tr>
</table>
<a id="srtlid"/>
<h3>SRTL identifier</h2>
<p>This record can be found in the header as well as in the Shared runtime library group.<a href="#FLEXOS"><sup title="FlexOS 286 Supplement">[4]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[8]</td>
<td>SRTL (shared run-time library) name; the full filename has extension '.SRL'</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le</td>
<td>Major version</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i16le</td>
<td>Minor version</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32le</td>
<td>Flags (reserved)</td></tr>
</table>
<a id="srtl"/>
<h2>Shared run-time library group</h1>
<p>This group stores the shared run-time libraries required for execution.<a href="#FLEXOS"><sup title="FlexOS 286 Supplement">[4]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Number of included shared run-time libraries</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>c[*]</td>
<td>Sequence of SRTL (shared run-time libraries) identifiers and relocation count entries</td></tr>
</table>
<p>For non-FASTLOAD files, each entry has the following format:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[8]</td>
<td><a href="#srtlid">SRTL identifier</a></td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i16le</td>
<td>Number of relocations for this library</td></tr>
</table>
<p>For FASTLOAD files, the entries are extended:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[8]</td>
<td><a href="#srtlid">SRTL identifier</a></td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i16le</td>
<td>Number of relocations for this library (0)<a href="#POSTLINK"><sup title="POSTLINK.EXE">[5]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i16le</td>
<td>Index of first selector referencing this library<a href="#POSTLINK"><sup title="POSTLINK.EXE">[5]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i16le</td>
<td>=1 (unknown)<a href="#POSTLINK"><sup title="POSTLINK.EXE">[5]</sup></a></td></tr>
</table>
<a id="fastload"/>
<h2>FASTLOAD group</h1>
<p>The FASTLOAD group is typically <tt><sub>x</sub>650</tt> bytes, it starts with an 8 byte header:<a href="#OWN"><sup title="own research">[6]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Maximum allowed LDT entries<a href="#POSTLINK"><sup title="POSTLINK.EXE">[5]</sup></a>, typically <tt><sub>x</sub>C8</tt> or 2 after the first free index after LDT</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>First free index after LDT<a href="#POSTLINK"><sup title="POSTLINK.EXE">[5]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Index base<a href="#POSTLINK"><sup title="POSTLINK.EXE">[5]</sup></a>, typically <tt><sub>x</sub>0C</tt></td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>First used index<a href="#POSTLINK"><sup title="POSTLINK.EXE">[5]</sup></a>, typically <tt><sub>x</sub>00</tt> or <tt><sub>x</sub>0C</tt></td></tr>
</table>
<p>Then a descriptor table follows, similar to a 286 LDT structure.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Offset to last byte in 286 segment (limit)</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i24le</td>
<td>Base address of first byte in 286 segment</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i8</td>
<td>Segment group type of 286 segment<a href="#POSTLINK"><sup title="POSTLINK.EXE">[5]</sup></a><br>SRTL fixups also reference the code group, with 0 for the limit</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>0</td></tr>
</table>
<a id="relocs"/>
<h2>Relocation data</h1>
<p>The relocation data appears on a 128 byte record boundary, and it is a collection of 4 byte structures.<a href="#JE"><sup title="CP/M-86 executables (.CMD) (John Elliot's homepage)">[3]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>0 if end of relocations, otherwise a bitfield
<table border='1'>
<tr>
<td>Bits 0:3</td>
<td>Destination group type (1 for pure code)</td></tr>
<tr>
<td>Bits 4:7</td>
<td>Source group type (1 for pure code)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i16le</td>
<td>16 byte paragraph offset from source group</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>i8</td>
<td>Byte offset from paragraph within source group</td></tr>
</table>
<p>If there are any shared libraries, they can also have relocations. Each group of shared library relocations is separated by a 4 byte sequence of 0 that terminates the previous list. The format for these relocations is almost identical to those of internal relocations.<a href="#OWN"><sup title="own research">[6]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>0 if end of relocations, otherwise a bitfield
<table border='1'>
<tr>
<td>Bits 0:3</td>
<td>Must be 0</td></tr>
<tr>
<td>Bits 4:7</td>
<td>Source group type (1 for pure code)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i16le</td>
<td>16 byte paragraph offset from source group</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>i8</td>
<td>Byte offset from paragraph within source group</td></tr>
</table>
<a id="rsxindex"/>
<h2>RSX index</h1>
<p>The RSX index may contain up to 7 RSX record entries plus a terminator.<a href="#JE"><sup title="CP/M-86 executables (.CMD) (John Elliot's homepage)">[3]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Offset of RSX in 128 byte records
<table border='1'>
<tr>
<td>0x0000</td>
<td>Must be loaded from disk</td></tr>
<tr>
<td>0xFFFF</td>
<td>End of list (not an entry)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>c[8]</td>
<td>Name of the RSX; for dynamically loaded RSXs, append '.RSX' to the file name</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>c[6]</td>
<td>Reserved</td></tr>
</table>
<h2>CP/M-86 runtime layout</h1>
<p>Documentation<a href="#CPMSG"><sup title="CP/M-86 System Guide">[1]</sup></a> describe 3 modes of operation: 8080 model, small model and compact model. However the real difference is between the 8080 model and the other models. The 8080 model is selected when there is no data group. In CP/M-86, only a single code group is permitted.<a href="#OWN"><sup title="own research">[6]</sup></a> Later versions allow other groups as well.</p>
<p>When starting the program, the first 256 bytes of one of the groups is overwritten by a structure called the zero page. For an 8080 model program, it is the first 256 bytes of the code group, otherwise the data group.</p>
<p>Then the segment registers are initialized: the CS to the start segment of the code group, the DS to the start of the data group if available, otherwise CS, the ES to the start of the extra group if available, otherwise DS. The IP is loaded with <tt><sub>x</sub>0100</tt> for 8080 model programs and <tt><sub>x</sub>0000</tt> otherwise. Notably, the SS:SP registers are not loaded with the stack segment, the rationale being that the actual length of the stack group cannot be known at compile time, and it might exceed 64 KiB. Instead it points to a small memory range allocated by the system.</p>
<table border='1' align='center'>
<tr>
<td>Register</td>
<td>8080 model</td>
<td>Small/compact model</td></tr>
<tr>
<td>CS</td>
<td>code group</td>
<td>code group</td></tr>
<tr>
<td>DS</td>
<td>CS</td>
<td>data group or CS</td></tr>
<tr>
<td>ES</td>
<td>extra group or DS</td>
<td>extra group or DS</td></tr>
<tr>
<td>SS</td>
<td>system stack</td>
<td>system stack</td></tr>
<tr>
<td>SP</td>
<td>system stack</td>
<td>system stack</td></tr>
<tr>
<td>IP</td>
<td><tt><sub>x</sub>0100</tt></td>
<td><tt><sub>x</sub>0000</tt></td></tr>
</table>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="http://www.bitsavers.org/pdf/digitalResearch/cpm-86/CPM-86_System_Guide_Jun83.pdf" target='_blank'>CP/M-86 System Guide</a></li>
<li>[2] <a href="http://bitsavers.org/pdf/digitalResearch/concurrent/Concurrent_DOS_Programmers_Guide_XM_6.0_386_2.0_1987.pdf" target='_blank'>Concurrent DOS Programmer's Guide</a></li>
<li>[3] <a href="http://www.seasip.info/Cpm/cmdfile.html" target='_blank'>CP/M-86 executables (.CMD) (John Elliot's homepage)</a></li>
<li>[4] <a href="http://bitsavers.org/pdf/digitalResearch/flexos/flexos_286/FlexOS_Supplement_for_Intel_iAPX_286-based_Computers_198611.pdf" target='_blank'>FlexOS 286 Supplement</a></li>
<li>[5] POSTLINK.EXE</li>
<li>[6] own research</li>
</ul>
<hr/>
<h1 id="68k">CP/M-68K executable (.68K)</h1>
<dl>
<dt>File extensions</td>
<dd><ul>
<li><tt>.68k</tt> CP/M-68K and Concurrent DOS 68K executables (Concurrent DOS also uses COFF)</li>
<li><tt>.prg</tt> for GEMDOS text applications, TOS graphical applications</li>
<li><tt>.app</tt> for GEMDOS and Atari TOS graphical applications</li>
<li><tt>.acc</tt> for GEMDOS and Atari TOS graphical accessories</li>
<li><tt>.tos</tt> for Atari TOS text applications</li>
<li><tt>.ttp</tt> for Atari TOS text applications that take parameters</li>
<li><tt>.gtp</tt> for Atari TOS graphical applications that take parameters</li>
<li><tt>.slb</tt> for shared libraries for MagiC (Atari TOS extension)</li>
<li><tt>.z</tt> for Human68k</li>
</ul></dd>
<dl>
<dt>Magic code</td>
<dd><ul>
<li><tt><sub>x</sub>60<sub>x</sub>1A</tt> for contiguous executables (all of them)</li>
<li><tt><sub>x</sub>60<sub>x</sub>1B</tt> for non-contiguous executables (CP/M-68K only)</li>
<li><tt><sub>x</sub>60<sub>x</sub>1C</tt> for contiguous executables with crunched relocations (Concurrent DOS 68K only)</li>
</ul></dd>
<dl>
<dt>Architecture</td>
<dd>Motorola 68000</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>1982: CP/M-68K</li>
<li>1985: GEMDOS, GEM, Concurrent DOS 68K</li>
<li>1985-11-20: Atari TOS</li>
<li>1987-03-28: Human68k</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>Motorola 68000</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#header">Header</a>
<ol>
<li><a href="#cpm68kheader">CP/M-68K and Concurrent DOS 68K header for contiguous executables</a>
</li>
<li><a href="#cpm68knoncontheader">CP/M-68K non-contiguous executables</a>
</li>
<li><a href="#gemdosheader">Header for early versions of GEMDOS</a>
</li>
<li><a href="#tosheader">Atari TOS header</a>
</li>
<li><a href="#human68kheader">Human68k .Z header</a>
</li>
</ol></li>
<li><a href="#symtab">Symbol Table</a>
</li>
<li><a href="#relocs">Relocation Table</a>
<ol>
<li><a href="#cpm68krelocs">CP/M-68K relocations</a>
</li>
<li><a href="#crunchedrelocs">Crunched relocations</a>
</li>
<li><a href="#gemdosrelocs">GEMDOS/Atari TOS relocations</a>
</li>
<li><a href="#human68krelocs">Human68k relocations</a>
</ol></li>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<p>Multiple systems support multiple versions of the file format. Executables can be contiguous or non-contiguous (the latter only supported on CP/M-68K). The header fields have some variations between the various operating systems. The format of the relocations between CP/M-68K, GEMDOS/Atari TOS, and crunched relocations. The symbol table has a standardized format for CP/M-68K, but other linkers can use different formats.</p>
<table border='1' align='center'>
<tr>
<td><a href="#header">Header</a></td></tr>
<tr>
<td>Text segment image</td></tr>
<tr>
<td>Data segment image</td></tr>
<tr>
<td><a href="#symtab">Symbol Table</a></td></tr>
<tr>
<td><a href="#relocs">Relocation Table</a></td></tr>
</table>
<a id="header"/>
<h2>Header</h1>
<p>There are multiple versions of the header. They are very similar, but for ease of navigation, we will separate them according to versions. The following is the general layout:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td>Magic number
<table border='1'>
<tr>
<td>0x601A</td>
<td>Contiguous executable</td></tr>
<tr>
<td>0x601B</td>
<td>Non-contiguous executable<a href="#CPM68K"><sup title="CP/M-68K Programmer's Guide">[1]</sup></a></td></tr>
<tr>
<td>0x601C</td>
<td>Contiguous executable with crunched relocations<a href="#CDOS68K"><sup title="LOAD68K.H from Concurrent DOS 68K disks">[2]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i32be</td>
<td>Size of text segment</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i32be</td>
<td>Size of data segment</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i32be</td>
<td>Size of bss segment</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i32be</td>
<td>Size of symbol table</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i32be</td>
<td>Size of stack<a href="#CDOS68K"><sup title="LOAD68K.H from Concurrent DOS 68K disks">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>16</tt></td>	<td>i32be</td>
<td>Address of text segment<a href="#CPM68K"><sup title="CP/M-68K Programmer's Guide">[1]</sup></a> or program flags<a href="#TOSHYP1"><sup title="The documentation for TOS: The program file format">[6]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>1A</tt></td>	<td>i16be</td>
<td>Relocations suppressed</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32be</td>
<td>Address of data segment<a href="#CPM68K"><sup title="CP/M-68K Programmer's Guide">[1]</sup></a> (optional)</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32be</td>
<td>Address of bss segment<a href="#CPM68K"><sup title="CP/M-68K Programmer's Guide">[1]</sup></a> (optional)</td></tr>
</table>
<a id="cpm68kheader"/>
<h3>CP/M-68K and Concurrent DOS 68K header for contiguous executables</h2>
<p>Format used by CP/M-68K<a href="#CPM68K"><sup title="CP/M-68K Programmer's Guide">[1]</sup></a> and Concurrent DOS 68K<a href="#CDOS68K"><sup title="LOAD68K.H from Concurrent DOS 68K disks">[2]</sup></a> for contiguous executables:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td>Magic number
<table border='1'>
<tr>
<td>0x601A</td>
<td>Contiguous executable</td></tr>
<tr>
<td>0x601C</td>
<td>Contiguous executable with crunched relocations (Concurrent DOS 68K only)<a href="#CDOS68K"><sup title="LOAD68K.H from Concurrent DOS 68K disks">[2]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i32be</td>
<td>Size of text segment</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i32be</td>
<td>Size of data segment</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i32be</td>
<td>Size of bss segment (image not included in file)</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i32be</td>
<td>Size of symbol table</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i32be</td>
<td>CP/M-68K: Reserved, must be 0<br>Concurrent 68K: Size of stack<a href="#CDOS68K"><sup title="LOAD68K.H from Concurrent DOS 68K disks">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>16</tt></td>	<td>i32be</td>
<td>Address of text segment, start of execution</td></tr>
<tr>
<td><tt><sub>x</sub>1A</tt></td>	<td>i16be</td>
<td>
<table border='1'>
<tr>
<td>0x0000</td>
<td>Relocations exist</td></tr>
<tr>
<td>non-0</td>
<td>No relocations present</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>c[*]</td>
<td>Start of image</td></tr>
</table>
<a id="cpm68knoncontheader"/>
<h3>CP/M-68K non-contiguous executables</h2>
<p>Format used by CP/M-68K<a href="#CPM68K"><sup title="CP/M-68K Programmer's Guide">[1]</sup></a> for non-contiguous executables:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td><tt><sub>x</sub>601B</tt> (Magic number for Non-contiguous executable)</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i32be</td>
<td>Size of text segment</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i32be</td>
<td>Size of data segment</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i32be</td>
<td>Size of bss segment (image not included in file)</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i32be</td>
<td>Size of symbol table</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i32be</td>
<td>Reserved, must be 0</td></tr>
<tr>
<td><tt><sub>x</sub>16</tt></td>	<td>i32be</td>
<td>Address of text segment, start of execution</td></tr>
<tr>
<td><tt><sub>x</sub>1A</tt></td>	<td>i16be</td>
<td>
<table border='1'>
<tr>
<td>0x0000</td>
<td>Relocations exist</td></tr>
<tr>
<td>non-0</td>
<td>No relocations present</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32be</td>
<td>Address of data segment</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32be</td>
<td>Address of bss segment</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>c[*]</td>
<td>Start of image</td></tr>
</table>
<a id="gemdosheader"/>
<h3>Header for early versions of GEMDOS</h2>
<p>Format used by early versions of GEMDOS<a href="#GEMDOS"><sup title="Atari GEMDOS Reference Manual (1986-04-04)">[4]</sup></a>:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td><tt><sub>x</sub>601A</tt> (Magic number for Contiguous executable)</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i32be</td>
<td>Size of text segment</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i32be</td>
<td>Size of data segment</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i32be</td>
<td>Size of bss segment (image not included in file)</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i32be</td>
<td>Size of symbol table</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i32be</td>
<td>Reserved, must be 0</td></tr>
<tr>
<td><tt><sub>x</sub>16</tt></td>	<td>i32be</td>
<td>Reserved, must be 0</td></tr>
<tr>
<td><tt><sub>x</sub>1A</tt></td>	<td>i32be</td>
<td>Reserved, must be 0</td></tr>
<tr>
<td><tt><sub>x</sub>1E</tt></td>	<td>c[*]</td>
<td>Start of image</td></tr>
</table>
<a id="tosheader"/>
<h3>Atari TOS header</h2>
<p>Format used by Atari TOS:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td><tt><sub>x</sub>601A</tt> (Magic number for Contiguous executable)</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i32be</td>
<td>Size of text segment</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i32be</td>
<td>Size of data segment</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i32be</td>
<td>Size of bss segment (image not included in file)</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i32be</td>
<td>Size of symbol table</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i32be</td>
<td>Reserved, must be 0</td></tr>
<tr>
<td><tt><sub>x</sub>16</tt></td>	<td>i32be</td>
<td>Program flags
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Only clear bss, not heap</td></tr>
<tr>
<td>Bit 1</td>
<td>May load program into alternative RAM</td></tr>
<tr>
<td>Bit 2</td>
<td>May use alternative RAM for Malloc calls</td></tr>
<tr>
<td>Bit 3</td>
<td>Only requires basepage, text, data, bss segments and symbol tables, used for shared libraries<a href="#TOSHYP2"><sup title="The documentation for TOS: Shared libraries">[7]</sup></a></td></tr>
<tr>
<td>Bit 4-5</td>
<td>
<table border='1'>
<tr>
<td>0</td>
<td>All memory is private</td></tr>
<tr>
<td>1</td>
<td>All memory is public</td></tr>
<tr>
<td>2</td>
<td>Supervisor mode can access memory</td></tr>
<tr>
<td>3</td>
<td>All memory is read only</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 6-11</td>
<td>Reserved, must be 0</td></tr>
<tr>
<td>Bit 12</td>
<td>Text segment is shared, no absolute address refers to DATA and BSS (unsure if bit 11 or bit 12)</td></tr>
<tr>
<td>Bit 13-27</td>
<td>Reserved, must be 0</td></tr>
<tr>
<td>Bit 28-31</td>
<td>Maximum amount of memory to allocate in alternate RAM, in 128KiB</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>1A</tt></td>	<td>i16be</td>
<td>
<table border='1'>
<tr>
<td>0x0000</td>
<td>Relocations exist</td></tr>
<tr>
<td>non-0</td>
<td>No relocations present</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>c[*]</td>
<td>Start of image</td></tr>
</table>
<a id="human68kheader"/>
<h3>Human68k .Z header</h2>
<p>Format used by Human68k for .Z executables:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td><tt><sub>x</sub>601A</tt> (Magic number for Contiguous executable)</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i32be</td>
<td>Size of text segment</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i32be</td>
<td>Size of data segment</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i32be</td>
<td>Size of bss segment, including common and stack (image not included in file)</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i32be</td>
<td>Reserved, must be 0</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i32be</td>
<td>Reserved, must be 0</td></tr>
<tr>
<td><tt><sub>x</sub>16</tt></td>	<td>i32be</td>
<td>Load address, start of execution</td></tr>
<tr>
<td><tt><sub>x</sub>1A</tt></td>	<td>i16be</td>
<td><tt><sub>x</sub>FFFF</tt> (Magic number)</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>c[*]</td>
<td>Start of image</td></tr>
</table>
<a id="symtab"/>
<h2>Symbol Table</h1>
<p>CP/M-68K has the following format for each symbol.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[8]</td>
<td>Symbol name, null padded</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16be</td>
<td>Type
<table border='1'>
<tr>
<td>0x0100</td>
<td>Bss based relocatable</td></tr>
<tr>
<td>0x0200</td>
<td>Text based relocatable</td></tr>
<tr>
<td>0x0400</td>
<td>Data based relocatable</td></tr>
<tr>
<td>0x0800</td>
<td>External reference</td></tr>
<tr>
<td>0x1000</td>
<td>Equated register</td></tr>
<tr>
<td>0x2000</td>
<td>Global</td></tr>
<tr>
<td>0x4000</td>
<td>Equated</td></tr>
<tr>
<td>0x8000</td>
<td>Defined</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i32be</td>
<td>Value</td></tr>
</table>
<a id="relocs"/>
<h2>Relocation Table</h1>
<a id="cpm68krelocs"/>
<h3>CP/M-68K relocations</h2>
<p>For CP/M-68K relocations are stored as a sequence of 16-bit words, one for each 16-bit word in the text and data sections. The least significant 3 bits of the word determine if the word requires a relocation.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td>Relocation information
<table border='1'>
<tr>
<td>Bit 0-3</td>
<td>Relocation type
<table border='1'>
<tr>
<td>0</td>
<td>Absolute reference, no relocation required</td></tr>
<tr>
<td>1</td>
<td>Reference relative to the base address of the data segment</td></tr>
<tr>
<td>2</td>
<td>Reference relative to the base address of the text segment</td></tr>
<tr>
<td>3</td>
<td>Reference relative to the base address of the bss segment</td></tr>
<tr>
<td>4</td>
<td>Undefined symbol, bits 4-15 index the symbol table</td></tr>
<tr>
<td>5</td>
<td>The upper word of a 32-bit longword.<br>The following word contains the relocation type, and the longword to be relocated is at the address of the first word</td></tr>
<tr>
<td>6</td>
<td>PC-relative reference</td></tr>
<tr>
<td>7</td>
<td>Instruction word, no relocation required</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 4-15</td>
<td>References a symbol in the symbol table (optional)</td></tr>
</table>
</td></tr>
</table>
<a id="crunchedrelocs"/>
<h3>Crunched relocations</h2>
<p>Concurrent DOS 68K also recognizes CP/M-68K relocations. It also supports crunched relocations. The type of relocations is determined by the magic word, if it is <tt><sub>x</sub>601C</tt>, it uses crunched relocations, otherwise CP/M-68K relocations. Relocations are represented as a sequence of offsets between 16-bit words and 32-bit longwords that need to be relocated. Each byte has the following format.<a href="#CRUNCH"><sup title="CRUNCH.C source from Concurrent DOS 68K disks">[3]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>
<table border='1'>
<tr>
<td>Bit 0-6</td>
<td>
<table border='1'>
<tr>
<td>00</td>
<td>End of relocations</td></tr>
<tr>
<td>01-7C</td>
<td>Advance with the quantity, relocate next quantity</td></tr>
<tr>
<td>7D</td>
<td>Read next u8, advance as much, relocate next quantity</td></tr>
<tr>
<td>7E</td>
<td>Read next u16be, advance as much, relocate next quantity</td></tr>
<tr>
<td>7F</td>
<td>Read next u32be, advance as much, relocate next quantity</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 7</td>
<td>Set for 16-bit relocations, cleared for 32-bit relocations</td></tr>
</table>
</td></tr>
</table>
<a id="gemdosrelocs"/>
<h3>GEMDOS/Atari TOS relocations</h2>
<p>GEMDOS relocations are represented as a sequence of offsets between the 32-bit longwords that need to be relocated. The first offset is stored directly in the code.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32be</td>
<td>The first offset to relocate, or 0 if there are none</td></tr>
</table>
<p>Every other offset is stored as a command to a pointer that gets moved and updates 32-bit longwords as it advances.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>
<table border='1'>
<tr>
<td>00</td>
<td>End of list</td></tr>
<tr>
<td>01</td>
<td>Advance 254 bytes, do not relocate</td></tr>
<tr>
<td>02-FE (even)</td>
<td>advance N bytes, relocate the next 32-bit longword</td></tr>
<tr>
<td>03-FF (odd)</td>
<td>undefined</td></tr>
</table>
</td></tr>
</table>
<a id="human68krelocs"/>
<h3>Human68k relocations</h2>
<p>Human68k .Z files do not contain relocations.</p>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="http://www.cpm.z80.de/randyfiles/DRI/CPM-86_Programmers_Guide.pdf" target='_blank'>CP/M-68K Programmer's Guide</a></li>
<li>[2] <a href="http://www.cpm.z80.de/download/cdos3.zip" target='_blank'>LOAD68K.H from Concurrent DOS 68K disks</a></li>
<li>[3] <a href="http://www.cpm.z80.de/download/cdos3.zip" target='_blank'>CRUNCH.C source from Concurrent DOS 68K disks</a></li>
<li>[4] <a href="http://www.bitsavers.org/pdf/atari/ST/Atari_ST_GEM_Programming_1986/GEM_0042.pdf" target='_blank'>Atari GEMDOS Reference Manual (1986-04-04)</a></li>
<li>[5] <a href="http://cd.textfiles.com/ataricompendium/BOOK/HTML/CHAP2.HTM" target='_blank'>GEMDOS Overview</a></li>
<li>[6] <a href="http://toshyp.atari.org/en/005005.html" target='_blank'>The documentation for TOS: The program file format</a></li>
<li>[7] <a href="http://toshyp.atari.org/en/00b017.html#PH_BIT3.TTP" target='_blank'>The documentation for TOS: Shared libraries</a></li>
<li>[8] <a href="https://datacrystal.romhacking.net/wiki/X68k:PM" target='_blank'>Sharp X68000 Programmer's Manual</a></li>
</ul>
<hr/>
<h1 id="z8k">CP/M-8000 executable (.Z8K)</h1>
<dl>
<dt>File extensions</td>
<dd><tt>.z8k</tt></dd>
<dl>
<dt>Magic code</td>
<dd><tt><sub>x</sub>EE<sub>x</sub>00</tt>, <tt><sub>x</sub>EE<sub>x</sub>01</tt>, <tt><sub>x</sub>EE<sub>x</sub>02</tt>, <tt><sub>x</sub>EE<sub>x</sub>03</tt>, <tt><sub>x</sub>EE<sub>x</sub>06</tt>, <tt><sub>x</sub>EE<sub>x</sub>07</tt>, <tt><sub>x</sub>EE<sub>x</sub>0A</tt>, <tt><sub>x</sub>EE<sub>x</sub>0B</tt></dd>
<dl>
<dt>Architecture</td>
<dd>Zilog Z8000</dd>
<dl>
<dt>Operating systems</td>
<dd>1982: CP/M-8000</dd>
</dl>
<dl>
<dt>Influences</td>
<dd>Zilog Z8000</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#header">Executable Header</a>
</li>
<li><a href="#seginf">Segment Information Array</a>
</li>
<li><a href="#relocs">Relocation Data</a>
</li>
<li><a href="#symtab">Symbol Table</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<table border='1' align='center'>
<tr>
<td><a href="#header">Executable Header</a></td></tr>
<tr>
<td><a href="#seginf">Segment Information Array</a></td></tr>
<tr>
<td>Segment 1 image</td></tr>
<tr>
<td>Segment 2 image</td></tr>
<tr>
<td>...</td></tr>
<tr>
<td><a href="#relocs">Relocation Data</a></td></tr>
<tr>
<td><a href="#symtab">Symbol Table</a></td></tr>
</table>
<a id="header"/>
<h2>Executable Header</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td>Magic number, denotes file type
<table border='1'>
<tr>
<td>0xEE00</td>
<td>Segmented, nonexecutable</td></tr>
<tr>
<td>0xEE01</td>
<td>Segmented, executable</td></tr>
<tr>
<td>0xEE02</td>
<td>Nonsegmented, nonexecutable</td></tr>
<tr>
<td>0xEE03</td>
<td>Nonsegmented, executable, nonshared Instruction & Data space</td></tr>
<tr>
<td>0xEE06</td>
<td>Nonsegmented, nonexecutable, shared Instruction & Data space</td></tr>
<tr>
<td>0xEE07</td>
<td>Nonsegmented, executable, shared Instruction & Data space (apparently CP/M-8000 cannot execute these<a href="#OWN"><sup title="own research">[2]</sup></a>)</td></tr>
<tr>
<td>0xEE0A</td>
<td>Nonsegmented, nonexecutable, split Instruction & Data space</td></tr>
<tr>
<td>0xEE0B</td>
<td>Nonsegmented, executable, split Instruction & Data space</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16be</td>
<td>Number of entries in <a href="#seginf">Segment Information Array</a></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td>Combined size of all segment data in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32be</td>
<td>Size of <a href="#relocs">Relocation Data</a> in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32be</td>
<td>Size of <a href="#symtab">Symbol Table</a> in bytes</td></tr>
</table>
<a id="seginf"/>
<h2>Segment Information Array</h1>
<p>This table contains one entry for each segment.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Segment's assigned number<br>For segmented executables, this is the segment number that will be used<a href="#OWN"><sup title="own research">[2]</sup></a><br><tt><sub>x</sub>FF</tt> lets the linker choose a value</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i8</td>
<td>Segment type
<table border='1'>
<tr>
<td>01</td>
<td>Bss (no data in file)</td></tr>
<tr>
<td>02</td>
<td>Stack (no data in file)</td></tr>
<tr>
<td>03</td>
<td>Code</td></tr>
<tr>
<td>04</td>
<td>Constant data (rodata)</td></tr>
<tr>
<td>05</td>
<td>Data</td></tr>
<tr>
<td>06</td>
<td>Mixed code/data, not protectable (might write data in it)</td></tr>
<tr>
<td>07</td>
<td>Mixed code/data, protectable (may be put in ROM)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16be</td>
<td>Length of segment</td></tr>
</table>
<p>Note: <a href="#CPM8KPG"><sup title="CP/M-8000 Programmer's Guide">[1]</sup></a> (likely erroneously) claims that there is another byte following this record indicating the number of segment entries in the table.<a href="#OWN"><sup title="own research">[2]</sup></a></p>
<a id="relocs"/>
<h2>Relocation Data</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Segment number</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i8</td>
<td>Relocation type
<table border='1'>
<tr>
<td>0x01</td>
<td>OFF: A 16-bit offset value to segment</td></tr>
<tr>
<td>0x02</td>
<td>SSG: A 16-bit short form segment:offset value to segment</td></tr>
<tr>
<td>0x03</td>
<td>LSG: A 32-bit long form segment:offset value to segment</td></tr>
<tr>
<td>0x05</td>
<td>XOFF: A 16-bit offset value to external item</td></tr>
<tr>
<td>0x06</td>
<td>XSSG: A 16-bit short form segment:offset value to external item</td></tr>
<tr>
<td>0x07</td>
<td>XLSG: A 32-bit long form segment:offset value to external item</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16be</td>
<td>Location within segment</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16be</td>
<td>Index into symbol table or segment number</td></tr>
</table>
<a id="symtab"/>
<h2>Symbol Table</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Segment number</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i8</td>
<td>Symbol type
<table border='1'>
<tr>
<td>0x01</td>
<td>Local (for debugging)</td></tr>
<tr>
<td>0x02</td>
<td>Undefined, external</td></tr>
<tr>
<td>0x03</td>
<td>Global definition</td></tr>
<tr>
<td>0x04</td>
<td>Segment name</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16be</td>
<td>Value</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>c[8]</td>
<td>Name, null padded</td></tr>
</table>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="http://www.cpm.z80.de/randyfiles/DRI/CPM8000_programmersGuide.pdf" target='_blank'>CP/M-8000 Programmer's Guide</a></li>
<li>[2] own research</li>
</ul>
<hr/>
<h1 id="hu">Human68k executable (HU)</h1>
<dl>
<dt>File extensions</td>
<dd><tt>.x</tt></dd>
<dl>
<dt>Magic code</td>
<dd><tt>"HU"</tt></dd>
<dl>
<dt>Architecture</td>
<dd>Motorola 68000</dd>
<dl>
<dt>Operating systems</td>
<dd>1987-03-28: Human68K, SX-Window</dd>
</dl>
<dl>
<dt>Influences</td>
<dd>Motorola 68000</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#header">Executable Header</a>
</li>
<li><a href="#reltbl">Relocation Table</a>
</li>
<li><a href="#symtab">Symbol Table</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<table border='1' align='center'>
<tr>
<td><a href="#header">Executable Header</a></td></tr>
<tr>
<td>Text segment</td></tr>
<tr>
<td>Data segment</td></tr>
<tr>
<td><a href="#reltbl">Relocation Table</a></td></tr>
<tr>
<td><a href="#symtab">Symbol Table</a></td></tr>
</table>
<a id="header"/>
<h2>Executable Header</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[2]</td>
<td>"HU"</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i8</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>i8</td>
<td>Load mode<a href="#X68KPM"><sup title="Sharp X68000 Programmer's Manual">[1]</sup></a>
<table border='1'>
<tr>
<td>0</td>
<td>Normal</td></tr>
<tr>
<td>1</td>
<td>Smallest block</td></tr>
<tr>
<td>2</td>
<td>High address</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td>Base address<a href="#X68KPM"><sup title="Sharp X68000 Programmer's Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32be</td>
<td>Initial PC (entry)<a href="#X68KPM"><sup title="Sharp X68000 Programmer's Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32be</td>
<td>Size of text segment</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32be</td>
<td>Size of data segment</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32be</td>
<td>Size of bss segment</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32be</td>
<td>Size of relocation table</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32be</td>
<td>Size of symbol table</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32be</td>
<td>Size of SCD (debug<a href="#LYDUX"><sup title="Binutils for Human68k from Lydux">[3]</sup></a>) line number table in bytes<a href="#X68KPM"><sup title="Sharp X68000 Programmer's Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i32be</td>
<td>Size of SCD (debug<a href="#LYDUX"><sup title="Binutils for Human68k from Lydux">[3]</sup></a>) symbol table in bytes<a href="#X68KPM"><sup title="Sharp X68000 Programmer's Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i32be</td>
<td>Size of SCD (debug<a href="#LYDUX"><sup title="Binutils for Human68k from Lydux">[3]</sup></a>) string table in bytes<a href="#X68KPM"><sup title="Sharp X68000 Programmer's Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>2C</tt></td>	<td>c[0x10]</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>3C</tt></td>	<td>i32be</td>
<td>Position of bound module list from beginning of file<a href="#X68KPM"><sup title="Sharp X68000 Programmer's Manual">[1]</sup></a></td></tr>
</table>
<a id="reltbl"/>
<h2>Relocation Table</h1>
<p>Relocations are represented as a sequence of offsets between 16-bit words and 32-bit longwords that need to be relocated. Each 16-bit word has the following format.<a href="#X68KPM"><sup title="Sharp X68000 Programmer's Manual">[1]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td>Relocation type
<table border='1'>
<tr>
<td>0x0001</td>
<td>Read next i32be, then
<table border='1'>
<tr>
<td>Even</td>
<td>Move to position, relocate i32be</td></tr>
<tr>
<td>Odd</td>
<td>Move to position - 1, relocate i16be</td></tr>
</table>
</td></tr>
<tr>
<td>Even</td>
<td>Advance by amount of bytes, relocate i32be</td></tr>
<tr>
<td>Odd</td>
<td>Advance by amount-1 of bytes, relocate i16be</td></tr>
</table>
</td></tr>
</table>
<a id="symtab"/>
<h2>Symbol Table</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Location
<table border='1'>
<tr>
<td>0x00</td>
<td>External<a href="#LYDUX"><sup title="Binutils for Human68k from Lydux">[3]</sup></a></td></tr>
<tr>
<td>0x02</td>
<td>Local<a href="#LYDUX"><sup title="Binutils for Human68k from Lydux">[3]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i8</td>
<td>Section
<table border='1'>
<tr>
<td>0x00</td>
<td>Absolute<a href="#CA"><sup title="68000 Assembly programming for the Sharp x68000">[2]</sup></a></td></tr>
<tr>
<td>0x01</td>
<td>Text</td></tr>
<tr>
<td>0x02</td>
<td>Data</td></tr>
<tr>
<td>0x03</td>
<td>Bss or common<a href="#CA"><sup title="68000 Assembly programming for the Sharp x68000">[2]</sup></a> (if external)</td></tr>
<tr>
<td>0x04</td>
<td>Stack</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i32be</td>
<td>Value</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>c[*]</td>
<td>Name (zero terminated)<a href="#CA"><sup title="68000 Assembly programming for the Sharp x68000">[2]</sup></a></td></tr>
</table>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="https://datacrystal.romhacking.net/wiki/X68k:PM" target='_blank'>Sharp X68000 Programmer's Manual</a></li>
<li>[2] <a href="https://www.chibiakumas.com/68000/x68000.php" target='_blank'>68000 Assembly programming for the Sharp x68000</a></li>
<li>[3] <a href="https://github.com/Lydux/binutils-2.22-human68k/blob/master/bfd/xfile.c" target='_blank'>Binutils for Human68k from Lydux</a></li>
</ul>
<hr/>
<h1 id="mz">MZ executable (named after Mark Zbikowski)</h1>
<dl>
<dt>File extensions</td>
<dd><ul>
<li><tt>.exe</tt>, sometimes <tt>.com</tt> for console applications</li>
<li><tt>.ovl</tt> for overlays</li>
<li><tt>.app</tt> for GEM graphics applications</li>
<li><tt>.acc</tt> for GEM graphics accessories</li>
<li><tt>.exm</tt> for HP 100LX/200LX System Manager modules</li>
</ul></dd>
<dl>
<dt>Magic code</td>
<dd><ul>
<li><tt>"MZ"</tt> (reportedly also <tt>"ZM"</tt> in early versions)</li>
<li><tt>"DL"</tt> for HP 100LX/200LX System Manager modules</li>
</ul></dd>
<dl>
<dt>Architecture</td>
<dd>Intel 8086</dd>
<dl>
<dt>Operating systems</td>
<dd>1981-08-12:  MS-DOS 1.0 and compatibles</dd>
</dl>
<dl>
<dt>Influences</td>
<dd>Intel 8086</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#exehdr">EXE Header</a>
</li>
<li><a href="#reltbl">Relocation Table</a>
</li>
<li><a href="#pifed">Program Information</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<table border='1' align='center'>
<tr>
<td><a href="#exehdr">EXE Header</a> including <a href="#reltbl">Relocation Table</a> and <a href="#pifed">Program Information</a></td></tr>
<tr>
<td>Program image</td></tr>
</table>
<a id="exehdr"/>
<h2>EXE Header</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[2]</td>
<td>"MZ" (for <a href='https://en.wikipedia.org/wiki/Mark_Zbikowski'>Mark Zbikowksi</a>, a lead developer of MS-DOS)<br>alternatively "ZM"<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><br>"DL"<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><a href="#NKIT"><sup title="MAKEEXM.C from NKIT Version 0.63 source; from The Largest 200LX Software Archive">[3]</sup></a> for System Manager module</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Number of bytes in the last 512 byte pages in file, 0 if entire page is used</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Size of entire file in 512 byte pages; if value at <tt><sub>x</sub>02</tt> is non-zero, only that much of the last page is used</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>Number of relocations</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le</td>
<td>Offset to load image from start of file; size of header in 16 byte paragraphs (including the <a href="#reltbl">Relocation Table</a>)</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i16le</td>
<td>Minimum supplementary 16 byte paragraphs allocated after program image. Corresponds to bss+stack.<br>If both this and the next field are zero, the program is loaded in the highest possible memory</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i16le</td>
<td>Maximum supplementary 16 byte paragraphs allocated after program image. This will be used as the heap</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i16le</td>
<td>Initial SS value (segment of stack), relative to start of program image</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i16le</td>
<td>Initial SP value (top of stack)</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i16le</td>
<td>Checksum, the sum of all 16-bit words in the file should be zero. Alternatively, it is the negation of the modular sum of all 16-bit words except this one</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i16le</td>
<td>Initial IP value (segment of entry)</td></tr>
<tr>
<td><tt><sub>x</sub>16</tt></td>	<td>i16le</td>
<td>Initial CS value (entry point), relative to start of program image</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i16le</td>
<td>Offset of <a href="#reltbl">Relocation Table</a> from file start in bytes. Relocation table is typically part of the header.<br>Some extensions of the file format expect this to be at least <tt><sub>x</sub>40</tt></td></tr>
<tr>
<td><tt><sub>x</sub>1A</tt></td>	<td>i16le</td>
<td>Overlay number, 0 for main program<br>for "DL" executables, starting paragraph of data relative to program image<a href="#NKIT"><sup title="MAKEEXM.C from NKIT Version 0.63 source; from The Largest 200LX Software Archive">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>c[*]</td>
<td>Other proprietary fields</td></tr>
</table>
<a id="reltbl"/>
<h2>Relocation Table</h1>
<p>A sequence of address of 16-bit words that have to be incremented by the physical first paragraph of the loaded program image. Note that the offset, paragraph pair of an address is not unique.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Offset of word to relocate</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Paragraph of word to relocate</td></tr>
</table>
<a id="pifed"/>
<h2>Program Information</h1>
<p>The <tt>PIFED</tt><a href="#PIFED"><sup title="Concurrent DOS 386 PIFED.EXE">[5]</sup></a> utility from Concurrent DOS 386 embeds a special structure to encode program information data. It either immediately follows the last relocation in the file, or if there are no relocations (the relocation offset is 0), it starts at offset <tt><sub>x</sub>1E</tt>.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[4]</td>
<td>Signature, always <tt><sub>x</sub>C1</tt> <tt><sub>x</sub>ED</tt> <tt><sub>x</sub>13</tt> <tt><sub>x</sub>00</tt></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Maximum number of extra paragraphs (PIFED asks in KiBs, default: 1023KiB<a href="#PIFED"><sup title="Concurrent DOS 386 PIFED.EXE">[5]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>Minimum number of extra paragraphs (PIFED asks in KiBs, default: 65KiB<a href="#PIFED"><sup title="Concurrent DOS 386 PIFED.EXE">[5]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i8</td>
<td>Flags
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Requires 8087 coprocessor</td></tr>
<tr>
<td>Bit 1</td>
<td>May run in banked memory</td></tr>
<tr>
<td>Bit 2</td>
<td>Runs only in the foreground</td></tr>
<tr>
<td>Bit 4</td>
<td>Waits in idle loop</td></tr>
<tr>
<td>Bit 5</td>
<td>Requires aligned memory</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>09</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>00</tt></td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i8</td>
<td>Lowest used interrupt (default: <tt><sub>x</sub>08</tt><a href="#PIFED"><sup title="Concurrent DOS 386 PIFED.EXE">[5]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>0B</tt></td>	<td>i8</td>
<td>Highest used interrupt (default: <tt><sub>x</sub>2F</tt><a href="#PIFED"><sup title="Concurrent DOS 386 PIFED.EXE">[5]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i8</td>
<td>COM port usage
<table border='1'>
<tr>
<td>Bit 4</td>
<td>Direct access to COM1</td></tr>
<tr>
<td>Bit 5</td>
<td>Direct access to COM1</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0D</tt></td>	<td>i8</td>
<td>LPT port usage
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Direct access to LPT1</td></tr>
<tr>
<td>Bit 1</td>
<td>Direct access to LPT2</td></tr>
<tr>
<td>Bit 2</td>
<td>Direct access to LPT3</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i8</td>
<td>Screen usage
<table border='1'>
<tr>
<td>Bit 1</td>
<td>
<table border='1'>
<tr>
<td>0</td>
<td>Uses 24 lines</td></tr>
<tr>
<td>1</td>
<td>Uses 25 lines</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 2</td>
<td>Uses ANSI escape sequences</td></tr>
<tr>
<td>Bit 3</td>
<td>Uses ROS calls</td></tr>
<tr>
<td>Bit 4</td>
<td>Direct video access</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0F</tt></td>	<td>c[4]</td>
<td>Signature, always <tt><sub>x</sub>13</tt> <tt><sub>x</sub>00</tt> <tt><sub>x</sub>C1</tt> <tt><sub>x</sub>ED</tt></td></tr>
</table>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="https://www.pcjs.org/documents/books/mspl13/msdos/dosref40/" target='_blank'>Microsoft MS-DOS Version 4.0 Programmer's Reference</a></li>
<li>[2] <a href="http://www.ctyme.com/intr/rb-2939.htm" target='_blank'>Ralf Brown's interrupt list (Int 21/AH=4Bh)</a></li>
<li>[3] <a href="https://casio.ledudu.com/HPLX/super5.html" target='_blank'>MAKEEXM.C from NKIT Version 0.63 source; from The Largest 200LX Software Archive</a></li>
<li>[4] <a href="http://www.delorie.com/djgpp/doc/exe/" target='_blank'>EXE Format (DJ Delorie's homepage)</a></li>
<li>[5] Concurrent DOS 386 PIFED.EXE</li>
</ul>
<hr/>
<h1 id="ne">New executable (NE)</h1>
<dl>
<dt>File extensions</td>
<dd><tt>.exe</tt>, <tt>.dll</tt> for OS/2 libraries</dd>
<dl>
<dt>Magic code</td>
<dd><tt>"NE"</tt> (<tt>"DX"</tt> for DOS/16M DOS extender)</dd>
<dl>
<dt>Architecture</td>
<dd>Intel 8086/80286</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>1985-11-20: Windows 1.0</li>
<li>1986: Multitasking MS-DOS 4.0</li>
<li>1987-12: OS/2 1.0</li>
<li>?: Rational Systems DOS/16M DOS extender</li>
<li>?: Phar Lap 286|DOS-Extender</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>Intel 8086/80286</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#segexefmt">Segmented EXE Format</a>
</li>
<li><a href="#segexehdr">Segmented EXE Header</a>
</li>
<li><a href="#segtab">Segment Table</a>
</li>
<li><a href="#restab">Resource Table</a>
<ol>
<li><a href="#">Windows resource table</a>
</li>
<li><a href="#">OS/2 resource table</a>
</li>
</ol></li>
<li><a href="#rntab">Resident Name Table</a>
</li>
<li><a href="#modreftab">Module Reference Table</a>
</li>
<li><a href="#impntab">Imported Name Table</a>
</li>
<li><a href="#enttab">Entry Table</a>
<ol>
<li><a href="#norment">Normal entries</a>
</li>
<li><a href="#const">Constant</a>
</li>
<li><a href="#movent">Moveable entries</a>
</li>
</ol></li>
<li><a href="#nrntab">Non-Resident Name Table</a>
</li>
<li><a href="#reloc">Relocations</a>
<ol>
<li><a href="#">Internal reference to a fixed segment</a>
</li>
<li><a href="#">Internal reference to a movable segment</a>
</li>
<li><a href="#">Import by ordinal</a>
</li>
<li><a href="#">Import by name</a>
</li>
<li><a href="#">OSFIXUP</a>
</ol></li>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<table border='1' align='center'>
<tr>
<td>Old-style <a href="#segexefmt">Segmented EXE Format</a> stub</td></tr>
<tr>
<td><a href="#segexehdr">Segmented EXE Header</a></td></tr>
<tr>
<td><a href="#segtab">Segment Table</a></td></tr>
<tr>
<td><a href="#restab">Resource Table</a></td></tr>
<tr>
<td><a href="#rntab">Resident Name Table</a></td></tr>
<tr>
<td><a href="#modreftab">Module Reference Table</a></td></tr>
<tr>
<td><a href="#impntab">Imported Name Table</a></td></tr>
<tr>
<td><a href="#enttab">Entry Table</a></td></tr>
<tr>
<td><a href="#nrntab">Non-Resident Name Table</a></td></tr>
<tr>
<td>Segment data and <a href="#reloc">Relocations</a></td></tr>
</table>
<a id="segexefmt"/>
<h2>Segmented EXE Format</h1>
<p>After Windows 1.0 Development Release 5 (where a <tt>.mod</tt> file until Development Release 4, or <tt>.exe</tt> file in Development Release 5 starts immediately with an earlier version of the <a href="#segexehdr">Segmented EXE Header</a><a href="#BETA"><sup title="https://betawiki.net/wiki/Windows_1.0_Development_Release_5">[6]</sup></a>), a new executable file starts with an MZ stub program, with the following additional or modified field.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i16le</td>
<td>Must be <tt><sub>x</sub>40</tt><a href="#WIN3.0"><sup title="Windows 3.0 16-bit NE Executable Format">[1]</sup></a> or greater <a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>3C</tt></td>	<td>i32le</td>
<td>Offset to <a href="#segexehdr">Segmented EXE Header</a> from file start in bytes</td></tr>
</table>
<a id="segexehdr"/>
<h2>Segmented EXE Header</h1>
<p>The segmented EXE header<a href="#WIN3.0"><sup title="Windows 3.0 16-bit NE Executable Format">[1]</sup></a> or information block <a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[2]</td>
<td><tt>'NE'</tt><br>DOS/16M can patch this to <tt>'DX'</tt> to distinguish it from Windows applications</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i8</td>
<td>Linker version number</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>i8</td>
<td>Linker revision number</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Offset of <a href="#enttab">Entry Table</a> from <a href="#segexehdr">Segmented EXE Header</a> start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>Size of <a href="#enttab">Entry Table</a> in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32le</td>
<td>32-bit CRC of entire file<a href="#WIN3.0"><sup title="Windows 3.0 16-bit NE Executable Format">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i16le</td>
<td>Flag word
<table border='1'>
<tr>
<td>Bits 0:1</td>
<td>Executable file format
<table border='1'>
<tr>
<td>0</td>
<td>NOAUTODATA, no automatic data segment</td></tr>
<tr>
<td>1</td>
<td>SINGLEDATA, one<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a> shared<a href="#WIN3.0"><sup title="Windows 3.0 16-bit NE Executable Format">[1]</sup></a> automatic data segment. Set for DLLs</td></tr>
<tr>
<td>2</td>
<td>MULTIPLEDATA, multiple<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a> or instanced<a href="#WIN3.0"><sup title="Windows 3.0 16-bit NE Executable Format">[1]</sup></a> automatic data segments. Set for Windows applications</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 2</td>
<td>For DLLs, per-process initialization<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><br>(<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a> claims global initialization)</td></tr>
<tr>
<td>Bit 3</td>
<td>Protected mode only<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td>Bit 4</td>
<td>(Windows) Uses LIM EMS directly<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><br>(<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a> claims 8086 instructions)</td></tr>
<tr>
<td>Bit 5</td>
<td>(OS/2) Requires 80286<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><br>(Windows) Each instance has separate EMS bank<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td>Bit 6</td>
<td>(OS/2) Requires 80386<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><br>(Windows) For DLLs, global memory above EMS line<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td>Bit 7</td>
<td>Needs 80x87<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td>Bits 8:9</td>
<td>Presentation Manager compatibility (OS/2 GUI)<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a>
<table border='1'>
<tr>
<td>1</td>
<td>Incompatible<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a>, fullscreen<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td>2</td>
<td>Compatible</td></tr>
<tr>
<td>3</td>
<td>Requires Presentation Manager</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 11</td>
<td>(Windows) First segment contains code that loads application<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a><br>(OS/2) Family Application, runs in DOS as well<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td>Bit 13</td>
<td>Errors detected during linking, module will not load</td></tr>
<tr>
<td>Bit 14</td>
<td>(Windows) For DLLs, set if private DLL and only one program can access it<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><br>Non-conforming program, valid stack is not maintained<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td>Bit 15</td>
<td>Library module. SS:SP is invalid<a href="#WIN3.0"><sup title="Windows 3.0 16-bit NE Executable Format">[1]</sup></a>. CS:IP points to initialization procedure, called with AX set to the module handle, return far with nonzero AX on success. DS is set to the automatic data segment for SINGLEDATA, to caller data otherwise</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i16le</td>
<td>Automatic segment number, starting at 1. Set to 0 for NOAUTODATA</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i16le</td>
<td>Size of initial heap in bytes, added to the automatic data segment following initial stack</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i16le</td>
<td>Size of initial stack in bytes, added to the automatic data segment</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i16le</td>
<td>Initial IP (entry)</td></tr>
<tr>
<td><tt><sub>x</sub>16</tt></td>	<td>i16le</td>
<td>Segment of initial CS (entry), starting at 1</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i16le</td>
<td>Initial SP (stack)</td></tr>
<tr>
<td><tt><sub>x</sub>1A</tt></td>	<td>i16le</td>
<td>Segment of initial SS (stack), starting at 1. If SS is the automatic data segment and SP is 0, SP is set to top of the automatic segment below the initial heap</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i16le</td>
<td>Number of entries in <a href="#segtab">Segment Table</a></td></tr>
<tr>
<td><tt><sub>x</sub>1E</tt></td>	<td>i16le</td>
<td>Number of entries in <a href="#modreftab">Module Reference Table</a></td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i16le</td>
<td>Size of <a href="#nrntab">Non-Resident Name Table</a> in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>22</tt></td>	<td>i16le</td>
<td>Offset of <a href="#segtab">Segment Table</a> from <a href="#segexehdr">Segmented EXE Header</a> start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i16le</td>
<td>Offset of <a href="#restab">Resource Table</a> from <a href="#segexehdr">Segmented EXE Header</a> start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>26</tt></td>	<td>i16le</td>
<td>Offset of <a href="#rntab">Resident Name Table</a> from <a href="#segexehdr">Segmented EXE Header</a> start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i16le</td>
<td>Offset of <a href="#modreftab">Module Reference Table</a> from <a href="#segexehdr">Segmented EXE Header</a> start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>2A</tt></td>	<td>i16le</td>
<td>Offset of <a href="#impntab">Imported Name Table</a> from <a href="#segexehdr">Segmented EXE Header</a> start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>2C</tt></td>	<td>i32le</td>
<td>Offset of <a href="#nrntab">Non-Resident Name Table</a> from file start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>30</tt></td>	<td>i16le</td>
<td>Number of movable entries in <a href="#enttab">Entry Table</a></td></tr>
<tr>
<td><tt><sub>x</sub>32</tt></td>	<td>i16le</td>
<td>Logical sector alignment shift count</td></tr>
<tr>
<td><tt><sub>x</sub>34</tt></td>	<td>i16le</td>
<td>Number of resource segments, and entries in <a href="#restab">Resource Table</a><a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a><br>Under OS/2, the last segments correspond to resources<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>36</tt></td>	<td>i8</td>
<td>Executable type
<table border='1'>
<tr>
<td>00</td>
<td>unknown<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a></td></tr>
<tr>
<td>01</td>
<td>OS/2<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td>02</td>
<td>Windows</td></tr>
<tr>
<td>03</td>
<td>Multitasking (a.k.a. "European") MS-DOS 4.0<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td>04</td>
<td>Windows 386<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td>05</td>
<td>BOSS (Borland Operating System Services)<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td>81</td>
<td>Phar Lap 286|DOS-Extender, OS/2<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td>81</td>
<td>Phar Lap 286|DOS-Extender, Windows<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>37</tt></td>	<td>i8</td>
<td>Additional information<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a>
<table border='1'>
<tr>
<td>Bit 0</td>
<td>(OS/2) Supports long filenames<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td>Bit 1</td>
<td>Windows 2.x application running in Windows 3.x protected mode<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><br>(<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a> claims this is bit 2)</td></tr>
<tr>
<td>Bit 2</td>
<td>Windows 2.x application supporting proportional fonts<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><br>(<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a> claims this is bit 1)</td></tr>
<tr>
<td>Bit 3</td>
<td>(Windows) Contains fast-load (gangload) area</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>38</tt></td>	<td>i16le</td>
<td>(Windows) Offset of fast-load area (gangload area<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a>) in sectors<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>3A</tt></td>	<td>i16le</td>
<td>(Windows) Size of fast-load area (gangload area<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a>) in sectors<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>3C</tt></td>	<td>i16le</td>
<td>Minimum code swap area<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>3E</tt></td>	<td>i16le</td>
<td>(Windows) Expected Windows version number<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a></td></tr>
</table>
<a id="segtab"/>
<h2>Segment Table</h1>
<p>Each entry has the following format</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Offset to segment data and following segment information from file start in sectors. Zero if no data appears in file</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Size of segment data stored in file in bytes. Zero for 65536 bytes</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Flag word
<table border='1'>
<tr>
<td>Bit 0</td>
<td>
<table border='1'>
<tr>
<td>0</td>
<td>Code segment</td></tr>
<tr>
<td>1</td>
<td>Data segment</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 1</td>
<td>
<table border='1'>
<tr>
<td>1</td>
<td>Loader has allocated memory for segment<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td>Bit 2</td>
<td>
<table border='1'>
<tr>
<td>1</td>
<td>Segment is loaded<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a><br>Real mode segment<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td>Bit 3</td>
<td>
<table border='1'>
<tr>
<td>1</td>
<td>Iterated data<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td>Bit 4</td>
<td>
<table border='1'>
<tr>
<td>0</td>
<td>FIXED<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a></td></tr>
<tr>
<td>1</td>
<td>MOVABLE</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 5</td>
<td>
<table border='1'>
<tr>
<td>0</td>
<td>IMPURE or NONSHAREABLE<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a></td></tr>
<tr>
<td>1</td>
<td>PURE or SHAREABLE<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td>Bit 6</td>
<td>
<table border='1'>
<tr>
<td>0</td>
<td>LOADONCALL<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a></td></tr>
<tr>
<td>1</td>
<td>PRELOAD</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 7</td>
<td>
<table border='1'>
<tr>
<td>1</td>
<td>Code segment: EXECUTEONLY<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><br>Data segment: READONLY<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td>Bit 8</td>
<td>
<table border='1'>
<tr>
<td>1</td>
<td>Relocation information is present, follows segment data</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 9</td>
<td>
<table border='1'>
<tr>
<td>1</td>
<td>Debugging information is present (former meaning)<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><br>Conforming code segment<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td>Bits 10:11</td>
<td>Descriptor privilege level (DPL)<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td>Bit 12</td>
<td>Discardable segment<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td>Bits 12:15</td>
<td>Discard priority<a href="#WIN3.0"><sup title="Windows 3.0 16-bit NE Executable Format">[1]</sup></a></td></tr>
<tr>
<td>Bits 13:15</td>
<td>Discard priority<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td>Bit 13</td>
<td>32-bit segment<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td>Bit 14</td>
<td>Part of huge segment<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td>Bit 15</td>
<td><tt>RESRC_HIGH</tt><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>Minimum allocated size of segment in bytes. Zero means 65536 bytes</td></tr>
</table>
<a id="restab"/>
<h2>Resource Table</h1>
<h3>Windows resource table</h2>
<p>The resource table consists of an alignment shift count field, an array of types and a sequence of resource names.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Alignment shift count, for encoding the offsets to resources</td></tr>
</table>
<p>A list of types follow. There must be a single entry for each type.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Type ID<br>A value of 0 terminates the resource table<br>If the high order bit is clear, it is an offset to a type string, relative to the beginning of the resource table<br>Otherwise, it is a resource type value:<a href="#FFENC"><sup title="File Format Encyclopedia: Windows Resource (.RES) Files">[7]</sup></a>
<table border='1'>
<tr>
<td>01</td>
<td><tt>RT_CURSOR</tt> &mdash; cursor</td></tr>
<tr>
<td>02</td>
<td><tt>RT_BITMAP</tt> &mdash; bitmap</td></tr>
<tr>
<td>03</td>
<td><tt>RT_ICON</tt> &mdash; icon</td></tr>
<tr>
<td>04</td>
<td><tt>RT_MENU</tt> &mdash; menu</td></tr>
<tr>
<td>05</td>
<td><tt>RT_DIALOG</tt> &mdash; dialog box</td></tr>
<tr>
<td>06</td>
<td><tt>RT_STRING</tt> &mdash; string table</td></tr>
<tr>
<td>07</td>
<td><tt>RT_FONTDIR</tt> &mdash; font directory</td></tr>
<tr>
<td>08</td>
<td><tt>RT_FONT</tt> &mdash; font component</td></tr>
<tr>
<td>09</td>
<td><tt>RT_ACCELERATOR</tt> &mdash; keyboard accelerator table</td></tr>
<tr>
<td>0A</td>
<td><tt>RT_RCDATA</tt> &mdash; resource data</td></tr>
<tr>
<td>0C</td>
<td><tt>RT_GROUP_CURSOR</tt> &mdash; cursor directory</td></tr>
<tr>
<td>0E</td>
<td><tt>RT_GROUP_ICON</tt> &mdash; icon directory</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Number of resources for this type</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>...</td>
<td>Table of resources for this type</td></tr>
</table>
<p>Each resource has one entry for it:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Offset to resource data from file start, must be shifted by alignment shift count to get offset</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Length of resource, shifted by alignment shift count<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a> (<a href="#WIN3.0"><sup title="Windows 3.0 16-bit NE Executable Format">[1]</sup></a> and <a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a> claim it is in bytes)</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Flags, similar to segment flags
<table border='1'>
<tr>
<td>Bit 4</td>
<td>MOVEABLE</td></tr>
<tr>
<td>Bit 5</td>
<td>PURE, can be shared</td></tr>
<tr>
<td>Bit 6</td>
<td>PRELOAD</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>Resource ID<br>If the high order bit is clear, it is an offset to a resource string, relative to the beginning of the resource table<br>Otherwise, it is an integer</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le</td>
<td>Handle, reserved</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i16le</td>
<td>Usage, reserved</td></tr>
</table>
<p>These structures are followed by a resource name table that contains the names of entries exported by name, with the entry number included.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Length of the string or 0 to terminate the table</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>c[*]</td>
<td>ASCII text of the string name, not terminated with null</td></tr>
</table>
<h3>OS/2 resource table</h2>
<p>Contains a series of resources, identified by their type and name IDs. Each entry corresponds to a segment, and the last segments (out of the total list of segments) are the resources.<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Type ID</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Name ID</td></tr>
</table>
<a id="rntab"/>
<h2>Resident Name Table</h1>
<p>The table contains the names of entries exported by name, with the entry number included.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Length of the string or 0 to terminate the table</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>c[*]</td>
<td>ASCII text of the string name, not terminated with null</td></tr>
<tr>
<td><tt>...</tt></td>	<td>i16le</td>
<td>Ordinal number</td></tr>
</table>
<a id="modreftab"/>
<h2>Module Reference Table</h1>
<p>The table contains a list of module references, each of which is identified by the module name within the <a href="#impntab">Imported Name Table</a>.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Offset to module name in <a href="#impntab">Imported Name Table</a></td></tr>
</table>
<a id="impntab"/>
<h2>Imported Name Table</h1>
<p>A list of names of imported modules and procedures. Names are identified via their offsets within the table.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Length of the string</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>c[*]</td>
<td>ASCII text of the string name, not terminated with null</td></tr>
</table>
<a id="enttab"/>
<h2>Entry Table</h1>
<p>Contains a sequence of entry bundles</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Number of entries in bundle. A zero value terminates the table</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i8</td>
<td>Segment indicator for bundle
<table border='1'>
<tr>
<td>00</td>
<td>Unused entries, skip entry numbers</td></tr>
<tr>
<td>*</td>
<td><a href="#norment">Normal entries</a></td></tr>
<tr>
<td>FE</td>
<td><a href="#const">Constant</a> defined in module<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a></td></tr>
<tr>
<td>FF</td>
<td><a href="#movent">Moveable entries</a></td></tr>
</table>
</td></tr>
</table>
<a id="norment"/>
<h3>Normal entries</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Flag word
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Set for exported entry</td></tr>
<tr>
<td>Bit 1</td>
<td>Set if entry uses a global/shared data segment, only valid for SINGLEDATA library modules. First instruction must be <tt>MOV AX, segment_number</tt></td></tr>
<tr>
<td>Bits 3:7</td>
<td>On ring transition, specifies number of words to be copied on call<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i16le</td>
<td>Offset to entry point within segment</td></tr>
</table>
<a id="const"/>
<h3>Constant</h2>
<p>Undocumented</p>
<a id="movent"/>
<h3>Moveable entries</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Flag word
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Set for exported entry</td></tr>
<tr>
<td>Bit 1</td>
<td>Set if entry uses a global/shared data segment, only valid for SINGLEDATA library modules</td></tr>
<tr>
<td>Bits 3:7</td>
<td>On ring transition, specifies number of words to be copied on call<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>c[2]</td>
<td>An <tt>INT <tt><sub>x</sub>3F</tt></tt> instruction, <tt><tt><sub>x</sub>CD</tt> <tt><sub>x</sub>3F</tt></tt></td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>i8</td>
<td>Segment number</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Offset to entry point within segment</td></tr>
</table>
<a id="nrntab"/>
<h2>Non-Resident Name Table</h1>
<p>The table contains the names of entries exported by ordinal, with the internal entry name included. The table has an identical format to the <a href="#rntab">Resident Name Table</a>.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Length of the string or 0 to terminate the table</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>c[*]</td>
<td>ASCII text of the string name, not terminated with null</td></tr>
<tr>
<td><tt>...</tt></td>	<td>i16le</td>
<td>Ordinal number</td></tr>
</table>
<a id="reloc"/>
<h2>Relocations</h1>
<p>Every segment data may optionally have a sequence of relocations followed, if specified in the <a href="#segtab">Segment Table</a>.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Number of relocations</td></tr>
</table>
<p>Afterwards, relocations have the following format each.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Source type
<table border='1'>
<tr>
<td>Bits 0:3</td>
<td>
<table border='1'>
<tr>
<td>00</td>
<td>low 8-bit</td></tr>
<tr>
<td>02</td>
<td>16-bit selector/segment</td></tr>
<tr>
<td>03</td>
<td>16:16-bit far pointer (32-bit)</td></tr>
<tr>
<td>05</td>
<td>16-bit offset within a segment</td></tr>
<tr>
<td>0B</td>
<td>16:32-bit far pointer (48-bit)<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a></td></tr>
<tr>
<td>0D</td>
<td>32-bit offset within a segment<a href="#WIN3.1"><sup title="Windows 3.1 16-bit NE Executable Format">[2]</sup></a></td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i8</td>
<td>Flags byte
<table border='1'>
<tr>
<td>Bits 0:2</td>
<td>Relocation type
<table border='1'>
<tr>
<td>00</td>
<td>internal reference</td></tr>
<tr>
<td>01</td>
<td>imported by ordinal</td></tr>
<tr>
<td>02</td>
<td>imported by name</td></tr>
<tr>
<td>03</td>
<td>OSFIXUP</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 3</td>
<td>ADDITIVE flag
<table border='1'>
<tr>
<td>0</td>
<td>The source offset references the first word in a chain terminated by <tt><sub>x</sub>FFFF</tt>. The word is replaced by the address, and the old value references the second word in the chain, which is then also replaced</td></tr>
<tr>
<td>1</td>
<td>The source offset references a word and the target value is added to it</td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Offset within this segment to source</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>c[4]</td>
<td>Relocation data</td></tr>
</table>
<p>The interpretation of the relocation data depends on the relocation type.</p>
<h3>Internal reference to a fixed segment</h2>
<p>References an address within the same module.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i8</td>
<td>Segment number in <a href="#segtab">Segment Table</a>, not equal to <tt><sub>x</sub>FF</tt></td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>00</tt></td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>Offset into the fixed segment</td></tr>
</table>
<h3>Internal reference to a movable segment</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>FF</tt></td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>00</tt></td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>Ordinal index into <a href="#enttab">Entry Table</a></td></tr>
</table>
<h3>Import by ordinal</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Index into <a href="#modreftab">Module Reference Table</a> to module</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>Ordinal number for procedure</td></tr>
</table>
<h3>Import by name</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Index into <a href="#modreftab">Module Reference Table</a> to module</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>Offset within <a href="#impntab">Imported Name Table</a> to procedure name</td></tr>
</table>
<h3>OSFIXUP</h2>
<p>Represents a floating point instruction that Windows will "fix up" when the coprocessor is emulated.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Fixup type
<table border='1'>
<tr>
<td>0x0001</td>
<td><tt>FIARQQ, FJARQQ</tt> &mdash; <tt>wait; DS: esc</tt> turns into <tt>int <tt><sub>x</sub>3C</tt>; byte <tt><sub>x</sub>18</tt>-<tt><sub>x</sub>1F</tt></tt> by adding <tt><sub>x</sub>FE32</tt> and <tt><sub>x</sub>4000</tt></td></tr>
<tr>
<td>0x0002</td>
<td><tt>FISRQQ, FJSRQQ</tt> &mdash; <tt>wait; SS: esc</tt> turns into <tt>int <tt><sub>x</sub>3C</tt>; byte <tt><sub>x</sub>58</tt>-<tt><sub>x</sub>5F</tt></tt> by adding <tt><sub>x</sub>0632</tt> and <tt><sub>x</sub>8000</tt></td></tr>
<tr>
<td>0x0003</td>
<td><tt>FICRQQ, FJCRQQ</tt> &mdash; <tt>wait; CS: esc</tt> turns into <tt>int <tt><sub>x</sub>3C</tt>; byte <tt><sub>x</sub>98</tt>-<tt><sub>x</sub>9F</tt></tt> by adding <tt><sub>x</sub>0E32</tt> and <tt><sub>x</sub>C000</tt></td></tr>
<tr>
<td>0x0004</td>
<td><tt>FIERQQ</tt> &mdash; <tt>wait; ES: esc</tt> turns into <tt>int <tt><sub>x</sub>3C</tt></tt> by adding <tt><sub>x</sub>1632</tt></td></tr>
<tr>
<td>0x0005</td>
<td><tt>FIDRQQ</tt> &mdash; <tt>wait; esc</tt> turns into <tt>int <tt><sub>x</sub>34</tt>-<tt><sub>x</sub>3B</tt></tt> by adding <tt><sub>x</sub>5C32</tt></td></tr>
<tr>
<td>0x0006</td>
<td><tt>FIWRQQ</tt> &mdash; <tt>nop; wait</tt> turns into <tt>int <tt><sub>x</sub>3D</tt></tt> by adding <tt><sub>x</sub>A23D</tt></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>0</td></tr>
</table>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="http://bytepointer.com/resources/win16_ne_exe_format_win3.0.htm" target='_blank'>Windows 3.0 16-bit NE Executable Format</a></li>
<li>[2] <a href="http://bytepointer.com/resources/win16_ne_exe_format_win3.1.htm" target='_blank'>Windows 3.1 16-bit NE Executable Format</a></li>
<li>[3] <a href="https://github.com/open-watcom/open-watcom-v2" target='_blank'>OpenWatcom sources</a></li>
<li>[4] <a href="http://www.delorie.com/djgpp/doc/rbinter/ix/" target='_blank'>Ralf Brown's interrupt list</a></li>
<li>[5] <a href="http://qbcm.hybd.net/issues/4-1/" target='_blank'>QB CULT MAGAZINE - Vol. 4 Iss. 1 - January 2004</a></li>
<li>[6] <a href="https://betawiki.net/wiki/Windows_1.0_Development_Release_5" target='_blank'>https://betawiki.net/wiki/Windows_1.0_Development_Release_5</a></li>
<li>[7] <a href="https://ffenc.blogspot.com/2008/04/windows-resource-res-files.html" target='_blank'>File Format Encyclopedia: Windows Resource (.RES) Files</a></li>
</ul>
<hr/>
<h1 id="le">Linear executable (LE, LX)</h1>
<dl>
<dt>File extensions</td>
<dd><tt>.exe</tt>, <tt>.dll</tt> for libraries, <tt>.386</tt> for Windows/386, <tt>.vxd</tt> for Windows 95 and later</dd>
<dl>
<dt>Magic code</td>
<dd><tt>"LE"</tt> or <tt>"LX"</tt> for OS/2</dd>
<dl>
<dt>Architecture</td>
<dd>various, mostly Intel 80386</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>probably 1987-09: Windows/386 drivers (LE)</li>
<li>1990-05-22: Windows 3.0 and Windows 95 drivers (LE)</li>
<li>1991-07: Rational Systems DOS/4G DOS extender (LE)</li>
<li>1991-10: OS/2 2.0 Limited Availability (LX)</li>
<li>?: EMX DOS extender (LX)</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>various, mostly Intel 80386</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#oldhdr">Old-style EXE header and executable</a>
</li>
<li><a href="#modhdr">Linear Executable Module Header</a>
</li>
<li><a href="#ldrsect">Loader Section</a>
<ol>
<li><a href="#objtbl">Object Table</a>
</li>
<li><a href="#objpgtbl">Object Page Table</a>
</li>
<li><a href="#objitpgtbl">Object Iterated Page Table</a>
</li>
<li><a href="#restbl">Resource Table</a>
</li>
<li><a href="#rntbl">Resident Name Table</a>
</li>
<li><a href="#enttbl">Entry Table</a>
<ol>
<li><a href="#unent">Unused entry</a>
</li>
<li><a href="#16ent">16-bit entry</a>
</li>
<li><a href="#286ent">286 call gate entry</a>
</li>
<li><a href="#32ent">32-bit entry</a>
</li>
<li><a href="#forwent">Forwarder entry</a>
</li>
</ol></li>
<li><a href="#modfmtdirtbl">Module Format Directives Table (optional)</a>
</li>
<li><a href="#resdirdattbl">Resident Directives Data Table (optional)</a>
</li>
<li><a href="#perpgcks">Per-Page Checksum</a>
</li>
</ol></li>
<li><a href="#fixsect">Fixup Section (resident)</a>
<ol>
<li><a href="#fixpgtbl">Fixup Page Table</a>
</li>
<li><a href="#fixrectbl">Fixup Record Table</a>
<ol>
<li><a href="#intref">Internal reference</a>
</li>
<li><a href="#impordref">Imported reference by ordinal</a>
</li>
<li><a href="#impnamref">Imported reference by name</a>
</li>
<li><a href="#entref">Internal reference via entry table</a>
</li>
<li><a href="#chain">Internal chaining fixups</a>
</li>
</ol></li>
<li><a href="#impmodtbl">Import Module Name Table</a>
</li>
<li><a href="#impproctbl">Import Procedure Name Table</a>
</li>
</ol></li>
<li><a href="#datasect">Data Section</a>
<ol>
<li><a href="#itdatpg">Iterated data pages</a>
</li>
<li><a href="#nrntbl">Non-Resident Name Table</a>
</li>
<li><a href="#nrdirdat">Non-Resident Directives Data</a>
</li>
</ol></li>
<li><a href="#debugsect">Debug Section</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<table border='1' align='center'>
<tr>
<td><a href="#oldhdr">Old-style EXE header and executable</a></td></tr>
<tr>
<td><a href="#modhdr">Linear Executable Module Header</a></td></tr>
<tr>
<td><a href="#ldrsect">Loader Section</a></td></tr>
<tr>
<td><a href="#fixsect">Fixup Section (resident)</a></td></tr>
<tr>
<td><a href="#datasect">Data Section</a></td></tr>
<tr>
<td><a href="#debugsect">Debug Section</a></td></tr>
</table>
<a id="oldhdr"/>
<h2>Old-style EXE header and executable</h1>
<p>A linear executable file starts with an MZ stub program, with the following additional or modified field.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i16le</td>
<td>Should be <tt><sub>x</sub>0040</tt></td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i16le</td>
<td>OEM Identifier</td></tr>
<tr>
<td><tt><sub>x</sub>26</tt></td>	<td>i16le</td>
<td>OEM Info</td></tr>
<tr>
<td><tt><sub>x</sub>3C</tt></td>	<td>i32le</td>
<td>Offset to <a href="#modhdr">Linear Executable Module Header</a> from file start in bytes</td></tr>
</table>
<a id="modhdr"/>
<h2>Linear Executable Module Header</h1>
<p>Starts at the offset indicated in the <a href="#oldhdr">Old-style EXE header and executable</a>. The general layout is as follows.</p>
<table border='1' align='center'>
<tr>
<td>Executable Info</td></tr>
<tr>
<td>Module Info</td></tr>
<tr>
<td>Loader Section Info</td></tr>
<tr>
<td>Table Offset Info</td></tr>
</table>
<p>The following table lists the actual fields.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[2]</td>
<td>Magic number
<table border='1'>
<tr>
<td><tt>'LE'</tt></td>
<td>original version<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><a href="#VXD"><sup title="LINEAR-EXECUTABLE (LE) File Header Layout">[5]</sup></a></td></tr>
<tr>
<td><tt>'LX'</tt></td>
<td>OS/2 2.0 optimizations</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>u8</td>
<td>Byte ordering
<table border='1'>
<tr>
<td>0x00</td>
<td>little endian (8086, PDP-11)</td></tr>
<tr>
<td>0x01</td>
<td>big endian (68000)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>u8</td>
<td>Word ordering
<table border='1'>
<tr>
<td>0x00</td>
<td>little endian (8086)</td></tr>
<tr>
<td>0x01</td>
<td>big endian (68000, PDP-11)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>Format level, version of executable, current version is 0</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le</td>
<td>CPU Type
<table border='1'>
<tr>
<td>0x01</td>
<td>Intel 80286 or upward compatible</td></tr>
<tr>
<td>0x02</td>
<td>Intel 80386 or upward compatible</td></tr>
<tr>
<td>0x03</td>
<td>Intel 80486 or upward compatible</td></tr>
<tr>
<td>0x04</td>
<td>Intel Pentium (80586) or upward compatible<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><a href="#VXD"><sup title="LINEAR-EXECUTABLE (LE) File Header Layout">[5]</sup></a></td></tr>
<tr>
<td>0x20</td>
<td>Intel i860 (N10) or compatible<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><a href="#VXD"><sup title="LINEAR-EXECUTABLE (LE) File Header Layout">[5]</sup></a></td></tr>
<tr>
<td>0x21</td>
<td>Intel "N11" or compatible<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><a href="#VXD"><sup title="LINEAR-EXECUTABLE (LE) File Header Layout">[5]</sup></a></td></tr>
<tr>
<td>0x40</td>
<td>MIPS I (R2000, R3000) or compatible<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><a href="#VXD"><sup title="LINEAR-EXECUTABLE (LE) File Header Layout">[5]</sup></a></td></tr>
<tr>
<td>0x41</td>
<td>MIPS II (R6000) or compatible<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><a href="#VXD"><sup title="LINEAR-EXECUTABLE (LE) File Header Layout">[5]</sup></a></td></tr>
<tr>
<td>0x42</td>
<td>MIPS III (R4000) or compatible<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><a href="#VXD"><sup title="LINEAR-EXECUTABLE (LE) File Header Layout">[5]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i16le</td>
<td>OS Type
<table border='1'>
<tr>
<td>0x00</td>
<td>Unknown</td></tr>
<tr>
<td>0x01</td>
<td>OS/2</td></tr>
<tr>
<td>0x02</td>
<td>Windows</td></tr>
<tr>
<td>0x03</td>
<td>DOS 4.x, Multitasking ("European") MS-DOS 4.0<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td>0x04</td>
<td>Windows 386</td></tr>
<tr>
<td>0x05</td>
<td>IBM Microkernel Personality Neutral<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32le</td>
<td>Module version</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32le</td>
<td>Module type
<table border='1'>
<tr>
<td>Bit 1</td>
<td>Single data<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td>Bit 2</td>
<td>
<table border='1'>
<tr>
<td>0</td>
<td>Global library initialization</td></tr>
<tr>
<td>1</td>
<td>Per-process library initialization. EIP Object number and EIP must have valid values</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 4</td>
<td>Internal fixups have been applied. If set, each object has a preferred address at which it can be loaded without internal fixups</td></tr>
<tr>
<td>Bit 5</td>
<td>External fixups have been applied</td></tr>
<tr>
<td>Bits 8:9</td>
<td>Application type
<table border='1'>
<tr>
<td>01</td>
<td>Incompatible with PM windowing</td></tr>
<tr>
<td>02</td>
<td>Compatible with PM windowing</td></tr>
<tr>
<td>03</td>
<td>Uses PM windowing API</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 13</td>
<td>Module is not loadable. Either there were errors during linking or the module is being incrementally linked</td></tr>
<tr>
<td>Bits 15:17</td>
<td>Module type
<table border='1'>
<tr>
<td>00</td>
<td>Program. Modules cannot contain dynamic links to program modules</td></tr>
<tr>
<td>01</td>
<td>Library<br>Windows 3.x device driver (must have external fixups done)<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td>03</td>
<td>Protected memory library</td></tr>
<tr>
<td>04</td>
<td>Physical device driver</td></tr>
<tr>
<td>05</td>
<td>Virtual device driver<br>(Windows VxD) Static device driver<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td>07</td>
<td>(Windows VxD) Dynamic device driver<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td>Bit 19</td>
<td>Unsafe to run in multiple-processor environment<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>Bit 30</td>
<td>
<table border='1'>
<tr>
<td>0</td>
<td>Global library termination</td></tr>
<tr>
<td>1</td>
<td>Per-process library termination. EIP Object number and EIP must have valid values</td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32le</td>
<td>Number of pages physically appearing in the module. This includes pages with enumerated or iterated data, or according to <a href="#IBM92"><sup title="LX - Linear eXecutable Module Format Description">[1]</sup></a> but not <a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a>, zero-filled pages with relocations</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32le</td>
<td>Object number of EIP (entry or library initialization). Must be non-zero for programs</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32le</td>
<td>Initial EIP (entry or library initialization)</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32le</td>
<td>Object number of ESP (stack). Must be non-zero for programs, ignored for libraries</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i32le</td>
<td>Initial ESP (stack). Ignored for libraries</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i32le</td>
<td>Size of a single page in bytes. Should be 4096</td></tr>
<tr>
<td><tt><sub>x</sub>2C</tt></td>	<td>i32le</td>
<td>(LE) Byte count of final page<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><a href="#VXD"><sup title="LINEAR-EXECUTABLE (LE) File Header Layout">[5]</sup></a><br>(LX) Page offset shift for <a href="#objpgtbl">Object Page Table</a> entry offsets<a href="#IBM92"><sup title="LX - Linear eXecutable Module Format Description">[1]</sup></a><a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>30</tt></td>	<td>i32le</td>
<td>Size of <a href="#fixsect">Fixup Section (resident)</a> in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>34</tt></td>	<td>i32le</td>
<td>Checksum of <a href="#fixsect">Fixup Section (resident)</a></td></tr>
<tr>
<td><tt><sub>x</sub>38</tt></td>	<td>i32le</td>
<td>Size of <a href="#ldrsect">Loader Section</a> in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>3C</tt></td>	<td>i32le</td>
<td>Checksum of <a href="#ldrsect">Loader Section</a></td></tr>
<tr>
<td><tt><sub>x</sub>40</tt></td>	<td>i32le</td>
<td>Offset of <a href="#ldrsect">Loader Section</a> from <a href="#modhdr">Linear Executable Module Header</a> start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>44</tt></td>	<td>i32le</td>
<td>Number of objects in <a href="#objtbl">Object Table</a></td></tr>
<tr>
<td><tt><sub>x</sub>48</tt></td>	<td>i32le</td>
<td>Offset of <a href="#objpgtbl">Object Page Table</a> from <a href="#modhdr">Linear Executable Module Header</a> start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>4C</tt></td>	<td>i32le</td>
<td>Offset of <a href="#objitpgtbl">Object Iterated Page Table</a> from file start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>50</tt></td>	<td>i32le</td>
<td>Offset of <a href="#restbl">Resource Table</a> from <a href="#modhdr">Linear Executable Module Header</a> start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>54</tt></td>	<td>i32le</td>
<td>Number of entries in <a href="#restbl">Resource Table</a></td></tr>
<tr>
<td><tt><sub>x</sub>58</tt></td>	<td>i32le</td>
<td>Offset of <a href="#rntbl">Resident Name Table</a> from <a href="#modhdr">Linear Executable Module Header</a> start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>5C</tt></td>	<td>i32le</td>
<td>Offset of <a href="#enttbl">Entry Table</a> from <a href="#modhdr">Linear Executable Module Header</a> start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>60</tt></td>	<td>i32le</td>
<td>Offset of <a href="#modfmtdirtbl">Module Format Directives Table (optional)</a> from <a href="#modhdr">Linear Executable Module Header</a> start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>64</tt></td>	<td>i32le</td>
<td>Number of entries in <a href="#modfmtdirtbl">Module Format Directives Table (optional)</a></td></tr>
<tr>
<td><tt><sub>x</sub>68</tt></td>	<td>i32le</td>
<td>Offset of <a href="#fixpgtbl">Fixup Page Table</a> from <a href="#modhdr">Linear Executable Module Header</a> start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>6C</tt></td>	<td>i32le</td>
<td>Offset of <a href="#fixrectbl">Fixup Record Table</a> from <a href="#modhdr">Linear Executable Module Header</a> start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>70</tt></td>	<td>i32le</td>
<td>Offset of <a href="#impmodtbl">Import Module Name Table</a> from <a href="#modhdr">Linear Executable Module Header</a> start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>74</tt></td>	<td>i32le</td>
<td>Number of entries in <a href="#impmodtbl">Import Module Name Table</a></td></tr>
<tr>
<td><tt><sub>x</sub>78</tt></td>	<td>i32le</td>
<td>Offset of <a href="#impproctbl">Import Procedure Name Table</a> from <a href="#modhdr">Linear Executable Module Header</a> start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>7C</tt></td>	<td>i32le</td>
<td>Offset of <a href="#perpgcks">Per-Page Checksum</a> from <a href="#modhdr">Linear Executable Module Header</a> start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>80</tt></td>	<td>i32le</td>
<td>Offset of data pages from file start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>84</tt></td>	<td>i32le</td>
<td>Number of preload pages. OS/2 2.0 does not respect the preload of pages</td></tr>
<tr>
<td><tt><sub>x</sub>88</tt></td>	<td>i32le</td>
<td>Offset of <a href="#nrntbl">Non-Resident Name Table</a> from file start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>8C</tt></td>	<td>i32le</td>
<td>Size of <a href="#nrntbl">Non-Resident Name Table</a> in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>90</tt></td>	<td>i32le</td>
<td>Checksum of <a href="#nrntbl">Non-Resident Name Table</a></td></tr>
<tr>
<td><tt><sub>x</sub>94</tt></td>	<td>i32le</td>
<td>(16-bit compatibility) Automatic DS object</td></tr>
<tr>
<td><tt><sub>x</sub>98</tt></td>	<td>i32le</td>
<td>Offset of <a href="#debugsect">Debug Section</a> from file start<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a> in bytes. (<a href="#IBM92"><sup title="LX - Linear eXecutable Module Format Description">[1]</sup></a> claims it is from <a href="#modhdr">Linear Executable Module Header</a> but <a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a> clarifies that this is wrong)</td></tr>
<tr>
<td><tt><sub>x</sub>9C</tt></td>	<td>i32le</td>
<td>Size of debug information in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>A0</tt></td>	<td>i32le</td>
<td>Number of instance pages in preload section</td></tr>
<tr>
<td><tt><sub>x</sub>A4</tt></td>	<td>i32le</td>
<td>Number of instance pages in demand section</td></tr>
<tr>
<td><tt><sub>x</sub>A8</tt></td>	<td>i32le</td>
<td>(16-bit compatibilty) Size of initial heap in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>AC</tt></td>	<td>i32le</td>
<td>(OS/2 only) Size of stack in bytes<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a>. Byte at offset <tt><sub>x</sub>AD</tt> should not be <tt><sub>x</sub>02</tt> or <tt><sub>x</sub>04</tt> for OS/2 2.0</td></tr>
<tr>
<td><tt><sub>x</sub>B0</tt></td>	<td>c[8]</td>
<td>reserved</td></tr>
<tr>
<td><tt><sub>x</sub>B8</tt></td>	<td>i32le</td>
<td>(Windows VxD only) Offset of VERSIONINFO resource<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>BC</tt></td>	<td>i32le</td>
<td>(Windows VxD only) Size of VERSIONINFO resource<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>C0</tt></td>	<td>i16le</td>
<td>(Windows VxD only) Device ID<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>C2</tt></td>	<td>i16le</td>
<td>(Windows VxD only) DDK version<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a> (<tt><sub>x</sub>030A</tt><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a>)</td></tr>
</table>
<a id="ldrsect"/>
<h2>Loader Section</h1>
<table border='1' align='center'>
<tr>
<td><a href="#objtbl">Object Table</a></td></tr>
<tr>
<td><a href="#objpgtbl">Object Page Table</a></td></tr>
<tr>
<td><a href="#objitpgtbl">Object Iterated Page Table</a></td></tr>
<tr>
<td><a href="#restbl">Resource Table</a></td></tr>
<tr>
<td><a href="#rntbl">Resident Name Table</a></td></tr>
<tr>
<td><a href="#enttbl">Entry Table</a></td></tr>
<tr>
<td><a href="#modfmtdirtbl">Module Format Directives Table (optional)</a></td></tr>
<tr>
<td><a href="#resdirdattbl">Resident Directives Data Table (optional)</a></td></tr>
<tr>
<td><a href="#perpgcks">Per-Page Checksum</a> (LX only)</td></tr>
</table>
<a id="objtbl"/>
<h3>Object Table</h2>
<p>The object table's location and length can be read from the <a href="#modhdr">Linear Executable Module Header</a> directly. Each entry is 24 bytes long.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>Size of object loaded into memory</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>The base address of the object. If the internal relocations have been removed, the object must be loaded at this address</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32le</td>
<td>Object flags
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Readable</td></tr>
<tr>
<td>Bit 1</td>
<td>Writable</td></tr>
<tr>
<td>Bit 2</td>
<td>Executable</td></tr>
<tr>
<td>Bit 3</td>
<td>Resource</td></tr>
<tr>
<td>Bit 4</td>
<td>Discardable</td></tr>
<tr>
<td>Bit 5</td>
<td>Shared</td></tr>
<tr>
<td>Bit 6</td>
<td>Object has Preload pages</td></tr>
<tr>
<td>Bit 7</td>
<td>Object has Invalid pages</td></tr>
<tr>
<td>Bit 8</td>
<td>(LE) Object is Permanent and Swappable<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><br>(LX) Object has Zero Filled pages (non-Contiguous)<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#IBM92"><sup title="LX - Linear eXecutable Module Format Description">[1]</sup></a></td></tr>
<tr>
<td>Bit 9</td>
<td>(device drivers only) Object is Resident<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#IBM92"><sup title="LX - Linear eXecutable Module Format Description">[1]</sup></a></td></tr>
<tr>
<td>Bit 10</td>
<td>(device drivers only) Object is Resident and long-lockable<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a><a href="#IBM92"><sup title="LX - Linear eXecutable Module Format Description">[1]</sup></a></td></tr>
<tr>
<td>Bit 11</td>
<td>Object is marked as an IBM Microkernel extension<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>Bit 12</td>
<td>(x86 specific) 16:16 alias required</td></tr>
<tr>
<td>Bit 13</td>
<td>(x86 specific) the Big bit for data segments and the Default bit for code segments</td></tr>
<tr>
<td>Bit 14</td>
<td>(x86 specific) Object is conforming code</td></tr>
<tr>
<td>Bit 15</td>
<td>(x86 specific) Object I/O privilege level, for 16:16 alias objects</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32le</td>
<td><a href="#objpgtbl">Object Page Table</a> index</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32le</td>
<td><a href="#objpgtbl">Object Page Table</a> entry count, any remaining pages are zero filled unless last defined entry is illegal, in which case all remaining pages are illegal</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32le</td>
<td>reserved</td></tr>
</table>
<a id="objpgtbl"/>
<h3>Object Page Table</h2>
<p>Every page stored in the image has a corresponding page table entry. The format of an entry differs between the LE and LX formats.</p>
<p>This is the format of an LE entry.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i24be</td>
<td>Index into <a href="#fixpgtbl">Fixup Page Table</a><a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>i8</td>
<td>Flags<a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
</table>
<p>This is the format of an LX entry.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>Offset to page data shifted by the Page offset shift. For zero filled pages, this is 0</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Data size. The remainder of the page size is filled with zero for a legal physical page or the iterated data records</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>Flags
<table border='1'>
<tr>
<td>00</td>
<td>Legal physical page, offset from start of Preload pages</td></tr>
<tr>
<td>01</td>
<td>Iterated data page, offset from start of Iterated data pages</td></tr>
<tr>
<td>02</td>
<td>Invalid page</td></tr>
<tr>
<td>03</td>
<td>Zero filled page</td></tr>
<tr>
<td>04</td>
<td>Range of pages</td></tr>
<tr>
<td>05</td>
<td>Compressed page, offset from Preload pages<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
</table>
</td></tr>
</table>
<p>The two formats encode different information. The LE format contains the offset into the fixup page table. For LX, the fixup page table goes in parallel with the object page table, and each entry corresponds to the accompanying other entry.</p>
<p>The LX format contains the offset and size of each page. For LE, every page but the last one in the file has the same size, and they come consecutively.</p>
<a id="objitpgtbl"/>
<h3>Object Iterated Page Table</h2>
<p>Same structure as <a href="#objpgtbl">Object Page Table</a>.</p>
<a id="restbl"/>
<h3>Resource Table</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Type ID
<table border='1'>
<tr>
<td>01</td>
<td><tt>RT_POINTER</tt> &mdash; mouse pointer shape<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>02</td>
<td><tt>RT_BITMAP</tt> &mdash; bitmap<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>03</td>
<td><tt>RT_MENU</tt> &mdash; menu template<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>04</td>
<td><tt>RT_DIALOG</tt> &mdash; dialog template<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>05</td>
<td><tt>RT_STRING</tt> &mdash; string tables<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>06</td>
<td><tt>RT_FONTDIR</tt> &mdash; font directory<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>07</td>
<td><tt>RT_FONT</tt> &mdash; font<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>08</td>
<td><tt>RT_ACCELTABLE</tt> &mdash; accelerator tables<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>09</td>
<td><tt>RT_RCDATA</tt> &mdash; binary data<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>0A</td>
<td><tt>RT_MESSAGE</tt> &mdash; error message tables<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>0B</td>
<td><tt>RT_DLGINCLUDE</tt> &mdash; dialog include file name<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>0C</td>
<td><tt>RT_VKEYTBL</tt> &mdash; key to vkey tables<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>0D</td>
<td><tt>RT_KEYTBL</tt> &mdash; key to UGL tables<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>0E</td>
<td><tt>RT_CHARTBL</tt> &mdash; glyph to character tables<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>0F</td>
<td><tt>RT_DISPLAYINFO</tt> &mdash; screen display information<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>10</td>
<td><tt>RT_FKASHORT</tt> &mdash; function key area short form<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>11</td>
<td><tt>RT_FKALONG</tt> &mdash; function key area long form<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>12</td>
<td><tt>RT_HELPTABLE</tt> &mdash; help table for Cary Help manager<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>13</td>
<td><tt>RT_HELPSUBTABLE</tt> &mdash; help subtable for Cary Help manager<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>14</td>
<td><tt>RT_FDDIR</tt> &mdash; DBCS uniq/font driver directory<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>15</td>
<td><tt>RT_FD</tt> &mdash; DBCS uniq/font driver<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Name ID</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>Resource size</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le</td>
<td>Object number</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i32le</td>
<td>Offset within object image</td></tr>
</table>
<a id="rntbl"/>
<h3>Resident Name Table</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Length of the string or 0 to terminate the table. <a href="#IBM92"><sup title="LX - Linear eXecutable Module Format Description">[1]</sup></a> reserved bit 7 as an Overload bit for additional information for parameter type checking, but this behavior is absent from <a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>c[*]</td>
<td>ASCII text of the string name, not terminated with null</td></tr>
<tr>
<td><tt>...</tt></td>	<td>i16le</td>
<td>Ordinal number</td></tr>
</table>
<a id="enttbl"/>
<h3>Entry Table</h2>
<p>Entries are combined into bundles. Every bundle has the following heading:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Number of entries in the bundle. A 0 value indicates the end of the <a href="#enttbl">Entry Table</a></td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i8</td>
<td>Bundle (entry) type
<table border='1'>
<tr>
<td>Bits 0:6</td>
<td>
<table border='1'>
<tr>
<td>00</td>
<td><a href="#unent">Unused entry</a></td></tr>
<tr>
<td>01</td>
<td><a href="#16ent">16-bit entry</a></td></tr>
<tr>
<td>02</td>
<td><a href="#286ent">286 call gate entry</a></td></tr>
<tr>
<td>03</td>
<td><a href="#32ent">32-bit entry</a></td></tr>
<tr>
<td>04</td>
<td><a href="#forwent">Forwarder entry</a></td></tr>
</table>
</td></tr>
<tr>
<td>Bit 7</td>
<td>Parameter typing information</td></tr>
</table>
</td></tr>
</table>
<a id="unent"/>
<h4>Unused entry</h3>
<p>Unused entries have no following data, the next bundle follows directly after the first 2 bytes.</p>
<a id="16ent"/>
<h4>16-bit entry</h3>
<p>The bundle has a 4 byte header followed by 3 byte entries:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Object number</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Flags
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Exported entry</td></tr>
<tr>
<td>Bits 4:7</td>
<td>Parameter word count</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i16le</td>
<td>Offset in object</td></tr>
</table>
<a id="286ent"/>
<h4>286 call gate entry</h3>
<p>The bundle has a 4 byte header followed by 5 byte entries:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Object number</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Flags
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Exported entry</td></tr>
<tr>
<td>Bits 4:7</td>
<td>Parameter word count</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i16le</td>
<td>Offset in object</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>i16le</td>
<td>Call gate selector, reserved</td></tr>
</table>
<a id="32ent"/>
<h4>32-bit entry</h3>
<p>The bundle has a 4 byte header followed by 5 byte entries:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Object number</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Flags
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Exported entry</td></tr>
<tr>
<td>Bits 4:7</td>
<td>Parameter word count</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i32le</td>
<td>Offset in object</td></tr>
</table>
<a id="forwent"/>
<h4>Forwarder entry</h3>
<p>The bundle has a 4 byte header followed by 5 byte entries:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Reserved</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Flags
<table border='1'>
<tr>
<td>Bit 0</td>
<td>
<table border='1'>
<tr>
<td>0</td>
<td>Import by name</td></tr>
<tr>
<td>1</td>
<td>Import by ordinal</td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i16le</td>
<td>Module number</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>i16le</td>
<td>Procedure name offset<br>Import ordinal number</td></tr>
</table>
<a id="modfmtdirtbl"/>
<h3>Module Format Directives Table (optional)</h2>
<p>TODO</p>
<a id="resdirdattbl"/>
<h3>Resident Directives Data Table (optional)</h2>
<p>TODO</p>
<a id="perpgcks"/>
<h3>Per-Page Checksum</h2>
<p>TODO</p>
<a id="fixsect"/>
<h2>Fixup Section (resident)</h1>
<table border='1' align='center'>
<tr>
<td><a href="#fixpgtbl">Fixup Page Table</a></td></tr>
<tr>
<td><a href="#fixrectbl">Fixup Record Table</a></td></tr>
<tr>
<td><a href="#impmodtbl">Import Module Name Table</a></td></tr>
<tr>
<td><a href="#impproctbl">Import Procedure Name Table</a></td></tr>
<tr>
<td><a href="#perpgcks">Per-Page Checksum</a> (LE only)<a href="#VXD"><sup title="LINEAR-EXECUTABLE (LE) File Header Layout">[5]</sup></a></td></tr>
</table>
<a id="fixpgtbl"/>
<h3>Fixup Page Table</h2>
<p>For every page there is a 32-bit (little endian) value for the offset of the first relocation record within <a href="#fixrectbl">Fixup Record Table</a> in bytes. There is a final 32-bit (little endian) value that is the size of the <a href="#fixrectbl">Fixup Record Table</a>.</p>
<a id="fixrectbl"/>
<h3>Fixup Record Table</h2>
<p>A collection of variable length fixup records, each referring to a fixup within a specific page. The header is either 3 or 4 bytes long, depending on the Source list flag.</p>
<table border='1' align='center'>
<tr>
<td colspan='3'><tt><sub>x</sub>00</tt></td>	<td colspan='3'>u8</td>
<td>Source flags
<table border='1'>
<tr>
<td>Bits 0:3</td>
<td>Source type
<table border='1'>
<tr>
<td>00</td>
<td>low 8-bit</td></tr>
<tr>
<td>02</td>
<td>16-bit selector</td></tr>
<tr>
<td>03</td>
<td>16:16-bit far pointer (32-bit)</td></tr>
<tr>
<td>05</td>
<td>16-bit offset within a segment</td></tr>
<tr>
<td>06</td>
<td>16:32-bit far pointer (48-bit)</td></tr>
<tr>
<td>07</td>
<td>32-bit offset within a segment</td></tr>
<tr>
<td>08</td>
<td>32-bit self relative fixup, <a href="#RB"><sup title="Ralf Brown's interrupt list">[4]</sup></a>for 16-bit segments, 16-bit self relative fixup</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 4</td>
<td>Fixup to 16:16-bit alias</td></tr>
<tr>
<td>Bit 5</td>
<td>Source list, providing a list of source offsets instead of a single one</td></tr>
</table>
</td></tr>
<tr>
<td colspan='3'><tt><sub>x</sub>01</tt></td>	<td colspan='3'>u8</td>
<td>Target flags
<table border='1'>
<tr>
<td>Bits 0:1</td>
<td>Target type
<table border='1'>
<tr>
<td>00</td>
<td><a href="#intref">Internal reference</a></td></tr>
<tr>
<td>01</td>
<td><a href="#impordref">Imported reference by ordinal</a></td></tr>
<tr>
<td>02</td>
<td><a href="#impnamref">Imported reference by name</a></td></tr>
<tr>
<td>03</td>
<td><a href="#entref">Internal reference via entry table</a></td></tr>
</table>
</td></tr>
<tr>
<td>Bit 2</td>
<td>Additive fixup, an additive field follows the record (but before the source offset list, if the Source list flag is set)</td></tr>
<tr>
<td>Bit 3</td>
<td>Internal chaining fixup. When set, the source offset is an offset to the first entry of a chain of fixups<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></td></tr>
<tr>
<td>Bit 4</td>
<td>Target offset width
<table border='1'>
<tr>
<td>0</td>
<td>16-bit</td></tr>
<tr>
<td>1</td>
<td>32-bit</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 5</td>
<td>Additive value width
<table border='1'>
<tr>
<td>0</td>
<td>16-bit</td></tr>
<tr>
<td>1</td>
<td>32-bit</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 6</td>
<td>Object number/module ordinal number width
<table border='1'>
<tr>
<td>0</td>
<td>8-bit</td></tr>
<tr>
<td>1</td>
<td>16-bit</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 7</td>
<td>Ordinal number width
<table border='1'>
<tr>
<td>0</td>
<td>16-bit or 32-bit</td></tr>
<tr>
<td>1</td>
<td>8-bit</td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr>
<td colspan='3'><tt><sub>x</sub>02</tt></td>	<td colspan='3'>i16le</td>
<td>If the Source list flag is 0, this is the offset to the source</td></tr>
<tr>
<td colspan='3'><tt><sub>x</sub>02</tt></td>	<td colspan='3'>i8</td>
<td>If the Source list flag is 1, this is the number of source offsets appearing after the target data</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td><td><tt><sub>x<</tt></td><td><tt>sub>04</tt></td>	<td colspan='3'>c[*]</td>
<td>Target data, depending on the reference type</td></tr>
<tr>
<td colspan='3'><tt>...</tt></td>	<td colspan='3'>i16le[*]</td>
<td>If Source list flag is 1, this is a list of offsets</td></tr>
</table>
<a id="intref"/>
<h4>Internal reference</h3>
<table border='1' align='center'>
<tr>
<td>Target object number</td>
<td>Object number width (8-bit/16-bit)</td></tr>
<tr>
<td>Target offset</td>
<td>Target offset width (16-bit/32-bit)</td></tr>
</table>
<a id="impordref"/>
<h4>Imported reference by ordinal</h3>
<table border='1' align='center'>
<tr>
<td>Module index</td>
<td>Object number/module ordinal number width (16-bit/32-bit)</td></tr>
<tr>
<td>Imported ordinal</td>
<td>Ordinal number width (8-bit)<br>Target offset width (16-bit/32-bit)</td></tr>
<tr>
<td>Additive value</td>
<td>(Additive fixup) Additive value width (16-bit/32-bit)</td></tr>
</table>
<a id="impnamref"/>
<h4>Imported reference by name</h3>
<table border='1' align='center'>
<tr>
<td>Module index</td>
<td>Object number/module ordinal number width (16-bit/32-bit)</td></tr>
<tr>
<td>Procedure name offset into <a href="#impproctbl">Import Procedure Name Table</a></td>
<td>Target offset width (16-bit/32-bit)</td></tr>
<tr>
<td>Additive value</td>
<td>(Additive fixup) Additive value width (16-bit/32-bit)</td></tr>
</table>
<a id="entref"/>
<h4>Internal reference via entry table</h3>
<table border='1' align='center'>
<tr>
<td>Index into entry table</td>
<td>Object number/module ordinal number width (16-bit/32-bit)</td></tr>
<tr>
<td>Additive value</td>
<td>(Additive fixup) Additive value width (16-bit/32-bit)</td></tr>
</table>
<a id="chain"/>
<h4>Internal chaining fixups</h3>
<p>When the internal chaining fixup flag is set, the source address becomes the first element of a chain. Each chain element contains a 32-bit value at the source which is used to determine the next chain element and a relocation addend.<a href="#IBM96"><sup title="IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)">[2]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>
<table border='1'>
<tr>
<td>Bits 0:19</td>
<td>Target offset, added to the base address, which is the target address minus the first target offset.</td></tr>
<tr>
<td>Bits 20:31</td>
<td>Source offset, to the next fixup within the same page, or <tt><sub>x</sub>FFF</tt></td></tr>
</table>
</td></tr>
</table>
<a id="impmodtbl"/>
<h3>Import Module Name Table</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Length of the string or 0 to terminate the table</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>c[*]</td>
<td>ASCII text of the string name, not terminated with null</td></tr>
</table>
<a id="impproctbl"/>
<h3>Import Procedure Name Table</h2>
<p>The first entry must be the null string.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Length of the string or 0 to terminate the table. reserved bit 7 as an Overload bit for additional information for parameter type checking, but this behavior is absent from</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>c[*]</td>
<td>ASCII text of the string name, not terminated with null</td></tr>
</table>
<a id="datasect"/>
<h2>Data Section</h1>
<table border='1' align='center'>
<tr>
<td>Preload pages</td></tr>
<tr>
<td>Demand load pages</td></tr>
<tr>
<td><a href="#itdatpg">Iterated data pages</a></td></tr>
<tr>
<td><a href="#nrntbl">Non-Resident Name Table</a></td></tr>
<tr>
<td><a href="#nrdirdat">Non-Resident Directives Data</a></td></tr>
</table>
<a id="itdatpg"/>
<h3>Iterated data pages</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Number of iterations</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Pattern length</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>c[*]</td>
<td>Pattern to be repeated</td></tr>
</table>
<a id="nrntbl"/>
<h3>Non-Resident Name Table</h2>
<p>Same format as the <a href="#rntbl">Resident Name Table</a>.</p>
<a id="nrdirdat"/>
<h3>Non-Resident Directives Data</h2>
<p>TODO</p>
<a id="debugsect"/>
<h2>Debug Section</h1>
<p>TODO</p>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="http://www.edm2.com/index.php/LX_-_Linear_eXecutable_Module_Format_Description" target='_blank'>LX - Linear eXecutable Module Format Description</a></li>
<li>[2] <a href="http://www.edm2.com/index.php/IBM_OS/2_16/32-bit_Object_Module_Format_(OMF)_and_Linear_eXecutable_Module_Format_(LX)" target='_blank'>IBM OS/2 16/32-bit Object Module Format (OMF) and Linear eXecutable Module Format (LX)</a></li>
<li>[3] <a href="https://github.com/open-watcom/open-watcom-v2" target='_blank'>OpenWatcom sources</a></li>
<li>[4] <a href="http://www.delorie.com/djgpp/doc/rbinter/ix/" target='_blank'>Ralf Brown's interrupt list</a></li>
<li>[5] <a href="https://faydoc.tripod.com/formats/exe-LE.htm" target='_blank'>LINEAR-EXECUTABLE (LE) File Header Layout</a></li>
</ul>
<hr/>
<h1 id="pe">Portable executable (PE)</h1>
<dl>
<dt>File extensions</td>
<dd><tt>.exe</tt>, <tt>.dll</tt> for libraries, etc.</dd>
<dl>
<dt>Magic code</td>
<dd><tt>"PE"</tt> (<tt>"PL"</tt> for Phar Lap)</dd>
<dl>
<dt>Architecture</td>
<dd>various, including Intel 80386</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>1993-09-27: Windows NT 3.1</li>
<li>1995-08-24: Windows 95 (4.0)</li>
<li>1998-03: BeOS Release 3 for Intel 80386</li>
<li>?: Phar Lap TNT DOS-Extender</li>
<li>?: HX-DOS extender</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>various, including Intel 80386</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#stub">MS-DOS stub</a>
</li>
<li><a href="#signature">Signature</a>
</li>
<li><a href="#coffhdr">COFF File Header</a>
</li>
<li><a href="#opthdr">Optional header</a>
<ol>
<li><a href="#opthdr1">Optional header standard fields</a>
</li>
<li><a href="#opthdr2">Optional header Windows-specific fields</a>
</li>
<li><a href="#opthdr3">Optional header data directories</a>
</li>
</ol></li>
<li><a href="#secthdr">Section header</a>
</li>
<li><a href="#">Section data</a>
<ol>
<li><a href="#">.debug section</a>
</li>
<li><a href="#">.drectve section</a>
</li>
<li><a href="#edata">Export (.edata) section</a>
<ol>
<li><a href="#expadrtab">Export address table</a>
</li>
<li><a href="#expnamptrtab">Export name pointer table</a>
</li>
<li><a href="#expordtab">Export ordinal table</a>
</li>
<li><a href="#expnamtab">Export name table</a>
</li>
</ol></li>
<li><a href="#idata">Import (.idata) section</a>
<ol>
<li><a href="#">Import directory table</a>
</li>
<li><a href="#impluptab">Import lookup table</a>
</li>
<li><a href="#hinttab">Hint/name table</a>
</li>
<li><a href="#impadrtab">Import address table</a>
</li>
</ol></li>
<li><a href="#">.pdata section</a>
</li>
<li><a href="#reloc">Base relocation table (.reloc) section</a>
<ol>
<li><a href="#">Base relocation block</a>
</li>
</ol></li>
<li><a href="#">.tls section</a>
</li>
<li><a href="#">Load configuration section</a>
</li>
<li><a href="#rsrc">.rsrc section</a>
<ol>
<li><a href="#resdirtab">Resource directory table</a>
</li>
<li><a href="#">Resource directory strings</a>
</li>
<li><a href="#">Resource data description</a>
</li>
<li><a href="#">Resource data</a>
</li>
</ol></li>
<li><a href="#">.cormeta section</a>
</li>
<li><a href="#">.sxdata section</a>
</li>
</ol></li>
<li><a href="#relocs">COFF relocations</a>
</li>
<li><a href="#linenos">COFF line numbers</a>
</li>
<li><a href="#symtab">COFF symbol table</a>
</li>
<li><a href="#">Auxiliary symbols</a>
</li>
<li><a href="#">COMDAT sections</a>
</li>
<li><a href="#">CLR token definition</a>
</li>
<li><a href="#">COFF string table</a>
</li>
<li><a href="#">Attribute certificate table</a>
</li>
<li><a href="#">Delay-load import tables</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<p>The PE format is probably the most widespread format for personal computer. It is based on the COFF file format, and several fields are similar to it. Similarly to other Microsoft formats, it starts with an MS-DOS stub that typically displays a message that this application can only be run in Windows, and then exits.</p>
<table border='1' align='center'>
<tr>
<td><a href="#stub">MS-DOS stub</a></td></tr>
<tr>
<td><a href="#signature">Signature</a></td></tr>
<tr>
<td><a href="#coffhdr">COFF File Header</a></td></tr>
<tr>
<td><a href="#opthdr1">Optional header standard fields</a></td></tr>
<tr>
<td><a href="#opthdr2">Optional header Windows-specific fields</a></td></tr>
<tr>
<td><a href="#opthdr3">Optional header data directories</a></td></tr>
<tr>
<td><a href="#secthdr">Section header</a>s</td></tr>
<tr>
<td>Section data</td></tr>
<tr>
<td><a href="#symtab">COFF symbol table</a></td></tr>
<tr>
<td><a href="#relocs">COFF relocations</a></td></tr>
</table>
<a id="stub"/>
<h2>MS-DOS stub</h1>
<p>A portable executable file starts with an MZ stub program, with the following additional or modified field.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i16le</td>
<td>Should be <tt><sub>x</sub>0040</tt></td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i16le</td>
<td>OEM Identifier</td></tr>
<tr>
<td><tt><sub>x</sub>26</tt></td>	<td>i16le</td>
<td>OEM Info</td></tr>
<tr>
<td><tt><sub>x</sub>3C</tt></td>	<td>i32le</td>
<td>Offset to <a href="#signature">Signature</a> from file start in bytes</td></tr>
</table>
<a id="signature"/>
<h2>Signature</h1>
<p>Only part of an image.<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a> This signature identifies the application as PE. A COFF image follows it.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td><tt>'PE\0\0'</tt><br>Phar Lap uses <tt>'PL\0\0'</tt> to distinguish from Windows applications</td></tr>
</table>
<a id="coffhdr"/>
<h2>COFF File Header</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Machine (COFF magic)
<table border='1'>
<tr>
<td>0x0000</td>
<td>unknown<a href="#TIS"><sup title="Tool Interface Standard (TIS) Formats Specification for Windows TM, Version 1.0, 1993-02">[1]</sup></a><a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x014C</td>
<td>Intel 386<a href="#TIS"><sup title="Tool Interface Standard (TIS) Formats Specification for Windows TM, Version 1.0, 1993-02">[1]</sup></a><a href="#PE99"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 6.0, 1999-02">[2]</sup></a><a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#TOUR"><sup title="Peering Inside the PE: A Tour of the Win32 Portable Executable File Format, 2010-06-30">[4]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x8664</td>
<td>AMD64<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x01C0</td>
<td>ARM<a href="#PE99"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 6.0, 1999-02">[2]</sup></a><a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a> little endian<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x01C2</td>
<td>ARM Thumb<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x01C4</td>
<td>ARM Thumb-2 little endian<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0xAA64</td>
<td>ARM64 little endian<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0xA641</td>
<td>ARM64EC<a href="#MAGIC"><sup title="UNIX file magic numbers">[6]</sup></a></td></tr>
<tr>
<td>0x0200</td>
<td>Intel Itanium<a href="#PE99"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 6.0, 1999-02">[2]</sup></a><a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x5032</td>
<td>RISC-V 32-bit<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x5064</td>
<td>RISC-V 64-bit<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x5128</td>
<td>RISC-V 128-bit<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x0268</td>
<td>Motorola 68000<a href="#PE99"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 6.0, 1999-02">[2]</sup></a></td></tr>
<tr>
<td>0x014D</td>
<td>Intel i860<a href="#TOUR"><sup title="Peering Inside the PE: A Tour of the Win32 Portable Executable File Format, 2010-06-30">[4]</sup></a></td></tr>
<tr>
<td>0x014D</td>
<td>Intel 486<a href="#TIS"><sup title="Tool Interface Standard (TIS) Formats Specification for Windows TM, Version 1.0, 1993-02">[1]</sup></a></td></tr>
<tr>
<td>0x014E</td>
<td>Intel Pentium<a href="#TIS"><sup title="Tool Interface Standard (TIS) Formats Specification for Windows TM, Version 1.0, 1993-02">[1]</sup></a></td></tr>
<tr>
<td>0x0162</td>
<td>MIPS Mark I: R2000<a href="#TIS"><sup title="Tool Interface Standard (TIS) Formats Specification for Windows TM, Version 1.0, 1993-02">[1]</sup></a>, R3000<a href="#TIS"><sup title="Tool Interface Standard (TIS) Formats Specification for Windows TM, Version 1.0, 1993-02">[1]</sup></a><a href="#PE99"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 6.0, 1999-02">[2]</sup></a><a href="#TOUR"><sup title="Peering Inside the PE: A Tour of the Win32 Portable Executable File Format, 2010-06-30">[4]</sup></a></td></tr>
<tr>
<td>0x0163</td>
<td>MIPS Mark 2: R6000<a href="#TIS"><sup title="Tool Interface Standard (TIS) Formats Specification for Windows TM, Version 1.0, 1993-02">[1]</sup></a></td></tr>
<tr>
<td>0x0166</td>
<td>MIPS Mark 3: R4000<a href="#PE99"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 6.0, 1999-02">[2]</sup></a><a href="#TOUR"><sup title="Peering Inside the PE: A Tour of the Win32 Portable Executable File Format, 2010-06-30">[4]</sup></a>, MIPS<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a> little endian<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x0168</td>
<td>MIPS R10000<a href="#PE99"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 6.0, 1999-02">[2]</sup></a></td></tr>
<tr>
<td>0x0266</td>
<td>MISP16<a href="#PE99"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 6.0, 1999-02">[2]</sup></a><a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x0366</td>
<td>MIPS with FPU<a href="#PE99"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 6.0, 1999-02">[2]</sup></a><a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x0466</td>
<td>MIPS16 with FPU<a href="#PE99"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 6.0, 1999-02">[2]</sup></a><a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x0169</td>
<td>MIPS WCE v2<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a> little endian<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x0183</td>
<td>DEC Alpha AXP<a href="#TOUR"><sup title="Peering Inside the PE: A Tour of the Win32 Portable Executable File Format, 2010-06-30">[4]</sup></a></td></tr>
<tr>
<td>0x0184</td>
<td>DEC Alpha AXP<a href="#PE99"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 6.0, 1999-02">[2]</sup></a></td></tr>
<tr>
<td>0x0284</td>
<td>DEC Alpha AXP 64-bit<a href="#PE99"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 6.0, 1999-02">[2]</sup></a></td></tr>
<tr>
<td>0x01D3</td>
<td>Matsushiba AM33<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x0EBC</td>
<td>EFI byte code<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x9041</td>
<td>Mitsubishi M32R<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x01F0</td>
<td>PowerPC<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE99"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 6.0, 1999-02">[2]</sup></a> little endian<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x01F1</td>
<td>PowerPC with floating point<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x0601</td>
<td>PowerPC based Macintosh (stored in little endian) [checked with MSVC cross compiler]</td></tr>
<tr>
<td>0x01A2</td>
<td>Hitachi SH3<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x01A3</td>
<td>Hitachi SH3 DSP<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x01A6</td>
<td>Hitachi SH4<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x01A8</td>
<td>Hitachi SH5<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x0500</td>
<td>Hitachi SH big endian<a href="#MAGIC"><sup title="UNIX file magic numbers">[6]</sup></a></td></tr>
<tr>
<td>0x0550</td>
<td>Hitachi SH little endian<a href="#MAGIC"><sup title="UNIX file magic numbers">[6]</sup></a></td></tr>
<tr>
<td>0x0290</td>
<td>PA-RISC<a href="#MAGIC"><sup title="UNIX file magic numbers">[6]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Number of Sections (COFF)</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>Time Date Stamp, seconds since 1970-01-01 midnight (COFF)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32le</td>
<td>Offset to symbol table (COFF)<br>Should be 0 in PE image</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32le</td>
<td>Number of symbols in symbol table (COFF)<br>Should be 0 in PE image</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i16le</td>
<td>Size of optional header (COFF)</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i16le</td>
<td>Characteristics (COFF flags)
<table border='1'>
<tr>
<td>Bit 0</td>
<td>No relocations (COFF)</td></tr>
<tr>
<td>Bit 1</td>
<td>No unresolved symbols, executable (COFF)</td></tr>
<tr>
<td>Bit 2</td>
<td>No line number information, deprecated (COFF)</td></tr>
<tr>
<td>Bit 3</td>
<td>No local symbols, deprecated (COFF)</td></tr>
<tr>
<td>Bit 4</td>
<td>Aggressively trim working set (obsolete since Windows 2000)<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>Bit 5</td>
<td>> 2GB support</td></tr>
<tr>
<td>Bit 6</td>
<td>Reserved</td></tr>
<tr>
<td>Bit 7</td>
<td>Little endian (deprecated)</td></tr>
<tr>
<td>Bit 8</td>
<td>Little endian, 32-bit (COFF)</td></tr>
<tr>
<td>Bit 9</td>
<td>No debugging information</td></tr>
<tr>
<td>Bit 10</td>
<td>Removable run from swap, fully load and run from swap if on removable media</td></tr>
<tr>
<td>Bit 11</td>
<td>Net run from swap, fully load and run from swap if on network</td></tr>
<tr>
<td>Bit 12</td>
<td>System file</td></tr>
<tr>
<td>Bit 13</td>
<td>DLL</td></tr>
<tr>
<td>Bit 14</td>
<td>Uniprocessor machine</td></tr>
<tr>
<td>Bit 15</td>
<td>Big endian (deprecated)</td></tr>
</table>
</td></tr>
</table>
<a id="opthdr"/>
<h2>Optional header</h1>
<p>The following parts only appear inside load images.</p>
<a id="opthdr1"/>
<h3>Optional header standard fields</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Magic
<table border='1'>
<tr>
<td>0x0107</td>
<td>ROM image<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x010B</td>
<td>PE32, 32-bit</td></tr>
<tr>
<td>0x020B</td>
<td>PE32+, 64-bit</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i8</td>
<td>Major version</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>i8</td>
<td>Minor version</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>Size of code (COFF: text)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32le</td>
<td>Size of data (COFF)</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32le</td>
<td>Size of bss (COFF)</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32le</td>
<td>Entry point relative to image base (COFF)</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32le</td>
<td>Address of code relative to image base (COFF)</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32le</td>
<td>(Not PE+) Address of data relative to image base (COFF)</td></tr>
</table>
<a id="opthdr2"/>
<h3>Optional header Windows-specific fields</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>1C</tt></td><td><tt><sub>x</sub>18</tt></td>	<td>i32le</td><td>i64le</td>
<td>Image base address, added to almost all address fields, must be multiple of 64Ki
<table border='1'>
<tr>
<td>0x00010000</td>
<td>Default for Windows CE executables</td></tr>
<tr>
<td>0x00400000</td>
<td>Default for Windows NT/95 executables and higher</td></tr>
<tr>
<td>0x10000000</td>
<td>Default for DLLs</td></tr>
</table>
</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>20</tt></td>	<td colspan='2'>i32le</td>
<td>Section alignment in bytes<br>Default: page size</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>24</tt></td>	<td colspan='2'>i32le</td>
<td>File alignment of raw data sections in file, should be power of 2 between 512 and 64Ki</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>28</tt></td>	<td colspan='2'>i16le</td>
<td>OS major version</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>2A</tt></td>	<td colspan='2'>i16le</td>
<td>OS minor version</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>2C</tt></td>	<td colspan='2'>i16le</td>
<td>Image major version</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>2E</tt></td>	<td colspan='2'>i16le</td>
<td>Image minor version</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>30</tt></td>	<td colspan='2'>i16le</td>
<td>Subsystem major version</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>32</tt></td>	<td colspan='2'>i16le</td>
<td>Subsystem minor version</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>34</tt></td>	<td colspan='2'>i32le</td>
<td>Win32 version; must be 0</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>38</tt></td>	<td colspan='2'>i32le</td>
<td>Size of complete image in bytes (multiple of section alignment)</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>3C</tt></td>	<td colspan='2'>i32le</td>
<td>Size of headers, including DOS stub and section headers (multiple of file alignment)</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>40</tt></td>	<td colspan='2'>i32le</td>
<td>Checksum</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>44</tt></td>	<td colspan='2'>i16le</td>
<td>Subsystem
<table border='1'>
<tr>
<td>0x0000</td>
<td>Unknown</td></tr>
<tr>
<td>0x0001</td>
<td>Device driver, native Windows process</td></tr>
<tr>
<td>0x0002</td>
<td>Windows GUI</td></tr>
<tr>
<td>0x0003</td>
<td>Windows character mode</td></tr>
<tr>
<td>0x0005</td>
<td>OS/2 character mode<a href="#TIS"><sup title="Tool Interface Standard (TIS) Formats Specification for Windows TM, Version 1.0, 1993-02">[1]</sup></a><a href="#TOUR"><sup title="Peering Inside the PE: A Tour of the Win32 Portable Executable File Format, 2010-06-30">[4]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x0007</td>
<td>POSIX character mode</td></tr>
<tr>
<td>0x0008</td>
<td>Native Win9x driver<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x0009</td>
<td>Windows CE<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x000A</td>
<td>EFI application<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x000B</td>
<td>EFI driver with boot services<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x000C</td>
<td>EFI driver with runtime services<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x000D</td>
<td>EFI ROM image<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x000E</td>
<td>Xbox<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x0010</td>
<td>Windows boot application<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>46</tt></td>	<td colspan='2'>i16le</td>
<td>DLL characteristics
<table border='1'>
<tr>
<td>0x0001</td>
<td>Call on process startup<a href="#TIS"><sup title="Tool Interface Standard (TIS) Formats Specification for Windows TM, Version 1.0, 1993-02">[1]</sup></a><a href="#TOUR"><sup title="Peering Inside the PE: A Tour of the Win32 Portable Executable File Format, 2010-06-30">[4]</sup></a></td></tr>
<tr>
<td>0x0002</td>
<td>Call on process<a href="#TIS"><sup title="Tool Interface Standard (TIS) Formats Specification for Windows TM, Version 1.0, 1993-02">[1]</sup></a> termination (<a href="#TOUR"><sup title="Peering Inside the PE: A Tour of the Win32 Portable Executable File Format, 2010-06-30">[4]</sup></a> claims thread)</td></tr>
<tr>
<td>0x0004</td>
<td>Call on thread startup<a href="#TIS"><sup title="Tool Interface Standard (TIS) Formats Specification for Windows TM, Version 1.0, 1993-02">[1]</sup></a><a href="#TOUR"><sup title="Peering Inside the PE: A Tour of the Win32 Portable Executable File Format, 2010-06-30">[4]</sup></a></td></tr>
<tr>
<td>0x0008</td>
<td>Call on thread<a href="#TIS"><sup title="Tool Interface Standard (TIS) Formats Specification for Windows TM, Version 1.0, 1993-02">[1]</sup></a> termination (<a href="#TOUR"><sup title="Peering Inside the PE: A Tour of the Win32 Portable Executable File Format, 2010-06-30">[4]</sup></a> claims process)</td></tr>
<tr>
<td>0x0020</td>
<td>Can handle high entropy 64-bit virtual address space<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x0040</td>
<td>Can be relocated at load time<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a></td></tr>
<tr>
<td>0x0080</td>
<td>Code integrity check enforced<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a></td></tr>
<tr>
<td>0x0100</td>
<td>NX compatible image<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a></td></tr>
<tr>
<td>0x0200</td>
<td>Isolation aware, do not isolate<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a></td></tr>
<tr>
<td>0x0400</td>
<td>Does not use structured exception handling<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a></td></tr>
<tr>
<td>0x0800</td>
<td>Image must not be bound<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a></td></tr>
<tr>
<td>0x1000</td>
<td>Must execute in AppContainer<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a>, Reserved<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a></td></tr>
<tr>
<td>0x2000</td>
<td>WDM driver<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a></td></tr>
<tr>
<td>0x4000</td>
<td>Supports Control Flow Guard<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>0x8000</td>
<td>Terminal server aware<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td colspan='2'><tt><sub>x</sub>48</tt></td>	<td>i32le</td><td>i64le</td>
<td>Size of stack to reserve</td></tr>
<tr>
<td><tt><sub>x</sub>4C</tt></td><td><tt><sub>x</sub>50</tt></td>	<td>i32le</td><td>i64le</td>
<td>Size of stack to commit</td></tr>
<tr>
<td><tt><sub>x</sub>50</tt></td><td><tt><sub>x</sub>58</tt></td>	<td>i32le</td><td>i64le</td>
<td>Size of heap to reserve</td></tr>
<tr>
<td><tt><sub>x</sub>54</tt></td><td><tt><sub>x</sub>60</tt></td>	<td>i32le</td><td>i64le</td>
<td>Size of heap to commit</td></tr>
<tr>
<td><tt><sub>x</sub>58</tt></td><td><tt><sub>x</sub>68</tt></td>	<td colspan='2'>i32le</td>
<td>Loader flags, 0</td></tr>
<tr>
<td><tt><sub>x</sub>5C</tt></td><td><tt><sub>x</sub>6C</tt></td>	<td colspan='2'>i32le</td>
<td>Number of data directory entries</td></tr>
</table>
<a id="opthdr3"/>
<h3>Optional header data directories</h2>
<p>Stored as 4-byte relative virtual address and 4-byte size</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le[2]</td>
<td>Export table (<a href="#edata">Export (.edata) section</a>)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32le[2]</td>
<td>Import table (<a href="#idata">Import (.idata) section</a>)</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32le[2]</td>
<td>Resource table (<a href="#rsrc">.rsrc section</a>)</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32le[2]</td>
<td>Exception table</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32le[2]</td>
<td>Certificate table; stored as file pointer and size</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i32le[2]</td>
<td>Base relocation table (<a href="#reloc">Base relocation table (.reloc) section</a>)</td></tr>
<tr>
<td><tt><sub>x</sub>30</tt></td>	<td>i32le[2]</td>
<td>Debug data</td></tr>
<tr>
<td><tt><sub>x</sub>38</tt></td>	<td>i32le[2]</td>
<td>Architecture/Description string, must be 0</td></tr>
<tr>
<td><tt><sub>x</sub>44</tt></td>	<td>i32le</td>
<td>Global pointer</td></tr>
<tr>
<td><tt><sub>x</sub>44</tt></td>	<td>i32le</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>48</tt></td>	<td>i32le[2]</td>
<td>Thread local storage table</td></tr>
<tr>
<td><tt><sub>x</sub>50</tt></td>	<td>i32le[2]</td>
<td>Load configuration table<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>58</tt></td>	<td>i32le[2]</td>
<td>Bound table import<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>60</tt></td>	<td>i32le[2]</td>
<td>Import address table<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>68</tt></td>	<td>i32le[2]</td>
<td>Delay import descriptor<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>70</tt></td>	<td>i32le[2]</td>
<td>CLR runtime header<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>78</tt></td>	<td>i32le[2]</td>
<td>Reserved, 0<a href="#PE08"><sup title="Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15">[3]</sup></a><a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
</table>
<a id="secthdr"/>
<h2>Section header</h1>
<p>A sequence of structures encoding the sections.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[8]</td>
<td>Section name, padded with nulls (COFF)<br>A '/' followed by a decimal number gives an offset into the string table (not for executables)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32le</td>
<td>Total size of section</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32le</td>
<td>Virtual address (COFF)</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32le</td>
<td>Size of data in image (COFF)</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32le</td>
<td>Offset to section data from PE start (COFF)</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32le</td>
<td>Offset to relocation data, 0 for executables (COFF)</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32le</td>
<td>Offset to line number entries (deprecated) (COFF)</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i16le</td>
<td>Number of relocations, 0 for executables (COFF)</td></tr>
<tr>
<td><tt><sub>x</sub>22</tt></td>	<td>i16le</td>
<td>Number of line numbers (deprecated)</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i32le</td>
<td>Flags
<table border='1'>
<tr>
<td>Bit 3</td>
<td><tt>TYPE_NO_PAD</tt> - Must not be padded (obsolete)</td></tr>
<tr>
<td>Bit 5</td>
<td><tt>CNT_CODE</tt> - Executable (COFF)</td></tr>
<tr>
<td>Bit 6</td>
<td><tt>CNT_INITILIAZED_DATA</tt> - Initialized data (COFF)</td></tr>
<tr>
<td>Bit 7</td>
<td><tt>CNT_UNINITIALIZED_DATA</tt> - Uninitialized data (COFF)</td></tr>
<tr>
<td>Bit 8</td>
<td><tt>LNK_OTHER</tt> - reserved</td></tr>
<tr>
<td>Bit 9</td>
<td><tt>LNK_COMMENT</tt> - Comments</td></tr>
<tr>
<td>Bit 11</td>
<td><tt>LNK_REMOVE</tt> - Not part of final image (object only)</td></tr>
<tr>
<td>Bit 12</td>
<td><tt>LNK_COMDAT</tt> - COMDAT<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>Bit 15</td>
<td><tt>GPREL</tt> - Data in section is referenced through the global pointer<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>Bit 16</td>
<td><tt>MEM_PURGEABLE</tt> - reserved<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a> (typo in documentation, shows bit 17)</td></tr>
<tr>
<td>Bit 17</td>
<td><tt>MEM_16BIT</tt> - reserved<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>Bit 18</td>
<td><tt>MEM_LOCKED</tt> - reserved<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>Bit 19</td>
<td><tt>MEM_PRELOAD</tt> - reserved<a href="#PE"><sup title="PE Format - Microsoft">[5]</sup></a></td></tr>
<tr>
<td>Bits 20:23</td>
<td>Alignment: 2 ** (value - 1)</td></tr>
<tr>
<td>Bit 24</td>
<td><tt>LNK_NRELOC_OVFL</tt> - Contains extended relocations</td></tr>
<tr>
<td>Bit 25</td>
<td><tt>MEM_DISCARDABLE</tt> - Discardable</td></tr>
<tr>
<td>Bit 26</td>
<td><tt>MEM_NOT_CACHED</tt> - Non-cachable</td></tr>
<tr>
<td>Bit 27</td>
<td><tt>MEM_NOT_PAGED</tt> - Non-pageable</td></tr>
<tr>
<td>Bit 28</td>
<td><tt>MEM_SHARED</tt> - Shareable</td></tr>
<tr>
<td>Bit 29</td>
<td><tt>MEM_EXECUTE</tt> - Executable</td></tr>
<tr>
<td>Bit 30</td>
<td><tt>MEM_READ</tt> - Readable</td></tr>
<tr>
<td>Bit 41</td>
<td><tt>MEM_WRITE</tt> - Writable</td></tr>
</table>
</td></tr>
</table>
<h2>Section data</h1>
<p>RVA is an abbreviation of relative virtual address. It is relative to the image base.</p>
<h3>.debug section</h2>
<p>TODO</p>
<h3>.drectve section</h2>
<p>TODO</p>
<a id="edata"/>
<h3>Export (.edata) section</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>Flags, reserved</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>Date time stamp</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le</td>
<td>Major version</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i16le</td>
<td>Minor version</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32le</td>
<td>RVA of ASCII string of name of DLL</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32le</td>
<td>Starting ordinal number, typically 1</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32le</td>
<td>Number of <a href="#expadrtab">Export address table</a> entries</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32le</td>
<td>Number of entries in the <a href="#expnamptrtab">Export name pointer table</a> as well as the ordinal table</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32le</td>
<td>RVA of <a href="#expadrtab">Export address table</a></td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32le</td>
<td>RVA of <a href="#expnamptrtab">Export name pointer table</a></td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i32le</td>
<td>RVA of <a href="#expordtab">Export ordinal table</a></td></tr>
</table>
<a id="expadrtab"/>
<h4>Export address table</h3>
<p>A sequence of 32-bit RVA for the exported values. It is either the exported address, or a forwarder: a null-terminated ASCII string within the export table directory referencing another DLL entry, consisting of the DLL name, a '.' and either the name of the export, or '#' and the decimal value of the ordinal.</p>
<p>An export can be accessed by ordinal by providing the index into this table, relative to the starting ordinal number.</p>
<a id="expnamptrtab"/>
<h4>Export name pointer table</h3>
<p>A sequence of 32-bit RVA into the <a href="#expnamtab">Export name table</a>. The entries should be ordered lexically. A symbol imported by name will match this entry, and the associated ordinal entry in the export ordinal table provides the ordinal value for an entry in the <a href="#expadrtab">Export address table</a>.</p>
<a id="expordtab"/>
<h4>Export ordinal table</h3>
<p>A sequence of 16-bit ordinal values, referencing the <a href="#expadrtab">Export address table</a>, where each entry corresponds to the corresponding entry in the <a href="#expnamptrtab">Export name pointer table</a>.</p>
<a id="expnamtab"/>
<h4>Export name table</h3>
<p>A series of null-terminated ASCII strings, referenced by <a href="#expnamptrtab">Export name pointer table</a>.</p>
<a id="idata"/>
<h3>Import (.idata) section</h2>
<h4>Import directory table</h3>
<p>A sequence of entries for each imported DLL. It is closed by an entry of all zeros.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>RVA of <a href="#impluptab">Import lookup table</a> (also called Characteristic)</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>Datetime stamp</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32le</td>
<td>Index of first forwarder reference</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32le</td>
<td>RVA of ASCII string of the DLL name</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32le</td>
<td>RVA of <a href="#impadrtab">Import address table</a></td></tr>
</table>
<a id="impluptab"/>
<h4>Import lookup table</h3>
<p>A sequence of 32-bit or 64-bit entries. If the most significant bit (bit 31 or bit 63) is set, it provides a 16-bit ordinal import. Otherwise the low 31 bits provide the RVA of an entry in the <a href="#hinttab">Hint/name table</a>. The table is closed by a 0 value.</p>
<a id="hinttab"/>
<h4>Hint/name table</h3>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Index into <a href="#expnamptrtab">Export name pointer table</a> of the imported DLL. If it fails, lookup uses the name instead</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>c[*]</td>
<td>Null-terminated ASCII string of the imported name. An extra null byte is added to align to 2 bytes</td></tr>
</table>
<a id="impadrtab"/>
<h4>Import address table</h3>
<p>Identical in format and content to the <a href="#impluptab">Import lookup table</a>, but the values get replaced by the actual addresses when loaded into memory.</p>
<h3>.pdata section</h2>
<p>TODO</p>
<a id="reloc"/>
<h3>Base relocation table (.reloc) section</h2>
<p>Each 4 KiB page has an associated relocation block that starts on a 4-byte boundary, containing the addresses that should be relocated by the base address.</p>
<h4>Base relocation block</h3>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>RVA of the page</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>Size of block in bytes, including these two fields</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le[*]</td>
<td>
<table border='1'>
<tr>
<td>Bits 0:11</td>
<td>Offset from page start to the</td></tr>
<tr>
<td>Bits 12:15</td>
<td>Type of base relocation
<table border='1'>
<tr>
<td>0</td>
<td>Skipped</td></tr>
<tr>
<td>1</td>
<td>High 16 bits</td></tr>
<tr>
<td>2</td>
<td>Low 16 bits</td></tr>
<tr>
<td>3</td>
<td>32 bits</td></tr>
<tr>
<td>4</td>
<td>High 16 bits, followed by low 16 bits</td></tr>
<tr>
<td>5</td>
<td>MIPS jump instruction<br>ARM 32-bit MOVW/MOVT instruction pair<br>RISC-V high 20 bits</td></tr>
<tr>
<td>6</td>
<td>reserved</td></tr>
<tr>
<td>7</td>
<td>ARM Thumb 32-bit MOVW/MOVT instruction pair<br>RISC-V low 12-bit I-type format</td></tr>
<tr>
<td>8</td>
<td>RISC-V low 12-bit S-type format<br>LoongArch 32-bit consecutive 2 instructions<br>LoongArch 64-bit 4 consecutive instructions</td></tr>
<tr>
<td>9</td>
<td>MIPS16 jump instruction</td></tr>
<tr>
<td>10</td>
<td>64-bit</td></tr>
</table>
</td></tr>
</table>
</td></tr>
</table>
<h3>.tls section</h2>
<p>TODO</p>
<h3>Load configuration section</h2>
<p>TODO</p>
<a id="rsrc"/>
<h3>.rsrc section</h2>
<p>Resources are stored in a multi-level hierarchy. Windows uses 3 levels: type, name, language.</p>
<a id="resdirtab"/>
<h4>Resource directory table</h3>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>Flags, reserved</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>Datetime stamp</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32le</td>
<td>Major version</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i32le</td>
<td>Minor version</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i16le</td>
<td>Number of entries identified by strings</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32le</td>
<td>Number of entries identified by numbers</td></tr>
</table>
<p>This is then followed by the entries. First are the entries identified by strings, then the entries identified by numbers follow. All entries are stored lexicographically, then numerically.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>Offsets in the resource data directory to strings<br>Or 32-bit numbers</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>If the high bit is clear, the address of a resource data<br>If the high bit is set, the address of another resource directory</td></tr>
</table>
<h4>Resource directory strings</h3>
<p>A sequence of Unicode strings used in <a href="#resdirtab">Resource directory table</a>.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Length of the string</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>c16[*]</td>
<td>UTF-16 string</td></tr>
</table>
<h4>Resource data description</h3>
<p>Each resource has one entry.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>RVA of data</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>The size of the resource in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32le</td>
<td>Codepage</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32le</td>
<td>Reserved</td></tr>
</table>
<h4>Resource data</h3>
<h3>.cormeta section</h2>
<p>TODO</p>
<h3>.sxdata section</h2>
<p>TODO</p>
<a id="relocs"/>
<h2>COFF relocations</h1>
<p>Only present in object files.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>Virtual address, relative to the image base (COFF)</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>Symbol name<br>A 0-based index into the symbol table (COFF)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le</td>
<td>Type (COFF)</td></tr>
</table>
<p>Relocation types for AMD64:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le</td>
<td>Type (COFF)
<table border='1'>
<tr>
<td><tt><sub>x</sub>0001</tt></td>
<td>64-bit address</td></tr>
<tr>
<td><tt><sub>x</sub>0002</tt></td>
<td>32-bit address</td></tr>
<tr>
<td><tt><sub>x</sub>0003</tt></td>
<td>32-bit RVA address</td></tr>
<tr>
<td><tt><sub>x</sub>0004</tt></td>
<td>32-bit address relative from following byte</td></tr>
<tr>
<td><tt><sub>x</sub>0005</tt>-<tt><sub>x</sub>0009</tt></td>
<td>32-bit address relative from byte at distance 1-5</td></tr>
<tr>
<td><tt><sub>x</sub>000A</tt></td>
<td>16-bit section index</td></tr>
<tr>
<td><tt><sub>x</sub>000B</tt></td>
<td>32-bit offset from its section</td></tr>
<tr>
<td><tt><sub>x</sub>000C</tt></td>
<td>CLR token</td></tr>
<tr>
<td><tt><sub>x</sub>000D</tt></td>
<td>7-bit offset from its section</td></tr>
<tr>
<td><tt><sub>x</sub>000E</tt></td>
<td>32-bit signed span-dependent value</td></tr>
<tr>
<td><tt><sub>x</sub>000F</tt></td>
<td>pair following span-dependent value</td></tr>
<tr>
<td><tt><sub>x</sub>0010</tt></td>
<td>32-bit signed span-dependent value applied</td></tr>
</table>
</td></tr>
</table>
<p>Relocation types for Intel 386:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le</td>
<td>Type (COFF)
<table border='1'>
<tr>
<td><tt><sub>x</sub>0006</tt></td>
<td>32-bit address (COFF)</td></tr>
<tr>
<td><tt><sub>x</sub>0007</tt></td>
<td>32-bit RVA address</td></tr>
<tr>
<td><tt><sub>x</sub>000A</tt></td>
<td>16-bit section index</td></tr>
<tr>
<td><tt><sub>x</sub>000B</tt></td>
<td>32-bit offset from its section</td></tr>
<tr>
<td><tt><sub>x</sub>000C</tt></td>
<td>CLR token</td></tr>
<tr>
<td><tt><sub>x</sub>000D</tt></td>
<td>7-bit offset from its section</td></tr>
<tr>
<td><tt><sub>x</sub>0014</tt></td>
<td>32-bit relative displacement (COFF)</td></tr>
</table>
</td></tr>
</table>
<p>TODO: other systems</p>
<a id="linenos"/>
<h2>COFF line numbers</h1>
<p>These are deprecated.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>Symbol table index (if line number is 0) or virtual address</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>1-based line number<br>0 for symbol table index</td></tr>
</table>
<a id="symtab"/>
<h2>COFF symbol table</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[8]</td>
<td>Symbol name, zero-padded (first 4 bytes should not be all zero)</td></tr>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>If zero, the symbol is inlined</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>Offset to name in symbol table (only if first 4 bytes are zero)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32le</td>
<td>Value of symbol</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i16le</td>
<td>Section number, 1-based
<table border='1'>
<tr>
<td>0x0000</td>
<td>External/undefined symbol</td></tr>
<tr>
<td>0xFFFF</td>
<td>Absolute symbol</td></tr>
<tr>
<td>0xFFFE</td>
<td>Debugging symbol</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i16le</td>
<td>Symbol type: base type (Microsoft tools set this to <tt><sub>x</sub>00</tt> or <tt><sub>x</sub>20</tt>)
<table border='1'>
<tr>
<td><tt><sub>x</sub>0000</tt></td>
<td>No symbol</td></tr>
<tr>
<td><tt><sub>x</sub>0001</tt></td>
<td>void</td></tr>
<tr>
<td><tt><sub>x</sub>0002</tt></td>
<td>char, int8</td></tr>
<tr>
<td><tt><sub>x</sub>0003</tt></td>
<td>short int, int16</td></tr>
<tr>
<td><tt><sub>x</sub>0004</tt></td>
<td>int</td></tr>
<tr>
<td><tt><sub>x</sub>0005</tt></td>
<td>long int, int32</td></tr>
<tr>
<td><tt><sub>x</sub>0006</tt></td>
<td>float</td></tr>
<tr>
<td><tt><sub>x</sub>0007</tt></td>
<td>double</td></tr>
<tr>
<td><tt><sub>x</sub>0008</tt></td>
<td>struct ...</td></tr>
<tr>
<td><tt><sub>x</sub>0009</tt></td>
<td>union ...</td></tr>
<tr>
<td><tt><sub>x</sub>000A</tt></td>
<td>enum ...</td></tr>
<tr>
<td><tt><sub>x</sub>000B</tt></td>
<td>Member in enumeration</td></tr>
<tr>
<td><tt><sub>x</sub>000C</tt></td>
<td>unsigned char, uint8</td></tr>
<tr>
<td><tt><sub>x</sub>000D</tt></td>
<td>unsigned short int, uint16</td></tr>
<tr>
<td><tt><sub>x</sub>000E</tt></td>
<td>unsigned int</td></tr>
<tr>
<td><tt><sub>x</sub>000F</tt></td>
<td>unsigned long int, uint32</td></tr>
<tr>
<td><tt><sub>x</sub>0010</tt></td>
<td>Pointer</td></tr>
<tr>
<td><tt><sub>x</sub>0020</tt></td>
<td>Function</td></tr>
<tr>
<td><tt><sub>x</sub>0030</tt></td>
<td>Array</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i8</td>
<td>Storage class, only certain values are used
<table border='1'>
<tr>
<td><tt><sub>x</sub>00</tt></td>
<td>No entry</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>
<td>Automatic</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>
<td>External/public (used)</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>
<td>Static/private (used)</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>
<td>External definition (TODO: swapped from COFF?)</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>
<td>Register (TODO: swapped from COFF?)</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>
<td>Label</td></tr>
<tr>
<td><tt><sub>x</sub>07</tt></td>
<td>Undefined label</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>
<td>Member of structure</td></tr>
<tr>
<td><tt><sub>x</sub>09</tt></td>
<td>Function argument</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>
<td>Structure tag</td></tr>
<tr>
<td><tt><sub>x</sub>0B</tt></td>
<td>Member of union</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>
<td>Union tag</td></tr>
<tr>
<td><tt><sub>x</sub>0D</tt></td>
<td>Type definition</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>
<td>Undefined static</td></tr>
<tr>
<td><tt><sub>x</sub>0F</tt></td>
<td>Enumeration tag</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>
<td>Member of enumeration</td></tr>
<tr>
<td><tt><sub>x</sub>11</tt></td>
<td>Register parameter</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>
<td>Bitfield</td></tr>
<tr>
<td><tt><sub>x</sub>64</tt></td>
<td>Beginning/end of block (.bb, .eb)</td></tr>
<tr>
<td><tt><sub>x</sub>65</tt></td>
<td>Beginning/end of function (.bf, .ef) (used)</td></tr>
<tr>
<td><tt><sub>x</sub>66</tt></td>
<td>End of structure</td></tr>
<tr>
<td><tt><sub>x</sub>67</tt></td>
<td>File name (used)</td></tr>
<tr>
<td><tt><sub>x</sub>68</tt></td>
<td>Section defintion</td></tr>
<tr>
<td><tt><sub>x</sub>69</tt></td>
<td>Weak external</td></tr>
<tr>
<td><tt><sub>x</sub>6B</tt></td>
<td>CLR token symbol</td></tr>
<tr>
<td><tt><sub>x</sub>FF</tt></td>
<td>Physical end of function</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>11</tt></td>	<td>i8</td>
<td>Number of auxiliary entries, each entry occupying a symbol record</td></tr>
</table>
<h2>Auxiliary symbols</h1>
<p>TODO</p>
<h2>COMDAT sections</h1>
<p>Object only.</p>
<p>TODO</p>
<h2>CLR token definition</h1>
<p>Object only.</p>
<p>TODO</p>
<h2>COFF string table</h1>
<p>Object only.</p>
<p>TODO</p>
<h2>Attribute certificate table</h1>
<p>Image only.</p>
<p>TODO</p>
<h2>Delay-load import tables</h1>
<p>Image only.</p>
<p>TODO</p>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="https://www.x-ways.net/winhex/kb/ff/PE_EXE.pdf" target='_blank'>Tool Interface Standard (TIS) Formats Specification for Windows TM, Version 1.0, 1993-02</a></li>
<li>[2] <a href="http://www.skyfree.org/linux/references/coff.pdf" target='_blank'>Microsoft Portable Executable and Common Object File Format Specification, Revision 6.0, 1999-02</a></li>
<li>[3] <a href="https://github.com/kazzmir/decompiler/blob/master/disassembler/pecoff_v8.pdf" target='_blank'>Microsoft Portable Executable and Common Object File Format Specification, Revision 8.1, 2008-02-15</a></li>
<li>[4] <a href="https://learn.microsoft.com/en-us/previous-versions/ms809762(v=msdn.10)?redirectedfrom=MSDN" target='_blank'>Peering Inside the PE: A Tour of the Win32 Portable Executable File Format, 2010-06-30</a></li>
<li>[5] <a href="https://learn.microsoft.com/en-us/windows/win32/debug/pe-format" target='_blank'>PE Format - Microsoft</a></li>
<li>[6] UNIX file magic numbers</li>
</ul>
<hr/>
<h1 id="mp">MP/MQ executable </h1>
<dl>
<dt>File extensions</td>
<dd><tt>.exp</tt>, <tt>.exe</tt> with MZ stub, <tt>.rex</tt> with relocations</dd>
<dl>
<dt>Magic code</td>
<dd><tt>"MP"</tt>, <tt>"MQ"</tt> with relocations</dd>
<dl>
<dt>Architecture</td>
<dd>Intel 80386</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>1986-08: Phar Lap 386|DOS-Extender</li>
<li>?: FM Towns OS</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>Intel 80386</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#stub">Executable stub and loader</a>
</li>
<li><a href="#header">Header</a>
</li>
<li><a href="#relocs">Relocations</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<p>This format comes in two modes: load modules '.exp' and relocatable load modules '.rex'. An '.exp' load module consists of a header and the following image data. A '.rex' module is similar but it is followed by relocations.</p>
<p>The '.exp' or '.rex' file can also be combined with an MS-DOS stub into an '.exe' file that loads the image following the MZ structure. The Win386 does the same but it combines a '.rex' module with a Windows based loader (one that also comes with its own MS-DOS stub).</p>
<table border='1' align='center'>
<tr>
<td><a href="#stub">Executable stub and loader</a></td></tr>
<tr>
<td><a href="#header">Header</a> (including <a href="#relocs">Relocations</a> for MQ)</td></tr>
<tr>
<td>Image</td></tr>
</table>
<a id="stub"/>
<h2>Executable stub and loader</h1>
<p>When embedded inside a DOS .exe file, an additional entry in the header is used to store the start of the load module.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>3C</tt></td>	<td>i32le</td>
<td>Offset to <a href="#header">Header</a> from file start in bytes</td></tr>
</table>
<p>For executables using the Win386 Windows extender, that field is already used for the 'NE' header, which will load the executable into memory from Windows. Instead, the previous field is used:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>38</tt></td>	<td>i32le</td>
<td>Offset to <a href="#header">Header</a> from file start in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>3C</tt></td>	<td>i32le</td>
<td>Offset to the NE header for the Win386 extender</td></tr>
</table>
<a id="header"/>
<h2>Header</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[2]</td>
<td>'MP' for a regular module or 'MQ' for a relocatable module</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Number of bytes in the last 512 byte page, or 0 if the entire page is used</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Number of 512 byte pages in load module, rounded up</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>Number of relocations, should be 0 for an 'MP' file</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le</td>
<td>Size of this header in 16 bytes paragraphs</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i16le</td>
<td>Required minimum additional memory in 4KiB pages</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i16le</td>
<td>Required maximum additional memory in 4KiB pages, <tt><sub>x</sub>FFFF</tt> means all memory<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i32le</td>
<td>Initial value of ESP (stack)</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i16le</td>
<td>Checksum, the sum of all 16-bit words in the file should be zero. Alternatively, it is the negation of the modular sum of all 16-bit words except this one<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32le</td>
<td>Initial value of EIP (entry)</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i16le</td>
<td>Offset of first relocation from '.exp' module, should be <tt><sub>x</sub>1E</tt><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>1A</tt></td>	<td>i16le</td>
<td>Overlay number, should be 0<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i16le</td>
<td>=<tt><sub>x</sub>0001</tt><a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a></td></tr>
</table>
<a id="relocs"/>
<h2>Relocations</h1>
<p>A sequence of i32le offsets from the image start that should be relocated. They contain addresses the base of the image should be added to.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>
<table border='1'>
<tr>
<td>Bits 0:30</td>
<td>Address of value to be relocated</td></tr>
<tr>
<td>Bit 31</td>
<td>
<table border='1'>
<tr>
<td>0</td>
<td>32-bit value</td></tr>
<tr>
<td>1</td>
<td>16-bit value<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
</table>
</td></tr>
</table>
</td></tr>
</table>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="https://archive.org/details/386-link/mode/2up" target='_blank'>386|LINK Reference Manual</a></li>
<li>[2] <a href="http://www.ctyme.com/intr/rb-2939.htm" target='_blank'>Ralf Brown's interrupt list (Int 21/AH=4Bh)</a></li>
<li>[3] <a href="https://github.com/open-watcom/open-watcom-v2" target='_blank'>OpenWatcom sources</a></li>
</ul>
<hr/>
<h1 id="bw">BW executable</h1>
<dl>
<dt>File extensions</td>
<dd><tt>.exp</tt>, <tt>.exe</tt> with MZ stub</dd>
<dl>
<dt>Magic code</td>
<dd><tt>"BW"</tt></dd>
<dl>
<dt>Architecture</td>
<dd>Intel 80286</dd>
<dl>
<dt>Operating systems</td>
<dd>1987-07: Rational Systems DOS/16M DOS extender</dd>
</dl>
<dl>
<dt>Influences</td>
<dd>Intel 80286</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#stub">Executable stub and loader</a>
</li>
<li><a href="#modhdr">Module Header</a>
<ol>
<li><a href="#dosbwhdr">DOS-style 'BW' header</a>
</li>
<li><a href="#bwaddhdr">Additional fields in header</a>
</li>
<li><a href="#">GDT image</a>
<ol>
<li><a href="#gdthdr">Additional fields, inside GDT image</a>
</li>
<li><a href="#">Old run-time selectors</a>
</li>
<li><a href="#gdtdata">GDT data</a>
</li>
</ol></li>
</ol></li>
<li><a href="#relocdata">Relocation data</a>
<ol>
<li><a href="#">RSI-1</a>
</li>
<li><a href="#">RSI-2</a>
</ol></li>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<p>An '.exp' load module consists of a header and the following segment data. It can appear on its own, or multiple modules can be spliced together, with an MZ stub attached.</p>
<p>Information is organized around the concept of a global descriptor table (GDT), as used on the Intel 80286 CPU. Every part of the program is accessed in one of several segments. The physical address, size and access permissions for these segments are stored in a system structure called the GDT. Segments are addressed as 16-bit values, incremented by a value of 8, as an index into the GDT. The BW file format exposes this architecture to a high degree.</p>
<p>The actual module header structure can be further subdivided into multiple parts.</p>
<table border='1' align='center'>
<tr>
<td><a href="#stub">Executable stub and loader</a></td></tr>
<tr>
<td><a href="#dosbwhdr">DOS-style 'BW' header</a></td></tr>
<tr>
<td><a href="#bwaddhdr">Additional fields in header</a></td></tr>
<tr>
<td><a href="#gdthdr">Additional fields, inside GDT image</a></td></tr>
<tr>
<td><a href="#gdtdata">GDT data</a></td></tr>
<tr>
<td>Segment data</td></tr>
<tr>
<td><a href="#relocdata">Relocation data</a></td></tr>
<tr>
<td><a href="#dosbwhdr">DOS-style 'BW' header</a> for .exp file 2</td></tr>
</table>
<p>Relocations can come in two formats: RSI-1 or RSI-2.</p>
<a id="stub"/>
<h2>Executable stub and loader</h1>
<p>When embedded inside a DOS .exe file, an additional entry in the header is used to store the start of the load module.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>3C</tt></td>	<td>i32le</td>
<td>Offset to <a href="#modhdr">Module Header</a> from file start in bytes</td></tr>
</table>
<a id="modhdr"/>
<h2>Module Header</h1>
<p>The module header consists of a block of header fields, followed by a GDT image. The block of header fields starts with a set of fields similar to those in the MZ header, followed by a few more specific to the DOS/16M extender. The GDT image also contains several header fields, however addressing GDT entries starts at that address, so they are separated out.</p>
<a id="dosbwhdr"/>
<h3>DOS-style 'BW' header</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[2]</td>
<td>'BW', signature that identifies it as a DOS/16M load module</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Number of bytes in the last 512 byte page, or 0 if the entire page is used</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Number of 512 byte pages in load module, rounded down<a href="#CD"><sup title="PMODE.H (1990-10-16), DOS16.H (1990-10-05) - USD-III sources">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le[2]</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i16le</td>
<td>Required minimum additional memory in KiB</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i16le</td>
<td>Required maximum additional memory in KiB (implies private allocation)</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i16le</td>
<td>Initial SS (stack segment)</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i16le</td>
<td>Initial SP (stack)</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i16le</td>
<td>For RSI-2, the selector for the first relocation (huge relocation list)</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i16le</td>
<td>Initial IP (entry)</td></tr>
<tr>
<td><tt><sub>x</sub>16</tt></td>	<td>i16le</td>
<td>Initial CS (segment of entry)</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i16le</td>
<td>Size of the GDT (global descriptor table) at runtime in bytes - 1</td></tr>
<tr>
<td><tt><sub>x</sub>1A</tt></td>	<td>i16le</td>
<td>Version of the tool that created the file<br>MAKEPM: major version * 100 + minor version<br>GLU<a href="#OW"><sup title="OpenWatcom sources">[1]</sup></a>: major version * 1000 + minor version (Watcom pretends to be GLU version 2.0)<br>GLU<a href="#CD"><sup title="PMODE.H (1990-10-16), DOS16.H (1990-10-05) - USD-III sources">[2]</sup></a>: (major version + 10) * 100 + minor version</td></tr>
</table>
<a id="bwaddhdr"/>
<h3>Additional fields in header</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32le</td>
<td>Position of next spliced .exp entry from start of file<br>Also end pointer to current load module</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32le</td>
<td>Offset to start of CodeView<a href="#CD"><sup title="PMODE.H (1990-10-16), DOS16.H (1990-10-05) - USD-III sources">[2]</sup></a> debug info (TODO: not sure where it is stored inside the file)</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i16le</td>
<td>Last used selector value in GDT image<br>0 means the last used value can be derived from the size of the GDT image<br>(TODO: Watcom drops the last entry in the table)</td></tr>
<tr>
<td><tt><sub>x</sub>26</tt></td>	<td>i16le</td>
<td>Private memory allocation in KiB<a href="#OW"><sup title="OpenWatcom sources">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i16le</td>
<td>Allocation increment (<tt>ExtReserve</tt>) in KiB<a href="#OW"><sup title="OpenWatcom sources">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>2A</tt></td>	<td>c[6]</td>
<td>Reserved</td></tr>
</table>
<h3>GDT image</h2>
<p>The first few GDT entries are overwritten by some additional header fields.</p>
<a id="gdthdr"/>
<h4>Additional fields, inside GDT image</h3>
<p>Selector #0 (<tt><sub>x</sub>00</tt>)</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>30</tt></td>	<td>i16le</td>
<td>Runtime options<a href="#OW"><sup title="OpenWatcom sources">[1]</sup></a>, switch control<a href="#CD"><sup title="PMODE.H (1990-10-16), DOS16.H (1990-10-05) - USD-III sources">[2]</sup></a>
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Force A20 line to 0 in 80386 real mode<a href="#CD"><sup title="PMODE.H (1990-10-16), DOS16.H (1990-10-05) - USD-III sources">[2]</sup></a></td></tr>
<tr>
<td>Bit 1</td>
<td>Do not test for VCPI at startup<a href="#OW"><sup title="OpenWatcom sources">[1]</sup></a></td></tr>
<tr>
<td>Bit 2</td>
<td>Do not defer BIOS INT 16h function 1<a href="#CD"><sup title="PMODE.H (1990-10-16), DOS16.H (1990-10-05) - USD-III sources">[2]</sup></a><br>Do not inhibit keyboard polling<a href="#OW"><sup title="OpenWatcom sources">[1]</sup></a></td></tr>
<tr>
<td>Bit 3</td>
<td>Allow overloading<a href="#OW"><sup title="OpenWatcom sources">[1]</sup></a></td></tr>
<tr>
<td>Bit 4</td>
<td><tt>OPT_INT10</tt> - ?<a href="#OW"><sup title="OpenWatcom sources">[1]</sup></a></td></tr>
<tr>
<td>Bit 5</td>
<td>Initialize newly allocated memory to <tt><sub>x</sub>00</tt></td></tr>
<tr>
<td>Bit 6</td>
<td>Initialize newly allocated memory to <tt><sub>x</sub>FF</tt></td></tr>
<tr>
<td>Bit 7</td>
<td>Rotate selector assignment<a href="#OW"><sup title="OpenWatcom sources">[1]</sup></a>, do not reuse selectors immediately after cancelling<a href="#CD"><sup title="PMODE.H (1990-10-16), DOS16.H (1990-10-05) - USD-III sources">[2]</sup></a></td></tr>
<tr>
<td>Bit 12</td>
<td>Relocation table is present, must be set to make relocatable<a href="#OW"><sup title="OpenWatcom sources">[1]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>32</tt></td>	<td>i16le</td>
<td>Selector of transparent stack (obsolete<a href="#CD"><sup title="PMODE.H (1990-10-16), DOS16.H (1990-10-05) - USD-III sources">[2]</sup></a>)</td></tr>
<tr>
<td><tt><sub>x</sub>34</tt></td>	<td>i16le</td>
<td>Module flags
<table border='1'>
<tr>
<td>Bit 0</td>
<td><tt>ef_auto</tt> - Automatic selectors, module is relocatable</td></tr>
<tr>
<td>Bit 1</td>
<td><tt>ef_package</tt> - Module is an .exp package</td></tr>
<tr>
<td>Bit 2</td>
<td><tt>ef_nobigfoot</tt> - Do not place stack in low DPMI memory<a href="#OW"><sup title="OpenWatcom sources">[1]</sup></a></td></tr>
<tr>
<td>Bit 13</td>
<td><tt>ef_sharedata</tt> - Data is global, not per-instance<a href="#OW"><sup title="OpenWatcom sources">[1]</sup></a></td></tr>
<tr>
<td>Bit 14</td>
<td><tt>ef_shareable</tt> - Component may be shared<a href="#OW"><sup title="OpenWatcom sources">[1]</sup></a></td></tr>
<tr>
<td>Bit 15</td>
<td><tt>ef_dos4g</tt> - Module requires DOS/4G<a href="#OW"><sup title="OpenWatcom sources">[1]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>36</tt></td>	<td>i16le</td>
<td>Size of program in 16 byte paragraphs (obsolete<a href="#CD"><sup title="PMODE.H (1990-10-16), DOS16.H (1990-10-05) - USD-III sources">[2]</sup></a>)</td></tr>
</table>
<p>Selector #1 (<tt><sub>x</sub>08</tt>)</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>38</tt></td>	<td>i16le</td>
<td>Size of GDT in file, in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>3A</tt></td>	<td>i16le</td>
<td>First used selector, first selector actually containing data<br>0 means <tt><sub>x</sub>80</tt> (selector #16)<br>The first selector is always stored at offset <tt><sub>x</sub>B0</tt><a href="#OWN"><sup title="own research">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>3C</tt></td>	<td>i8</td>
<td>Default memory strategy
<table border='1'>
<tr>
<td>0x00</td>
<td><tt>MPreferExt</tt> - Prefer extended memory<br>No strategy specified</td></tr>
<tr>
<td>0x01</td>
<td><tt>MPreferLow</tt> - Prefer conventional memory</td></tr>
<tr>
<td>0x02</td>
<td><tt>MForceExt</tt> - Requires extended memory</td></tr>
<tr>
<td>0x03</td>
<td><tt>MForceLow</tt> - Requires conventional memory</td></tr>
<tr>
<td>0x04</td>
<td><tt>MTransparent</tt> - Requires conventional memory, allocate selectors for transparent addressing<a href="#CD"><sup title="PMODE.H (1990-10-16), DOS16.H (1990-10-05) - USD-III sources">[2]</sup></a></td></tr>
<tr>
<td>0x05</td>
<td><tt>MTransStack</tt> - Transparent, aligned for use as stack<a href="#CD"><sup title="PMODE.H (1990-10-16), DOS16.H (1990-10-05) - USD-III sources">[2]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>3D</tt></td>	<td>i8</td>
<td>Reserved, <tt><sub>x</sub>92</tt> (usually)</td></tr>
<tr>
<td><tt><sub>x</sub>3E</tt></td>	<td>i16le</td>
<td>Size of transfer buffer in bytes, 0 means 8 KiB</td></tr>
</table>
<p>Selectors #2-#7 (<tt><sub>x</sub>10</tt>-<tt><sub>x</sub>38</tt>)</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>40</tt></td>	<td>i32le</td>
<td>Load module length (according to Watcom, not reflected in actual files)</td></tr>
<tr>
<td><tt><sub>x</sub>44</tt></td>	<td>c[0x2C]</td>
<td>-</td></tr>
</table>
<p>Selectors #8-#15 (<tt><sub>x</sub>40</tt>-<tt><sub>x</sub>78</tt>)</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>70</tt></td>	<td>c[0x20]</td>
<td>Original .EXP file name</td></tr>
</table>
<h4>Old run-time selectors</h3>
<p>At run-time, the first few selectors were originally used by DOS/16M to refer to various system structures.<a href="#CD"><sup title="PMODE.H (1990-10-16), DOS16.H (1990-10-05) - USD-III sources">[2]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Null selector (CPU enforced)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le</td>
<td>Selector to access GDT (or LDT)</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i16le</td>
<td>Selector to access IDT</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i16le</td>
<td>Kernel code</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i16le</td>
<td>Kernel data</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i16le</td>
<td>MS-DOS program segment prefix</td></tr>
<tr>
<td><tt><sub>x</sub>30</tt></td>	<td>i16le</td>
<td>MS-DOS environment</td></tr>
<tr>
<td><tt><sub>x</sub>38</tt></td>	<td>i16le</td>
<td>Physical memory address 0</td></tr>
<tr>
<td><tt><sub>x</sub>40</tt></td>	<td>i16le</td>
<td>BIOS data</td></tr>
<tr>
<td><tt><sub>x</sub>48</tt></td>	<td>i16le</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>50</tt></td>	<td>i16le</td>
<td>GDT auxiliary information segment</td></tr>
<tr>
<td><tt><sub>x</sub>58</tt></td>	<td>i16le</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>60</tt></td>	<td>i16le</td>
<td>Scratch descriptor for debugging</td></tr>
<tr>
<td><tt><sub>x</sub>68</tt></td>	<td>i16le</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>70</tt></td>	<td>i16le</td>
<td>Kernel code in extended memory</td></tr>
<tr>
<td><tt><sub>x</sub>78</tt></td>	<td>i16le</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>80</tt></td>	<td>i16le</td>
<td>First user-mode selector</td></tr>
</table>
<a id="gdtdata"/>
<h4>GDT data</h3>
<p>The actual GDT data typically starts at selector #16 (offset <tt><sub>x</sub>B0</tt>). It is a sequence of structures similar to entries in an Intel 80286 GDT.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Size of segment as stored in file - 1<br>0 means empty<br>Watcom generates 16 byte paragraph aligned values</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i24le</td>
<td>Address of segment in 16-byte paragraphs<a href="#OWN"><sup title="own research">[3]</sup></a>, optional field, typically 0</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i8</td>
<td>Access bits
<table border='1'>
<tr>
<td>Bit 1</td>
<td>For code segments, set if readable<br>For data segments, set if writable (always readable)</td></tr>
<tr>
<td>Bit 3</td>
<td>
<table border='1'>
<tr>
<td>0</td>
<td>Data segment</td></tr>
<tr>
<td>1</td>
<td>Code segment</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 4</td>
<td>1</td></tr>
<tr>
<td>Bits 5:6</td>
<td>Descriptor privilege level (0 for system/highest privilege, 3 for user mode/lowest)</td></tr>
<tr>
<td>Bit 7</td>
<td>1</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>
<table border='1'>
<tr>
<td>Bits 0:12</td>
<td>Required memory size in 16 byte paragraphs, maximum of <tt><sub>x</sub>10000</tt> allowed</td></tr>
<tr>
<td>Bit 13</td>
<td>If set, segment is empty, no file data or memory allocated</td></tr>
<tr>
<td>Bit 15</td>
<td>If set, marks a transparent stack</td></tr>
</table>
</td></tr>
</table>
<a id="relocdata"/>
<h2>Relocation data</h1>
<p>Relocation data is stored in segments, following the image segments. No image data comes after the relocations.</p>
<p>Each relocation specifies a selector and offset that must be relocated. The data to be relocated contains a selector that will be modified according to what the actual loaded selector values are.</p>
<h3>RSI-1</h2>
<p>The last two segments contain the relocations. The first of these two segments contains the selector values, the second one the offset values. Each relocation position is specified by the corresponding selector and offset values at the same position in the two segments.</p>
<p>The list is terminated when the segment data terminates, or when both the selector and offset values are 0.</p>
<p>Note that this gives a limit of 32768 relocations.</p>
<h3>RSI-2</h2>
<p>The last several segments contain the relocations. Relocations are provided as a sequence of variable length structures of the following form:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Selector values of addresses needed to be relocated
<table border='1'>
<tr>
<td>Bit 1</td>
<td>Set if this is the last relocation required</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Number of offsets corresponding to this selector value</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le[*]</td>
<td>Sequence of offsets that need relocation within this segment</td></tr>
</table>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="https://github.com/open-watcom/open-watcom-v2" target='_blank'>OpenWatcom sources</a></li>
<li>[2] <a href="ftp://59.125.31.221/CD-ROM%20From%20MICROTEK/Cd-rom2/Sw/USD-III.220/SOURCE/" target='_blank'>PMODE.H (1990-10-16), DOS16.H (1990-10-05) - USD-III sources</a></li>
<li>[3] own research</li>
</ul>
<hr/>
<h1 id="xp">XP executable</h1>
<dl>
<dt>File extensions</td>
<dd><tt>.exp</tt>, <tt>.exe</tt> with MZ stub</dd>
<dl>
<dt>Magic code</td>
<dd><tt>"XP"</tt> for Intel 80286, unknown for Intel 80386</dd>
<dl>
<dt>Architecture</td>
<dd>Intel 80286, Intel 80386</dd>
<dl>
<dt>Operating systems</td>
<dd>1988: Ergo OS/286, probably Ergo OS/386 as well</dd>
</dl>
<dl>
<dt>Influences</td>
<dd>Intel 80286, Intel 80386</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#header">Header</a>
</li>
<li><a href="#desctab">Segment Table</a>
</li>
<li><a href="#">Needing more information</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<p>Much of the format is deduced through reverse engineering.</p>
<p>The file consists of a header, a segment table, followed by the binary image.</p>
<table border='1' align='center'>
<tr>
<td><a href="#header">Header</a></td></tr>
<tr>
<td><a href="#desctab">Segment Table</a>, part of the header</td></tr>
<tr>
<td>Binary image</td></tr>
<tr>
<td>Relocations?</td></tr>
</table>
<a id="header"/>
<h2>Header</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[4]</td>
<td><tt>'XP\1\0'</tt></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>Offset to segment table base, typically <tt><sub>x</sub>68</tt></td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32le</td>
<td>Number of entries in segment table</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32le</td>
<td>Offset to image, typically directly following header</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32le</td>
<td>Image size in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32le</td>
<td>Offset to fixups (probably)</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32le</td>
<td>Number of fixup entries (format unknown)</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32le</td>
<td>Minimum extent (unknown)</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32le</td>
<td>Maximum extent (unknown)</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i32le</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i32le</td>
<td>GS (16-bit register stored in a 32-bit field)</td></tr>
<tr>
<td><tt><sub>x</sub>2C</tt></td>	<td>i32le</td>
<td>FS</td></tr>
<tr>
<td><tt><sub>x</sub>30</tt></td>	<td>i32le</td>
<td>DS</td></tr>
<tr>
<td><tt><sub>x</sub>34</tt></td>	<td>i32le</td>
<td>SS</td></tr>
<tr>
<td><tt><sub>x</sub>38</tt></td>	<td>i32le</td>
<td>CS</td></tr>
<tr>
<td><tt><sub>x</sub>3C</tt></td>	<td>i32le</td>
<td>ES</td></tr>
<tr>
<td><tt><sub>x</sub>40</tt></td>	<td>i32le</td>
<td>EDI</td></tr>
<tr>
<td><tt><sub>x</sub>44</tt></td>	<td>i32le</td>
<td>ESI</td></tr>
<tr>
<td><tt><sub>x</sub>48</tt></td>	<td>i32le</td>
<td>EBP</td></tr>
<tr>
<td><tt><sub>x</sub>4C</tt></td>	<td>i32le</td>
<td>ESP</td></tr>
<tr>
<td><tt><sub>x</sub>50</tt></td>	<td>i32le</td>
<td>EBX</td></tr>
<tr>
<td><tt><sub>x</sub>54</tt></td>	<td>i32le</td>
<td>EDX</td></tr>
<tr>
<td><tt><sub>x</sub>58</tt></td>	<td>i32le</td>
<td>ECX</td></tr>
<tr>
<td><tt><sub>x</sub>5C</tt></td>	<td>i32le</td>
<td>EAX</td></tr>
<tr>
<td><tt><sub>x</sub>60</tt></td>	<td>i32le</td>
<td>EFLAGS</td></tr>
<tr>
<td><tt><sub>x</sub>64</tt></td>	<td>i32le</td>
<td>EIP</td></tr>
</table>
<a id="desctab"/>
<h2>Segment Table</h1>
<p>The segment table typically follows the header. Each entry has a structure very similar to an Intel 80386 segment descriptor inside an LDT.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Limit or size of segment - 1, least significant 2 bytes</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i24le</td>
<td>Base, relative to image base + <tt><sub>x</sub>100</tt>, least significant 3 bytes</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i8</td>
<td>Attributes (seems to only recognize segment descriptors)
<table border='1'>
<tr>
<td>Bit 0</td>
<td>=0</td></tr>
<tr>
<td>Bit 1</td>
<td>=1</td></tr>
<tr>
<td>Bit 2</td>
<td>=0</td></tr>
<tr>
<td>Bit 3</td>
<td>
<table border='1'>
<tr>
<td>0</td>
<td>Data segment</td></tr>
<tr>
<td>1</td>
<td>Code segment</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 4</td>
<td>=1</td></tr>
<tr>
<td>Bit 5-6</td>
<td>DPL, typically 3</td></tr>
<tr>
<td>Bit 7</td>
<td>=1</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i8</td>
<td>Attributes
<table border='1'>
<tr>
<td>Bits 0-3: limit, most significant 1 byte</td>
<td></td></tr>
<tr>
<td>Bits 4: selector is alias (must not be set together with window)</td>
<td></td></tr>
<tr>
<td>Bits 5: selector is window (must not be set together with alias)</td>
<td></td></tr>
<tr>
<td>Bits 6: 32-bit (as for 386)</td>
<td></td></tr>
<tr>
<td>Bits 7: limit is given in pages instead of bytes (as for 386)</td>
<td></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>07</tt></td>	<td>i8</td>
<td>Base, most significant 1 byte</td></tr>
</table>
<p>The <tt>EXPRESS</tt> command seemingly generates pairs of data and an optional code segment. The first segment is supposed to correspond to the PSP.</p>
<h2>Needing more information</h1>
<p>The format of the fixups is currently not known. The meaning of extents is not understood. There may be additional unknown flags or entries. The runtime layout is not known. It is also not known if OS/386 uses the same file format, however based on the structure of the file, whether an executable is 16-bit or 32-bit can be determined from the segment table.</p>
<a id="_references"/>
<h2>References</h1>
<ul>
</ul>
<hr/>
<h1 id="p3">P2/P3 executable</h1>
<dl>
<dt>File extensions</td>
<dd><tt>.exp</tt>, <tt>.exe</tt> with MZ stub</dd>
<dl>
<dt>Magic code</td>
<dd><tt>"P2"</tt> for Intel 80286, <tt>P3</tt> for Intel 80386</dd>
<dl>
<dt>Architecture</td>
<dd>Intel 80286, Intel 80386</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>?: Phar Lap 386|DOS-Extender</li>
<li>1991: FM Towns OS</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>Intel 80286, Intel 80386</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
<ol>
<li><a href="#">Flat model</a>
</li>
<li><a href="#">Multi-segmented model</a>
</li>
</ol></li>
<li><a href="#header">Header</a>
</li>
<li><a href="#seginftab">Segment Information Table</a>
</li>
<li><a href="#relocs">Relocation Table</a>
</li>
<li><a href="#rtpb">Run-time Parameter Block</a>
</li>
<li><a href="#symtab">Symbol Table</a>
<ol>
<li><a href="#symtabhdr">Symbol Table Header</a>
</li>
<li><a href="#segsymtab">Segment Symbol Table</a>
</li>
<li><a href="#pubsymtab">Public Symbol Table</a>
</li>
</ol></li>
<li><a href="#tss">Intel Task State Segment</a>
<ol>
<li><a href="#">16-bit Task State Segment</a>
</li>
<li><a href="#">32-bit Task State Segment</a>
</li>
</ol></li>
<li><a href="#">Descriptor Tables</a>
<ol>
<li><a href="#gdt">Intel Global Descriptor Table</a>
</li>
<li><a href="#idt">Intel Interrupt Descriptor Table</a>
</li>
<li><a href="#ldt">Intel Local Descriptor Table</a>
</li>
</ol></li>
<li><a href="#debinfo">Borland Debug Information</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<p>This format comes in two models: flat model and multi-segmented model.</p>
<p>The '.exp' file can also be combined with an MS-DOS stub into an '.exe' file that loads the image following the MZ structure.</p>
<h3>Flat model</h2>
<p>The program consists of a header, followed by the run-time parameter block, an optional symbol table and the program image. (TODO: not sure about the position of the symbol table)</p>
<table border='1' align='center'>
<tr>
<td><a href="#header">Header</a></td></tr>
<tr>
<td><a href="#rtpb">Run-time Parameter Block</a></td></tr>
<tr>
<td><a href="#symtab">Symbol Table</a></td></tr>
<tr>
<td>Program image</td></tr>
<tr>
<td><a href="#debinfo">Borland Debug Information</a> (optional)</td></tr>
</table>
<h3>Multi-segmented model</h2>
<p>The program consists of a header, followed by the segment information table, relocations, run-time parameter block, an optional symbol table and the program image.<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a> (TODO: not sure about the position of the symbol table)</p>
<p>The program image consists of multiple segment images. It also contains some low level Intel 80286/80386 specific entries such as the task state segment and descriptor tables.</p>
<table border='1' align='center'>
<tr>
<td><a href="#header">Header</a></td></tr>
<tr>
<td><a href="#seginftab">Segment Information Table</a></td></tr>
<tr>
<td><a href="#relocs">Relocation Table</a></td></tr>
<tr>
<td><a href="#rtpb">Run-time Parameter Block</a></td></tr>
<tr>
<td><a href="#symtab">Symbol Table</a></td></tr>
<tr>
<td><a href="#tss">Intel Task State Segment</a> in program image</td></tr>
<tr>
<td><a href="#gdt">Intel Global Descriptor Table</a> in program image</td></tr>
<tr>
<td><a href="#idt">Intel Interrupt Descriptor Table</a> in program image</td></tr>
<tr>
<td><a href="#ldt">Intel Local Descriptor Table</a> in program image</td></tr>
<tr>
<td>Code and data segments in program image</td></tr>
<tr>
<td><a href="#debinfo">Borland Debug Information</a> (optional)</td></tr>
</table>
<p>A 16-bit (<tt>P2</tt>) file could typically be segmented, with relocations, a runtime parameter block and an LDT, but no segment information table, TSS, GDT or IDT. The Watcom compiler can also generate 32-bit (<tt>P3</tt>) segmented files, complete with a segment-information table, TSS, GDT, an 8-byte long IDT and an LDT, with code/data segments being stored in the LDT, while the TSS/GDT/IDT/LDT accessible via selectors in GDT.</p>
<a id="header"/>
<h2>Header</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[2]</td>
<td>'P3' for 80386<br>'P2' for 80286<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>
<table border='1'>
<tr>
<td>0001</td>
<td>Flat model</td></tr>
<tr>
<td>0002</td>
<td>Multi-segmented model<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Size of <a href="#header">Header</a> in bytes, should be <tt><sub>x</sub>0180</tt></td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i32le</td>
<td>Size of entire '.exp' file, including all header information</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i16le</td>
<td>Checksum, the sum of all 16-bit words in the file should be zero. Alternatively, it is the negation of the modular sum of all 16-bit words except this one<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32le</td>
<td>Offset to <a href="#rtpb">Run-time Parameter Block</a> from start of '.exp' file, should be <tt><sub>x</sub>0180</tt> for flat model progarms</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32le</td>
<td>Size of <a href="#rtpb">Run-time Parameter Block</a></td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32le</td>
<td>(Multi-segmented) Offset to <a href="#relocs">Relocation Table</a> from start of '.exp' file<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a>, should be <tt><sub>x</sub>00000000</tt> for flat model programs<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32le</td>
<td>(Multi-segmented) Size of <a href="#relocs">Relocation Table</a><a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a>, should be <tt><sub>x</sub>0000</tt> for flat model programs<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32le</td>
<td>(Multi-segmented) Offset to <a href="#seginftab">Segment Information Table</a> from start of '.exp' file<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a>, should be <tt><sub>x</sub>00000000</tt> for flat model programs<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32le</td>
<td>(Multi-segmented) Size of <a href="#seginftab">Segment Information Table</a><a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a>, should be <tt><sub>x</sub>0000</tt> for flat model programs<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i16le</td>
<td>(Multi-segmented) Size of <a href="#relocs">Relocation Table</a> entry<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a>, should be <tt><sub>x</sub>000C</tt><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a>, should be <tt><sub>x</sub>0000</tt> for flat model programs<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>26</tt></td>	<td>i32le</td>
<td>Offset to program image from start of '.exp' file</td></tr>
<tr>
<td><tt><sub>x</sub>2A</tt></td>	<td>i32le</td>
<td>Size of program image in file, containing the code and data</td></tr>
<tr>
<td><tt><sub>x</sub>2E</tt></td>	<td>i32le</td>
<td>Offset to <a href="#symtab">Symbol Table</a>, <tt><sub>x</sub>00000000</tt> if no symbols are present</td></tr>
<tr>
<td><tt><sub>x</sub>32</tt></td>	<td>i32le</td>
<td>Size of <a href="#symtab">Symbol Table</a>, <tt><sub>x</sub>00000000</tt> if no symbols are present</td></tr>
<tr>
<td><tt><sub>x</sub>36</tt></td>	<td>i32le</td>
<td>(Multi-segmented) Offset of <a href="#gdt">Intel Global Descriptor Table</a> within program image, should be <tt><sub>x</sub>00000000</tt> for flat model programs<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>3A</tt></td>	<td>i32le</td>
<td>(Multi-segmented) Size of <a href="#gdt">Intel Global Descriptor Table</a>, should be <tt><sub>x</sub>00000000</tt> for flat model programs<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>3E</tt></td>	<td>i32le</td>
<td>(Multi-segmented) Offset of <a href="#ldt">Intel Local Descriptor Table</a> within program image, should be <tt><sub>x</sub>00000000</tt> for flat model programs<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>42</tt></td>	<td>i32le</td>
<td>(Multi-segmented) Size of <a href="#ldt">Intel Local Descriptor Table</a>, should be <tt><sub>x</sub>00000000</tt> for flat model programs<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>46</tt></td>	<td>i32le</td>
<td>(Multi-segmented) Offset of <a href="#idt">Intel Interrupt Descriptor Table</a> within program image, should be <tt><sub>x</sub>00000000</tt> for flat model programs<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>4A</tt></td>	<td>i32le</td>
<td>(Multi-segmented) Size of <a href="#idt">Intel Interrupt Descriptor Table</a>, should be <tt><sub>x</sub>00000000</tt> for flat model programs<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>4E</tt></td>	<td>i32le</td>
<td>(Multi-segmented) Offset of <a href="#tss">Intel Task State Segment</a> within program image, should be <tt><sub>x</sub>00000000</tt> for flat model programs<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>52</tt></td>	<td>i32le</td>
<td>(Multi-segmented) Size of <a href="#tss">Intel Task State Segment</a>, should be <tt><sub>x</sub>00000000</tt> for flat model programs<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a>, <tt><sub>x</sub>0000002C</tt> or more for 80286<a href="#286"><sup title="Intel 80286 Reference Programmer's Manual">[4]</sup></a>, <tt><sub>x</sub>00000068</tt> or more for 80386<a href="#386"><sup title="Intel 80386 Reference Programmer's Manual">[5]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>56</tt></td>	<td>i32le</td>
<td>(Flat<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a>) Minimum number of bytes to allocate after the program image</td></tr>
<tr>
<td><tt><sub>x</sub>5A</tt></td>	<td>i32le</td>
<td>(Flat<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a>) Maximum number of bytes to allocate after the program image</td></tr>
<tr>
<td><tt><sub>x</sub>5E</tt></td>	<td>i32le</td>
<td>(Flat<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a>) Base offset at which the executable is linked<br>Used to trap null references<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>62</tt></td>	<td>i32le</td>
<td>Initial ESP (stack)</td></tr>
<tr>
<td><tt><sub>x</sub>66</tt></td>	<td>i16le</td>
<td>(Multi-segmented) Initial SS (segment of stack)<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>68</tt></td>	<td>i32le</td>
<td>Initial EIP (entry)</td></tr>
<tr>
<td><tt><sub>x</sub>6C</tt></td>	<td>i16le</td>
<td>(Multi-segmented) Initial CS (segment of entry)<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>6E</tt></td>	<td>i16le</td>
<td>(Multi-segmented) Initial LDT value<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>70</tt></td>	<td>i16le</td>
<td>(Multi-segmented) Initial TSS value<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>72</tt></td>	<td>i16le</td>
<td>Flags
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Load image is compressed (packed)</td></tr>
<tr>
<td>Bit 1</td>
<td>32-bit checksum is present<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a></td></tr>
<tr>
<td>Bits 2:4</td>
<td>Relocation table type<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>74</tt></td>	<td>i32le</td>
<td>Load image in memory when uncompressed, same as image size of uncompressed files</td></tr>
<tr>
<td><tt><sub>x</sub>78</tt></td>	<td>i32le</td>
<td>Optional 32-bit checksum<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>7C</tt></td>	<td>i32le</td>
<td>Size of initial stack in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>80</tt></td>	<td>c[0x100]</td>
<td>Reserved</td></tr>
</table>
<a id="seginftab"/>
<h2>Segment Information Table</h1>
<p>Only for multi-segmented programs.<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a> For every segment in the data, there should be a corresponding entry in the segment information table. The descriptor tables and task state segments normally do not require an entry.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Selector number
<table border='1'>
<tr>
<td>Bits 0:1</td>
<td>Privilege level</td></tr>
<tr>
<td>Bit 2</td>
<td>
<table border='1'>
<tr>
<td>0</td>
<td>Addresses a GDT entry</td></tr>
<tr>
<td>1</td>
<td>Addresses an LDT entry</td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Flags</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>Base offset within program image</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32le</td>
<td>Extra bytes to be allocated for the segment</td></tr>
</table>
<a id="relocs"/>
<h2>Relocation Table</h1>
<p>Only for multi-segmented programs.<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a> Addresses of 16-bit selector values in the image that need to be relocated.</p>
<p>For a 16-bit file (<tt>'P2'</tt>), each entry in the relocation table consists of a 4-byte entry:<a href="#OWN"><sup title="own research">[6]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Offset to value to be relocated</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Selector of segment of value to be relocated</td></tr>
</table>
<p>For a 32-bit file (<tt>'P3'</tt>), each entry in the relocation table consists of a 6-byte entry:<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>Offset to value to be relocated</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Selector of segment of value to be relocated</td></tr>
</table>
<a id="rtpb"/>
<h2>Run-time Parameter Block</h1>
<p>This should begin at offset <tt><sub>x</sub>0180</tt> for flat-model programs. The format is usually the 'DX' format.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[2]</td>
<td>'DX' for extended '.exp' files, it can be changed<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td><tt>MINREAL</tt>, minimum number of 16-byte paragraphs of real mode memory to leave free</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td><tt>MAXREAL</tt>, maximum number of 16-byte paragraphs of real mode memory to leave free</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td><tt>MINIBUF</tt>, minimum number of 1KiB blocks for data buffer for DOS system calls</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le</td>
<td><tt>MAXIBUF</tt>, maximum number of 1KiB blocks for data buffer for DOS system calls</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i16le</td>
<td><tt>NISTACK</tt>, number of interrupt stacks, controls the maximum number of nested switches between real mode and protected mode</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i16le</td>
<td><tt>ISTSIZE</tt>, size in 1KiB blocks of each interrupt stack buffer</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i32le</td>
<td><tt>REALBREAK</tt>, end of real mode code and data</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i16le</td>
<td><tt>CALLBUFS</tt>, size of call buffer in 1KiB to be used for passing data between real mode and protected mode</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i16le</td>
<td>Flags
<table border='1'>
<tr>
<td>Bit 0</td>
<td>File is virtual memory manager<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a>, reserved for Phar Lap<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td>Bit 1</td>
<td>File is debugger<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a>, reserved for Phar Lap<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
<tr>
<td>Bits 2:15</td>
<td>Reserved<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>16</tt></td>	<td>i16le</td>
<td>Unprivileged flag<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a>
<table border='1'>
<tr>
<td>0x0000</td>
<td><tt>PRIVILEGED</tt>, run program at privilege level 0<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a></td></tr>
<tr>
<td>0x0001</td>
<td><tt>UNPRIVILEGED</tt>, run program at privilege level 1, 2 or 3<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a><a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>c[0x66]</td>
<td>Reserved</td></tr>
</table>
<a id="symtab"/>
<h2>Symbol Table</h1>
<p>The PUBSYM symbol table has the following layout:<a href="#RM"><sup title="386|LINK Reference Manual">[1]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><a href="#symtabhdr">Symbol Table Header</a></td></tr>
<tr>
<td><a href="#segsymtab">Segment Symbol Table</a></td></tr>
<tr>
<td><a href="#pubsymtab">Public Symbol Table</a></td></tr>
</table>
<a id="symtabhdr"/>
<h3>Symbol Table Header</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[4]</td>
<td><tt>'SYM1'</tt></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Size of <a href="#symtabhdr">Symbol Table Header</a> in bytes, should be <tt><sub>x</sub>0E</tt></td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i32le</td>
<td>Size of <a href="#segsymtab">Segment Symbol Table</a> in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i32le</td>
<td>Size of <a href="#pubsymtab">Public Symbol Table</a> in bytes</td></tr>
</table>
<a id="segsymtab"/>
<h3>Segment Symbol Table</h2>
<p>Each entry starts with a variable length field containing its name.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Length of name</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>c[*]</td>
<td>String containing name</td></tr>
</table>
<p>The name is then followed by a fixed 12-byte structure.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>Offset to segment within program image</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>Size of segment</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le</td>
<td>Selector (real mode) or paragraph (protected mode) of segment</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i16le</td>
<td>Segment flags
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Absolute segment (only in real mode)</td></tr>
</table>
</td></tr>
</table>
<a id="pubsymtab"/>
<h3>Public Symbol Table</h2>
<p>Each entry starts with a variable length field containing its name.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Length of name</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>c[*]</td>
<td>String containing name</td></tr>
</table>
<p>The name is then followed by a fixed 12-byte structure.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>Offset to symbol within segment<br>Constant value for absolute symbols</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>1-based index of selector of symbol in <a href="#segsymtab">Segment Symbol Table</a></td></tr>
</table>
<a id="tss"/>
<h2>Intel Task State Segment</h1>
<p>Only for multi-segmented programs.<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a> This is part of the program image and reflects an Intel 80286/80386 Task State Segment (TSS).</p>
<p>The Intel 80286/80386 architecture contains a structure that permits hardware assisted task switching. It contains entries for each register, stack segment and offset values for switching between different levels of privilege and some other administrative information. There are separate 16-bit and 32-bit versions (and later, 64-bit version) introduced for the 80286 and 80386, respectively.</p>
<h3>16-bit Task State Segment</h2>
<p>This is the 16-bit version<a href="#286"><sup title="Intel 80286 Reference Programmer's Manual">[4]</sup></a>, presumably used for 'P2' files. (TODO)</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Link</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>SP (stack pointer) for ring 0 (highest privilege)</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>SS (stack segment) for ring 0 (highest privilege)</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>SP (stack pointer) for ring 1</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le</td>
<td>SS (stack segment) for ring 1</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i16le</td>
<td>SP (stack pointer) for ring 2</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i16le</td>
<td>SS (stack segment) for ring 2</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i16le</td>
<td>IP, point of execution at task switching</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i16le</td>
<td>FLAGS, state of CPU flags</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i16le</td>
<td>AX</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i16le</td>
<td>CX</td></tr>
<tr>
<td><tt><sub>x</sub>16</tt></td>	<td>i16le</td>
<td>DX</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i16le</td>
<td>BX</td></tr>
<tr>
<td><tt><sub>x</sub>1A</tt></td>	<td>i16le</td>
<td>SP</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i16le</td>
<td>BP</td></tr>
<tr>
<td><tt><sub>x</sub>1E</tt></td>	<td>i16le</td>
<td>SI</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i16le</td>
<td>DI</td></tr>
<tr>
<td><tt><sub>x</sub>22</tt></td>	<td>i16le</td>
<td>ES</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i16le</td>
<td>CS (code segment), segment of executing task at task switching</td></tr>
<tr>
<td><tt><sub>x</sub>26</tt></td>	<td>i16le</td>
<td>SS (stack segment), segment of stack at task switching</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i16le</td>
<td>DS</td></tr>
<tr>
<td><tt><sub>x</sub>2A</tt></td>	<td>i16le</td>
<td>LDTR</td></tr>
</table>
<h3>32-bit Task State Segment</h2>
<p>This is the 32-bit version<a href="#386"><sup title="Intel 80386 Reference Programmer's Manual">[5]</sup></a>, used for 'P3' files.<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Link</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td>ESP (stack pointer) for ring 0 (highest privilege)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16le</td>
<td>SS (stack segment) for ring 0 (highest privilege)</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i16le</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32le</td>
<td>ESP (stack pointer) for ring 1</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i16le</td>
<td>SS (stack segment) for ring 1</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i16le</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32le</td>
<td>ESP (stack pointer) for ring 2</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i16le</td>
<td>SS (stack segment) for ring 2</td></tr>
<tr>
<td><tt><sub>x</sub>1A</tt></td>	<td>i16le</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32le</td>
<td>CR3 (control register 3), address of paging structure</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32le</td>
<td>EIP, point of execution at task switching</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i32le</td>
<td>EFLAGS, state of CPU flags</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i32le</td>
<td>EAX</td></tr>
<tr>
<td><tt><sub>x</sub>2C</tt></td>	<td>i32le</td>
<td>ECX</td></tr>
<tr>
<td><tt><sub>x</sub>30</tt></td>	<td>i32le</td>
<td>EDX</td></tr>
<tr>
<td><tt><sub>x</sub>34</tt></td>	<td>i32le</td>
<td>EBX</td></tr>
<tr>
<td><tt><sub>x</sub>38</tt></td>	<td>i32le</td>
<td>ESP</td></tr>
<tr>
<td><tt><sub>x</sub>3C</tt></td>	<td>i32le</td>
<td>EBP</td></tr>
<tr>
<td><tt><sub>x</sub>40</tt></td>	<td>i32le</td>
<td>ESI</td></tr>
<tr>
<td><tt><sub>x</sub>44</tt></td>	<td>i32le</td>
<td>EDI</td></tr>
<tr>
<td><tt><sub>x</sub>48</tt></td>	<td>i16le</td>
<td>ES</td></tr>
<tr>
<td><tt><sub>x</sub>4A</tt></td>	<td>i16le</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>4C</tt></td>	<td>i16le</td>
<td>CS (code segment), segment of executing task at task switching</td></tr>
<tr>
<td><tt><sub>x</sub>4E</tt></td>	<td>i16le</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>50</tt></td>	<td>i16le</td>
<td>SS (stack segment), segment of stack at task switching</td></tr>
<tr>
<td><tt><sub>x</sub>52</tt></td>	<td>i16le</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>54</tt></td>	<td>i16le</td>
<td>DS</td></tr>
<tr>
<td><tt><sub>x</sub>56</tt></td>	<td>i16le</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>58</tt></td>	<td>i16le</td>
<td>FS</td></tr>
<tr>
<td><tt><sub>x</sub>5A</tt></td>	<td>i16le</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>5C</tt></td>	<td>i16le</td>
<td>GS</td></tr>
<tr>
<td><tt><sub>x</sub>5E</tt></td>	<td>i16le</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>60</tt></td>	<td>i16le</td>
<td>LDTR</td></tr>
<tr>
<td><tt><sub>x</sub>62</tt></td>	<td>i16le</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>64</tt></td>	<td>i16le</td>
<td>
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Debug trap bit, causes the CPU to raise an exception on task switch</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>66</tt></td>	<td>i16le</td>
<td>I/O permission map offset from TSS start</td></tr>
</table>
<h2>Descriptor Tables</h1>
<p>The Intel architecture defines a wide range of descriptor types. The following gives a general overview of the structure.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Limit or offset value</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Base address or selector value</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i8</td>
<td>Byte 2 of base address or supplementary information</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i8</td>
<td>Access flags
<table border='1'>
<tr>
<td>Bits 0:3</td>
<td>Descriptor type</td></tr>
<tr>
<td>Bit 4</td>
<td>
<table border='1'>
<tr>
<td>0</td>
<td>System descriptor</td></tr>
<tr>
<td>1</td>
<td>Code or data segment descriptor</td></tr>
</table>
</td></tr>
<tr>
<td>Bits 5:6</td>
<td>Descriptor privilege level (0 for highest privilege, 3 for lowest privilege)</td></tr>
<tr>
<td>Bit 7</td>
<td>Present bit (must be 1 for properly accessing descriptor)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i8</td>
<td>(80386 or later) Attribute bits or byte 2 of offset value</td></tr>
<tr>
<td><tt><sub>x</sub>07</tt></td>	<td>i8</td>
<td>(80386 or later) Byte 3 of base address or offset value</td></tr>
</table>
<p>A typical segment descriptor has the following layout:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Low 16 bits of limit, last byte in segment, or 0 for an empty segment</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i24le</td>
<td>Low 24 bits of starting address of segment, OpenWatcom sets this to 0<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i8</td>
<td>Access flags
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Accessed bit</td></tr>
<tr>
<td>Bit 1</td>
<td>Data segments: writable<br>Code segments: readable</td></tr>
<tr>
<td>Bit 2</td>
<td>Data segments: expand-down, limit is the lower limit of the segment<br>Code segments: conforming, transfers to this segment will preserve the current privilege level</td></tr>
<tr>
<td>Bit 3</td>
<td>
<table border='1'>
<tr>
<td>0</td>
<td>Data segment</td></tr>
<tr>
<td>1</td>
<td>Code segment</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 4</td>
<td>=1</td></tr>
<tr>
<td>Bits 5:6</td>
<td>Descriptor privilege level (0 for highest privilege, 3 for lowest privilege)</td></tr>
<tr>
<td>Bit 7</td>
<td>Present bit (must be 1 for properly accessing descriptor)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i8</td>
<td>(80386 or later) Attribute bits
<table border='1'>
<tr>
<td>Bits 0:3</td>
<td>Bits 16 to 23 of limit</td></tr>
<tr>
<td>Bit 4</td>
<td>Bit available for user</td></tr>
<tr>
<td>Bit 5</td>
<td>Reserved (64-bit flag for 64-bit code segments, not used by Phar Lap)</td></tr>
<tr>
<td>Bit 6</td>
<td>32-bit segment</td></tr>
<tr>
<td>Bit 7</td>
<td>High granularity flag: limit value is shifted by 12 bits</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>07</tt></td>	<td>i8</td>
<td>(80386 or later) High 8 bits of starting address of segment, OpenWatcom sets this to 0<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
</table>
<p>The descriptor of an LDT or TSS:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Low 16 bits of limit, last byte in segment</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i24le</td>
<td>Low 24 bits of starting address of segment, OpenWatcom sets this to 0<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i8</td>
<td>Access flags
<table border='1'>
<tr>
<td>Bits 0:3</td>
<td>
<table border='1'>
<tr>
<td>0x01</td>
<td>16-bit available TSS (invalid in 64-bit mode)</td></tr>
<tr>
<td>0x02</td>
<td>LDT</td></tr>
<tr>
<td>0x03</td>
<td>16-bit busy TSS (invalid in 64-bit mode)</td></tr>
<tr>
<td>0x09</td>
<td>32-bit available TSS (also 64-bit)</td></tr>
<tr>
<td>0x0B</td>
<td>32-bit busy TSS (also 64-bit)</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 4</td>
<td>=1</td></tr>
<tr>
<td>Bits 5:6</td>
<td>Descriptor privilege level (0 for highest privilege, 3 for lowest privilege)</td></tr>
<tr>
<td>Bit 7</td>
<td>Present bit (must be 1 for properly accessing descriptor)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i8</td>
<td>(80386 or later) Attribute bits
<table border='1'>
<tr>
<td>Bits 0:3</td>
<td>Bits 16 to 23 of limit</td></tr>
<tr>
<td>Bit 4</td>
<td>Bit available for user</td></tr>
<tr>
<td>Bit 5</td>
<td>Reserved</td></tr>
<tr>
<td>Bit 6</td>
<td>Reserved</td></tr>
<tr>
<td>Bit 7</td>
<td>High granularity flag: limit value is shifted by 12 bits</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>07</tt></td>	<td>i8</td>
<td>(80386 or later) High 8 bits of starting address of segment, OpenWatcom sets this to 0<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></td></tr>
</table>
<p>The descriptor of a call, interrupt or trap gate:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Low 16 bits of offset</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Selector for gate</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i8</td>
<td>Usually reserved<br>For a call gate, the low 5 bits provide the parameter count, number of 16-bit/32-bit words that need to be transferred between privilege levels (invalid in 64-bit mode)<br>(in 64-bit mode, interrupt and trap gates use the lower 3 bits to reference an interrupt stack table)</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i8</td>
<td>Access flags
<table border='1'>
<tr>
<td>Bits 0:3</td>
<td>
<table border='1'>
<tr>
<td>0x04</td>
<td>16-bit call gate (invalid in 64-bit mode)</td></tr>
<tr>
<td>0x06</td>
<td>16-bit trap gate (invalid in 64-bit mode)</td></tr>
<tr>
<td>0x07</td>
<td>16-bit interrupt gate (invalid in 64-bit mode)</td></tr>
<tr>
<td>0x0C</td>
<td>32-bit call gate (also 64-bit)</td></tr>
<tr>
<td>0x0E</td>
<td>32-bit trap gate (also 64-bit)</td></tr>
<tr>
<td>0x0F</td>
<td>32-bit interrupt gate (also 64-bit)</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 4</td>
<td>=0</td></tr>
<tr>
<td>Bits 5:6</td>
<td>Descriptor privilege level (0 for highest privilege, 3 for lowest privilege)</td></tr>
<tr>
<td>Bit 7</td>
<td>Present bit (must be 1 for properly accessing descriptor)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>(80386 or later) High 16 bits of offset</td></tr>
</table>
<p>The descriptor of a task gate (invalid in 64-bit mode):</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Selector for TSS</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i8</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i8</td>
<td>Access flags
<table border='1'>
<tr>
<td>Bits 0:3</td>
<td>=<tt><sub>x</sub>05</tt></td></tr>
<tr>
<td>Bit 4</td>
<td>=0</td></tr>
<tr>
<td>Bits 5:6</td>
<td>Descriptor privilege level (0 for highest privilege, 3 for lowest privilege)</td></tr>
<tr>
<td>Bit 7</td>
<td>Present bit (must be 1 for properly accessing descriptor)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>Reserved</td></tr>
</table>
<a id="gdt"/>
<h3>Intel Global Descriptor Table</h2>
<p>Only for multi-segmented programs.<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a> This is part of the program image and reflects an Intel 80286/80386 Global Descriptor Table (GDT). A global descriptor table provides the description of segments and gates that are supposed to be system wide. A GDT may contain all types of descriptors except interrupt and trap gates. Segment selectors address the GDT if bit 2 is 0.</p>
<p>OpenWatcom stores a dummy selector, as required by the architecture, then a 32-bit TSS, followed by 16-bit data segments to access the TSS, GDT, IDT, then an LDT and a 16-bit data segment to access the LDT.<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></p>
<a id="idt"/>
<h3>Intel Interrupt Descriptor Table</h2>
<p>Only for multi-segmented programs.<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a> This is part of the program image and reflects an Intel 80286/80386 Interrupt Descriptor Table (IDT). The Intel architecture defines 256 interrupt values, and in protected mode the IDT can hold a descriptor for each of these. Only task, interrupt and trap gates are permitted.</p>
<p>OpenWatcom stores only a dummy selector.<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></p>
<a id="ldt"/>
<h3>Intel Local Descriptor Table</h2>
<p>Only for multi-segmented programs.<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a><a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a> This is part of the program image and reflects an Intel 80286/80386 Local Descriptor Table (LDT). Similarly to a global descriptor table, it contains descriptions of segments and gates. The Intel architecture makes it convenient to switch local descriptor tables, so it is usually used for task specific information. An LDT may contain only segment descriptors, as well as call and task gates. Segment selectors address the LDT if bit 2 is 1.</p>
<p>OpenWatcom stores a dummy selector, then an entry for each segment in the program image.<a href="#OW"><sup title="OpenWatcom sources">[3]</sup></a></p>
<a id="debinfo"/>
<h2>Borland Debug Information</h1>
<p>This optional section appears after the program image.<a href="#RB"><sup title="Ralf Brown's interrupt list (Int 21/AH=4Bh)">[2]</sup></a></p>
<p>TODO</p>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="https://archive.org/details/386-link/mode/2up" target='_blank'>386|LINK Reference Manual</a></li>
<li>[2] <a href="http://www.ctyme.com/intr/rb-2939.htm" target='_blank'>Ralf Brown's interrupt list (Int 21/AH=4Bh)</a></li>
<li>[3] <a href="https://github.com/open-watcom/open-watcom-v2" target='_blank'>OpenWatcom sources</a></li>
<li>[4] <a href="https://archive.org/details/8028680287progra00inte" target='_blank'>Intel 80286 Reference Programmer's Manual</a></li>
<li>[5] <a href="https://nju-projectn.github.io/i386-manual/toc.htm" target='_blank'>Intel 80386 Reference Programmer's Manual</a></li>
<li>[6] own research</li>
</ul>
<hr/>
<h1 id="rsrc">Macintosh resource</h1>
<dl>
<dt>File extensions</td>
<dd>&mdash;</dd>
<dl>
<dt>Magic code</td>
<dd>&mdash;</dd>
<dl>
<dt>Architecture</td>
<dd>binary, Motorola 68000</dd>
<dl>
<dt>Operating systems</td>
<dd>1984-01-24: System 1 for Macintosh 128K (Mac OS)</dd>
</dl>
<dl>
<dt>Influences</td>
<dd>binary, Motorola 68000</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#rsrchdr">Resource header</a>
</li>
<li><a href="#rsrcdat">Resource data</a>
</li>
<li><a href="#rsrcmap">Resource map</a>
<ol>
<li><a href="#typelist">Resource type list</a>
</li>
<li><a href="#reflist">Reference list</a>
</li>
<li><a href="#namelist">Resource name list</a>
</li>
</ol></li>
<li><a href="#"><tt>'CODE'</tt> resources</a>
<ol>
<li><a href="#">Runtime view</a>
<ol>
<li><a href="#">Jump table entries</a>
<ol>
<li><a href="#">Near model jump table</a>
</li>
<li><a href="#">Far model jump table</a>
</li>
<li><a href="#">CFM-68K jump table</a>
</li>
</ol></li>
<li><a href="#">Format of near <tt>'CODE'</tt> segments</a>
</li>
<li><a href="#">Format of far <tt>'CODE'</tt> segments</a>
</li>
<li><a href="#">Format of CFM-68K <tt>'CODE'</tt> segments</a>
</ol></li>
</ol></li>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<p>Classic Macintosh executables are stored together with other resources, as <tt>'CODE'</tt> resources. The first part will be an overview of the resource file format in general.</p>
<table border='1' align='center'>
<tr>
<td><a href="#rsrchdr">Resource header</a></td></tr>
<tr>
<td>Reserved area</td></tr>
<tr>
<td><a href="#rsrcdat">Resource data</a></td></tr>
<tr>
<td><a href="#rsrcmap">Resource map</a> (header)</td></tr>
<tr>
<td><a href="#typelist">Resource type list</a></td></tr>
<tr>
<td><a href="#reflist">Reference list</a></td></tr>
<tr>
<td><a href="#namelist">Resource name list</a></td></tr>
</table>
<a id="rsrchdr"/>
<h2>Resource header</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32be</td>
<td>Offset of <a href="#rsrcdat">Resource data</a> from start of resource header, should be <tt><sub>x</sub>0100</tt></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td>Offset of <a href="#rsrcmap">Resource map</a> from start of resource header</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32be</td>
<td>Length of <a href="#rsrcdat">Resource data</a></td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32be</td>
<td>Length of <a href="#rsrcmap">Resource map</a></td></tr>
</table>
<a id="rsrcdat"/>
<h2>Resource data</h1>
<p>A sequence of resources, each encoded as follows.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32be</td>
<td>Length of resource data, following this longword</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>c[*]</td>
<td>Actual resource data</td></tr>
</table>
<a id="rsrcmap"/>
<h2>Resource map</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[0x10]</td>
<td>Reserved for copy of resource header</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>c[4]</td>
<td>Reserved for handle to next resource map</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>c[2]</td>
<td>Reserved for file reference number</td></tr>
<tr>
<td><tt><sub>x</sub>16</tt></td>	<td>i16be</td>
<td>Reserved fork attributes</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i16be</td>
<td>Offset of <a href="#typelist">Resource type list</a> from beginning of resource map</td></tr>
<tr>
<td><tt><sub>x</sub>1A</tt></td>	<td>i16be</td>
<td>Offset of <a href="#namelist">Resource name list</a> from beginning of resource map</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i16be</td>
<td>Number of types in <a href="#typelist">Resource type list</a> - 1</td></tr>
<tr>
<td><tt><sub>x</sub>1E</tt></td>	<td>c[*]</td>
<td><a href="#typelist">Resource type list</a></td></tr>
<tr>
<td><tt>...</tt></td>	<td>c[*]</td>
<td><a href="#reflist">Reference list</a></td></tr>
<tr>
<td><tt>...</tt></td>	<td>c[*]</td>
<td><a href="#namelist">Resource name list</a></td></tr>
</table>
<a id="typelist"/>
<h3>Resource type list</h2>
<p>Each type has the following format.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[4]</td>
<td>Resource type</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16be</td>
<td>Number of resources of this type - 1</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16be</td>
<td>Offset of <a href="#reflist">Reference list</a> entry from beginning of <a href="#typelist">Resource type list</a></td></tr>
</table>
<a id="reflist"/>
<h3>Reference list</h2>
<p>Each resource type has a sequence of corresponding reference list entries.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td>Resource ID</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16be</td>
<td>Offset of resource name from beginning of <a href="#namelist">Resource name list</a><br><tt><sub>x</sub>FFFF</tt> otherwise</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i8</td>
<td>Resource attributes</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i24be</td>
<td>Offset of resource data from beginning of <a href="#rsrcdat">Resource data</a></td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32be</td>
<td>Reserved for handle to resource</td></tr>
</table>
<a id="namelist"/>
<h3>Resource name list</h2>
<p>Each resource name has the following format.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td>Length of resource name</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>c[*]</td>
<td>Resource name</td></tr>
</table>
<h2><tt>'CODE'</tt> resources</h1>
<h3>Runtime view</h2>
<p>Every Classic Macintosh application consists of code segments, a stack and an area of memory addressed via the <tt>A5</tt> register, referred to as the <b>A5 world</b>. The A5 world contains global variables as well as the <b>jump table</b> that permits code transfers between different code segments.</p>
<p>Code segments and the jump table are loaded from the <tt>'CODE'</tt> resources. The jump table is stored as the <tt>'CODE'</tt> resource with resource ID 0.</p>
<h4>Jump table entries</h3>
<p>The jump table stored in the <tt>'CODE'0</tt> resource has the following layout.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32be</td>
<td>Above A5 size</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td>Below A5 size, including global variables and QuickDraw global variables</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32be</td>
<td>Jump table size, 8 times the number of entries</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32be</td>
<td>Jump table offset, relative to the A5 register, should be <tt><sub>x</sub>20</tt></td></tr>
</table>
<p>This is then followed by a sequence of (unloaded) jump table entries. There are two types of jump table entries: near model jump table entries (offset fits 16 bits) and far model jump table entries (offset requires 32 bits). Jump table entries (near and far) are grouped according to their segment.</p>
<p>A jump table entry is accessed via the instruction <tt>jsr offset(a5)</tt> for some offset.</p>
<h5>Near model jump table</h4>
<p>A near model jump table consists of a sequence of near model jump table entries. The format of an unloaded jump table entry is as follows:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td>Routine offset from beginning of segment</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i32be</td>
<td>Instruction to load segment number onto stack<br><tt>mov #number, -(sp)</tt>
<table border='1'>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16be</td>
<td><tt><sub>x</sub>3F3C</tt></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16be</td>
<td>Segment number</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16be</td>
<td><tt>_LoadSeg</tt> trap number<br><tt><sub>x</sub>A9F0</tt></td></tr>
</table>
<p>The format of a loaded jump table entry, only appearing after the image is loaded in memory, is as follows.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td>Segment number</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16be[3]</td>
<td>Instruction to jump to routine
<table border='1'>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16be</td>
<td><tt><sub>x</sub>4ED9</tt></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td>Absolute offset</td></tr>
</table>
</td></tr>
</table>
<h5>Far model jump table</h4>
<p>A far model jump table being with a sequence of near model jump table entries, followed by a flag and a sequence of far model jump table entries. It would typically start with a single near model jump table entry, addressing a bootstrap code that patches the <tt>_LoadSeg</tt> command.</p>
<p>Far model jump table entries are separated by a flag entry of the following format:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td><tt><sub>x</sub>0000</tt></td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16be</td>
<td>Version number, <tt><sub>x</sub>FFFF</tt></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td><tt><sub>x</sub>00000000</tt></td></tr>
</table>
<p>This is then followed by (unloaded) far model jump table entries:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td>Segment number</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16be</td>
<td><tt>_LoadSeg</tt> trap number<br><tt><sub>x</sub>A9F0</tt></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td>Segment offset</td></tr>
</table>
<h5>CFM-68K jump table</h4>
<p>A CFM-68K application is very similar to a far model jump table but with a different flag entry:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td><tt><sub>x</sub>0000</tt></td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16be</td>
<td>Version number, <tt><sub>x</sub>FFFD</tt></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td><tt><sub>x</sub>00000000</tt></td></tr>
</table>
<p>Note: it is unclear if the <tt>'CODE'0</tt> resource only contains a single near jump table entry and no flag.</p>
<h4>Format of near <tt>'CODE'</tt> segments</h3>
<p>All other <tt>'CODE'</tt> resources are loadable segments, and their resource ID is the number of the segment. Near model segments have a 4 byte header referencing the jump table data:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td>Offset to first jump table entry from the start of the jump table</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16be</td>
<td>Number of jump table entries</td></tr>
</table>
<h4>Format of far <tt>'CODE'</tt> segments</h3>
<p>Far model segments have a different header format:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td>Version number, <tt><sub>x</sub>FFFF</tt></td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16be</td>
<td>Reserved, <tt><sub>x</sub>0000</tt></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td>A5 offset of near entries</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32be</td>
<td>A5 number of near entries</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32be</td>
<td>A5 offset of far entries</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32be</td>
<td>A5 number of far entries</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32be</td>
<td>Offset of A5-relative relocation information</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32be</td>
<td>Value of A5, to be added to addresses</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32be</td>
<td>Offset of PC-relative relocation information</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32be</td>
<td>Segment load address</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i32be</td>
<td>Reserved, <tt><sub>x</sub>00000000</tt></td></tr>
</table>
<p>This header is then followed by the segment image, then the A5-relative relocation information, then the PC-relative relocation information.</p>
<p>Relocation information is stored as a compressed list of offsets between 32-bit words that need relocation.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>01</tt>-<tt><sub>x</sub>7F</tt></td>
<td>Shifted by 1 for values between <tt><sub>x</sub>02</tt> and <tt><sub>x</sub>FE</tt></td></tr>
<tr>
<td><tt><sub>x</sub>8080</tt>-<tt><sub>x</sub>FFFF</tt></td>
<td>Low 15 bits shifted by 1 for values between <tt><sub>x</sub>0100</tt> and <tt><sub>x</sub>FFFE</tt></td></tr>
<tr>
<td><tt><sub>x</sub>00</tt> <tt><sub>x</sub>80008000</tt>-<tt><sub>x</sub>FFFFFFFF</tt></td>
<td>Low 31 bits shifted by 1 for values between <tt><sub>x</sub>00010000</tt> and <tt><sub>x</sub>FFFFFFFE</tt></td></tr>
<tr>
<td><tt><sub>x</sub>00</tt> <tt><sub>x</sub>00</tt></td>
<td>End of relocation information</td></tr>
</table>
<h4>Format of CFM-68K <tt>'CODE'</tt> segments</h3>
<p>CFM-68K model segments have a format similar to that of far segments:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td>Version number, <tt><sub>x</sub>FFFD</tt></td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16be</td>
<td>Reserved, <tt><sub>x</sub>0000</tt></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td>A5 offset of jump table entries</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32be</td>
<td>A5 number of jump table entries</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32be</td>
<td>A5 offset of transition vectors</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32be</td>
<td>A5 number of transition vectors</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32be</td>
<td>Reserved, <tt><sub>x</sub>00000000</tt></td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32be</td>
<td>Reserved, <tt><sub>x</sub>00000000</tt></td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32be</td>
<td>Reserved, <tt><sub>x</sub>00000000</tt></td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32be</td>
<td>Reserved, <tt><sub>x</sub>00000000</tt></td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i32be</td>
<td>Reserved, <tt><sub>x</sub>00000000</tt></td></tr>
</table>
<p>This header is then followed by the segment image.</p>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="https://developer.apple.com/library/archive/documentation/mac/pdf/MoreMacintoshToolbox.pdf" target='_blank'>More Macintosh Toolbox</a></li>
<li>[2] <a href="https://developer.apple.com/library/archive/documentation/mac/pdf/MacOS_RT_Architectures.pdf" target='_blank'>Mac OS Runtime Architectures</a></li>
</ul>
<hr/>
<h2 id="apple">AppleSingle/AppleDouble container format</h2>
<dl>
<dt>File extensions</td>
<dd><tt>.adf</tt> for AppleDouble stored on MS-DOS, but usually a prefix with <tt>%</tt> (UNIX), <tt>R.</tt> (ProDOS), <tt>._</tt> (Mac OS X/macOS)</dd>
<dl>
<dt>Magic code</td>
<dd><tt><sub>x</sub>00<sub>x</sub>05<sub>x</sub>16<sub>x</sub>00</tt> for AppleSingle, <tt><sub>x</sub>00<sub>x</sub>05<sub>x</sub>16<sub>x</sub>07</tt> for AppleDouble</dd>
<dl>
<dt>Architecture</td>
<dd>binary, Motorola 68000</dd>
<dl>
<dt>Operating systems</td>
<dd>1988-02: A/UX</dd>
</dl>
<dl>
<dt>Influences</td>
<dd>binary, Motorola 68000</dd>
<a id="_contents"/>
<h3>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#header">Header</a>
</li>
<li><a href="#DataFork">Data fork</a>
</li>
<li><a href="#RsrcFork">Resource fork</a>
</li>
<li><a href="#RealName">Real name</a>
</li>
<li><a href="#Comment">Comment</a>
</li>
<li><a href="#IconBW">Icon, B&amp;W</a>
</li>
<li><a href="#IconColor">Icon, color</a>
</li>
<li><a href="#FileInfo">File Info</a>
<ol>
<li><a href="#">Macintosh</a>
</li>
<li><a href="#">A/UX File Info</a>
</li>
<li><a href="#">MS-DOS File Info</a>
</li>
<li><a href="#">ProDOS File Info</a>
</li>
</ol></li>
<li><a href="#FileDatesInfo">File Dates Info</a>
</li>
<li><a href="#FinderInfo">Finder information</a>
</li>
<li><a href="#MacintoshFileInfo">Macintosh File Info</a>
</li>
<li><a href="#ProDOSFileInfo">ProDOS File Info</a>
</li>
<li><a href="#MSDOSFileInfo">MS-DOS File Info</a>
</li>
<li><a href="#AFPShortName">AFP short name</a>
</li>
<li><a href="#AFPFileInfo">AFP File Info</a>
</li>
<li><a href="#AFPDirectoryID">AFP Directory ID</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h3>Overall layout</h1>
<a id="header"/>
<h3>Header</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32be</td>
<td>Magic number
<table border='1'>
<tr>
<td>0x00051600</td>
<td>AppleSingle</td></tr>
<tr>
<td>0x00051607</td>
<td>AppleDouble</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td>Version number
<table border='1'>
<tr>
<td>0x00010000</td>
<td>Version 1</td></tr>
<tr>
<td>0x00020000</td>
<td>Version 2</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>c[16]</td>
<td>(Version 1) Home file system<br>(Version 2) reserved, all zeroes
<table border='1'>
<tr>
<td><tt>"Macintosh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</tt></td>
<td>Macintosh, A/UX</td></tr>
<tr>
<td><tt>"ProDOS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</tt></td>
<td>ProDOS</td></tr>
<tr>
<td><tt>"MS-DOS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</tt></td>
<td>MS-DOS</td></tr>
<tr>
<td><tt>"Unix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</tt></td>
<td>UNIX</td></tr>
<tr>
<td><tt>"VAX&nbsp;VMS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</tt></td>
<td>VMS</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i16be</td>
<td>Number of entries</td></tr>
</table>
<p>Each entry has the following format:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32be</td>
<td>Entry ID
<table border='1'>
<tr>
<td>1</td>
<td><a href="#DataFork">Data fork</a></td></tr>
<tr>
<td>2</td>
<td><a href="#RsrcFork">Resource fork</a></td></tr>
<tr>
<td>3</td>
<td><a href="#RealName">Real name</a>, in its home file system</td></tr>
<tr>
<td>4</td>
<td><a href="#Comment">Comment</a></td></tr>
<tr>
<td>5</td>
<td><a href="#IconBW">Icon, B&amp;W</a></td></tr>
<tr>
<td>6</td>
<td><a href="#IconColor">Icon, color</a></td></tr>
<tr>
<td>7</td>
<td>(Version 1 only) <a href="#FileInfo">File Info</a></td></tr>
<tr>
<td>8</td>
<td>(Version 2 only) <a href="#FileDatesInfo">File Dates Info</a></td></tr>
<tr>
<td>9</td>
<td><a href="#FinderInfo">Finder information</a></td></tr>
<tr>
<td>10</td>
<td>(Version 2 only) <a href="#MacintoshFileInfo">Macintosh File Info</a></td></tr>
<tr>
<td>11</td>
<td>(Version 2 only) <a href="#ProDOSFileInfo">ProDOS File Info</a></td></tr>
<tr>
<td>12</td>
<td>(Version 2 only) <a href="#MSDOSFileInfo">MS-DOS File Info</a></td></tr>
<tr>
<td>13</td>
<td>(Version 2 only) <a href="#AFPShortName">AFP short name</a></td></tr>
<tr>
<td>14</td>
<td>(Version 2 only) <a href="#AFPFileInfo">AFP File Info</a></td></tr>
<tr>
<td>13</td>
<td>(Version 2 only) <a href="#AFPDirectoryID">AFP Directory ID</a></td></tr>
<tr>
<td>0x80000000-0xFFFFFFFF</td>
<td>user IDs</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td>Offset</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32be</td>
<td>Size of entry</td></tr>
</table>
<a id="DataFork"/>
<h3>Data fork</h1>
<p>Contains an arbitrary length sequence of bytes as stored for the file.</p>
<a id="RsrcFork"/>
<h3>Resource fork</h1>
<p>Contains the resource fork of a Macintosh or ProDOS file. Its structure is described elsewhere.</p>
<a id="RealName"/>
<h3>Real name</h1>
<p>Contains a string of the file name in its home filesystem.</p>
<a id="Comment"/>
<h3>Comment</h1>
<p>Standard Macintosh comment, stored as an ASCII string of at most 200 characters.</p>
<a id="IconBW"/>
<h3>Icon, B&amp;W</h1>
<p>Macintosh black and white icon. Expected to be the copy of an <tt>'ICON'</tt> or <tt>'ICN#'</tt> resource. The <tt>ASIconBW</tt> structure is as follows:</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32be[32]</td>
<td>32 rows of 32 1-bit pixels packed in longwords<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
</table>
<a id="IconColor"/>
<h3>Icon, color</h1>
<p>Macintosh color icon. Most likely a copy of an <tt>'ICN#'</tt>, <tt>'ics#'</tt>, <tt>'icl4'</tt>, <tt>'ics4'</tt>, <tt>'icl8'</tt> or <tt>'ics8'</tt> resource.</p>
<p>TODO</p>
<a id="FileInfo"/>
<h3>File Info</h1>
<p>Version 1 only. The exact layout depends on the home file system.</p>
<h4>Macintosh</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32be</td>
<td>Creation date (moved to <a href="#FileDatesInfo">File Dates Info</a> in Version 2)</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td>Modification date (moved to <a href="#FileDatesInfo">File Dates Info</a> in Version 2)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32be</td>
<td>Last backup date (moved to <a href="#FileDatesInfo">File Dates Info</a> in Version 2)</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32be</td>
<td>Attributes (moved to <a href="#MacintoshFileInfo">Macintosh File Info</a> in Version 2)
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Locked</td></tr>
<tr>
<td>Bit 1</td>
<td>Protected</td></tr>
</table>
</td></tr>
</table>
<h4>A/UX File Info</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32be</td>
<td>Creation date (moved to <a href="#FileDatesInfo">File Dates Info</a> in Version 2)</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td>Last use date &amp; time (moved to <a href="#FileDatesInfo">File Dates Info</a> in Version 2)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32be</td>
<td>Last modification date &amp; time (moved to <a href="#FileDatesInfo">File Dates Info</a> in Version 2)</td></tr>
</table>
<h4>MS-DOS File Info</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32be</td>
<td>Modification date (moved to <a href="#FileDatesInfo">File Dates Info</a> in Version 2)</td></tr>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td>MS-DOS attributes (moved to <a href="#MSDOSFileInfo">MS-DOS File Info</a> in Version 2)</td></tr>
</table>
<h4>ProDOS File Info</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32be</td>
<td>Creation date &amp; time (moved to <a href="#FileDatesInfo">File Dates Info</a> in Version 2)</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td>Modification date &amp; time (moved to <a href="#FileDatesInfo">File Dates Info</a> in Version 2)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16be</td>
<td>Access (moved to <a href="#ProDOSFileInfo">ProDOS File Info</a> in Version 2)</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>i16be</td>
<td>File Type (moved to <a href="#ProDOSFileInfo">ProDOS File Info</a> in Version 2)</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td>Auxiliary ("A/UX" in <a href="#AUX"><sup title="AppleSingle and AppleDouble format internals - A/UX Toolbox: Macintosh ROM Interface">[1]</sup></a>, likely typo) type (moved to <a href="#ProDOSFileInfo">ProDOS File Info</a> in Version 2)</td></tr>
</table>
<a id="FileDatesInfo"/>
<h3>File Dates Info</h1>
<p>Version 2 only, all systems. The structure is called <tt>ASFileDates</tt>.<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></p>
<p>All entries are stored as a signed number, counting the seconds since 2000-01-01 GMT, midnight. Unknown entries are set to <tt><sub>x</sub>80000000</tt>.<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>s32be</td>
<td>Creation date</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>s32be</td>
<td>Modification date</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>s32be</td>
<td>Backup date</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>s32be</td>
<td>Access date</td></tr>
</table>
<a id="FinderInfo"/>
<h3>Finder information</h1>
<p>The first part is the <tt>FInfo</tt> structure.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[4]</td>
<td><tt>fdType</tt> - File type<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>c[4]</td>
<td><tt>fdCreator</tt> - File's creator<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i16be</td>
<td><tt>fdFlags</tt> - Finder flag bits<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a>
<table border='1'>
<tr>
<td>Bit 0</td>
<td>(HFS only) File is on desktop<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td>Bits 1:3</td>
<td>Color coding<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td>Bits 4:5</td>
<td>Reserved<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td>Bit 6</td>
<td>Application available to multiple users<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td>Bit 7</td>
<td>File contains no INIT resources<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td>Bit 8</td>
<td>Finder has loaded bundle resources<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td>Bit 9</td>
<td>Reserved<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td>Bit 10</td>
<td>File contains custom icon<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td>Bit 11</td>
<td>File is a stationary pad<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td>Bit 12</td>
<td>File cannot be renamed by Finder<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td>Bit 13</td>
<td>File has a bundle<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td>Bit 14</td>
<td>File's icon is invisible<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td>Bit 15</td>
<td>(System 7) File is an alias<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>Point</td>
<td><tt>fdLocation</tt> - File's location in finder<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a>
<table border='1'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td><tt>v</tt> - Vertical coordinate (Y)</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16be</td>
<td><tt>h</tt> - Horizontal coordinate (X)</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i16be</td>
<td><tt>fdFldr</tt> - File's folder<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
</table>
<p>This is followed by the <tt>FXInfo</tt> structure.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i16be</td>
<td><tt>fdIconID</tt> - Icon ID number<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i16be[3]</td>
<td><tt>fdUnused</tt> - Reserved<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>s8</td>
<td><tt>fdScript</tt> - Script flag and code<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>19</tt></td>	<td>s8</td>
<td><tt>fdXFlags</tt> - Reserved<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>1A</tt></td>	<td>i16be</td>
<td><tt>fdComment</tt> - Comment ID number<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32be</td>
<td><tt>fdPutAway</tt> - Home directory ID<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
</table>
<a id="MacintoshFileInfo"/>
<h3>Macintosh File Info</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32be</td>
<td>Flags
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Locked</td></tr>
<tr>
<td>Bit 1</td>
<td>Protected</td></tr>
</table>
</td></tr>
</table>
<a id="ProDOSFileInfo"/>
<h3>ProDOS File Info</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td>Access</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16be</td>
<td>File Type</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32be</td>
<td>Auxiliary Type</td></tr>
</table>
<a id="MSDOSFileInfo"/>
<h3>MS-DOS File Info</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16be</td>
<td>MS-DOS attributes
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Read-only<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td>Bit 1</td>
<td>Hidden<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td>Bit 2</td>
<td>System file<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td>Bit 3</td>
<td>Volume label<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td>Bit 4</td>
<td>Subdirectory<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
<tr>
<td>Bit 5</td>
<td>New or modified (archive bit)<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></td></tr>
</table>
</td></tr>
</table>
<a id="AFPShortName"/>
<h3>AFP short name</h1>
<p>The short name, as stored on the AppleTalk Filing Protocol. Arbitrary length string, usually ASCII printable, starting with '!'.<a href="#RFC"><sup title="RFC 1740 - MIME Encapsulation of Macintosh files">[3]</sup></a></p>
<a id="AFPFileInfo"/>
<h3>AFP File Info</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32be</td>
<td>Flags
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Invisible</td></tr>
<tr>
<td>Bit 1</td>
<td>Multi User</td></tr>
<tr>
<td>Bit 2</td>
<td>System</td></tr>
<tr>
<td>Bit 3</td>
<td>Backup Needed</td></tr>
</table>
</td></tr>
</table>
<a id="AFPDirectoryID"/>
<h3>AFP Directory ID</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32be</td>
<td>File's directory ID on AFP server</td></tr>
</table>
<a id="_references"/>
<h3>References</h1>
<ul>
<li>[1] <a href="https://web.archive.org/web/20160325000219/http://kaiser-edv.de/documents/AppleSingle_AppleDouble_v1.pdf" target='_blank'>AppleSingle and AppleDouble format internals - A/UX Toolbox: Macintosh ROM Interface</a></li>
<li>[2] <a href="https://web.archive.org/web/20180311140826/http://kaiser-edv.de/documents/AppleSingle_AppleDouble.pdf" target='_blank'>AppleSingle/AppleDouble Formats for Foreign Files Developer's Note</a></li>
<li>[3] <a href="https://datatracker.ietf.org/doc/html/rfc1740" target='_blank'>RFC 1740 - MIME Encapsulation of Macintosh files</a></li>
</ul>
<hr/>
<h2 id="macbin">MacBinary format</h2>
<dl>
<dt>File extensions</td>
<dd><tt>.bin</tt> or <tt>.macbin</tt> or <tt>.mbin</tt></dd>
<dl>
<dt>Magic code</td>
<dd>&mdash;</dd>
<dl>
<dt>Architecture</td>
<dd>binary, Motorola 68000</dd>
<dl>
<dt>Operating systems</td>
<dd>?: Mac OS</dd>
</dl>
<dl>
<dt>Influences</td>
<dd>binary, Motorola 68000</dd>
<a id="_contents"/>
<h3>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#header">Header</a>
<ol>
<li><a href="#">CRC calculation</a>
</ol></li>
</li><li><a href="#_references">References</a></li>
</ol>
<h3>Overall layout</h1>
<p>The MacBinary is an alternative to the AppleSingle format to transfer Macintosh files to other systems, combining the resource and data forks into a single file.</p>
<table border='1' align='center'>
<tr>
<td><a href="#header">Header</a></td></tr>
<tr>
<td>Data Fork, aligned on 128 bytes</td></tr>
<tr>
<td>Resource Fork, aligned on 128 bytes</td></tr>
<tr>
<td>Get Info comment, aligned on 128 bytes</td></tr>
</table>
<a id="header"/>
<h3>Header</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>00</tt> (Version 1: version number<a href="#MACBIN1"><sup title="Macintosh Binary Transfer Format (MacBinary) Standard Proposal (1985-03-13)">[1]</sup></a>)<br>Suggested for file check for MacBinary</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i8</td>
<td>Length of filename (1-63)</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>c[0x3F]</td>
<td>Filename</td></tr>
<tr>
<td><tt><sub>x</sub>41</tt></td>	<td>c[4]</td>
<td>(FInfo) File type</td></tr>
<tr>
<td><tt><sub>x</sub>45</tt></td>	<td>c[4]</td>
<td>(FInfo) File creator</td></tr>
<tr>
<td><tt><sub>x</sub>49</tt></td>	<td>i8</td>
<td>(FInfo) Finder flags
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Inited<a href="#MACBIN1"><sup title="Macintosh Binary Transfer Format (MacBinary) Standard Proposal (1985-03-13)">[1]</sup></a><a href="#MACBIN3"><sup title="Macintosh Binary Transfer Format (MacBinary III) Standard Proposal (1996-12)">[3]</sup></a></td></tr>
<tr>
<td>Bit 1</td>
<td>Changed<a href="#MACBIN1"><sup title="Macintosh Binary Transfer Format (MacBinary) Standard Proposal (1985-03-13)">[1]</sup></a>, reserved<a href="#MACBIN3"><sup title="Macintosh Binary Transfer Format (MacBinary III) Standard Proposal (1996-12)">[3]</sup></a></td></tr>
<tr>
<td>Bit 2</td>
<td>Busy<a href="#MACBIN1"><sup title="Macintosh Binary Transfer Format (MacBinary) Standard Proposal (1985-03-13)">[1]</sup></a>, hasCustomIcon<a href="#MACBIN3"><sup title="Macintosh Binary Transfer Format (MacBinary III) Standard Proposal (1996-12)">[3]</sup></a></td></tr>
<tr>
<td>Bit 3</td>
<td>Bozo<a href="#MACBIN1"><sup title="Macintosh Binary Transfer Format (MacBinary) Standard Proposal (1985-03-13)">[1]</sup></a>, isStationary<a href="#MACBIN3"><sup title="Macintosh Binary Transfer Format (MacBinary III) Standard Proposal (1996-12)">[3]</sup></a></td></tr>
<tr>
<td>Bit 4</td>
<td>System<a href="#MACBIN1"><sup title="Macintosh Binary Transfer Format (MacBinary) Standard Proposal (1985-03-13)">[1]</sup></a>, nameLocked<a href="#MACBIN3"><sup title="Macintosh Binary Transfer Format (MacBinary III) Standard Proposal (1996-12)">[3]</sup></a></td></tr>
<tr>
<td>Bit 5</td>
<td>Bundle<a href="#MACBIN1"><sup title="Macintosh Binary Transfer Format (MacBinary) Standard Proposal (1985-03-13)">[1]</sup></a>, hasBundle<a href="#MACBIN3"><sup title="Macintosh Binary Transfer Format (MacBinary III) Standard Proposal (1996-12)">[3]</sup></a></td></tr>
<tr>
<td>Bit 6</td>
<td>Invisible<a href="#MACBIN1"><sup title="Macintosh Binary Transfer Format (MacBinary) Standard Proposal (1985-03-13)">[1]</sup></a><a href="#MACBIN3"><sup title="Macintosh Binary Transfer Format (MacBinary III) Standard Proposal (1996-12)">[3]</sup></a></td></tr>
<tr>
<td>Bit 7</td>
<td>Locked<a href="#MACBIN1"><sup title="Macintosh Binary Transfer Format (MacBinary) Standard Proposal (1985-03-13)">[1]</sup></a>, isAlias<a href="#MACBIN3"><sup title="Macintosh Binary Transfer Format (MacBinary III) Standard Proposal (1996-12)">[3]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>4A</tt></td>	<td>i8</td>
<td>0<br>Suggested for file check for MacBinary</td></tr>
<tr>
<td><tt><sub>x</sub>4B</tt></td>	<td>i16be</td>
<td>(FInfo) y position in window</td></tr>
<tr>
<td><tt><sub>x</sub>4D</tt></td>	<td>i16be</td>
<td>(FInfo) x position in window</td></tr>
<tr>
<td><tt><sub>x</sub>4F</tt></td>	<td>i16be</td>
<td>(FInfo) window/folder ID</td></tr>
<tr>
<td><tt><sub>x</sub>51</tt></td>	<td>i8</td>
<td>Protected flag bit (low order bit)</td></tr>
<tr>
<td><tt><sub>x</sub>52</tt></td>	<td>i8</td>
<td>0 (Version 3: change for incompatible update to MacBinary I)<br>Suggested for file check for MacBinary I</td></tr>
<tr>
<td><tt><sub>x</sub>53</tt></td>	<td>i32be</td>
<td>Data Fork length</td></tr>
<tr>
<td><tt><sub>x</sub>57</tt></td>	<td>i32be</td>
<td>Resource Fork length</td></tr>
<tr>
<td><tt><sub>x</sub>5B</tt></td>	<td>i32be</td>
<td>File creation date</td></tr>
<tr>
<td><tt><sub>x</sub>5F</tt></td>	<td>i32be</td>
<td>File modification date</td></tr>
<tr>
<td><tt><sub>x</sub>63</tt></td>	<td>i16be</td>
<td>(Version 1 extension) Get Info comment length</td></tr>
<tr>
<td><tt><sub>x</sub>65</tt></td>	<td>i8</td>
<td>(Version 2, FInfo) Finder flags (remaining bits)
<table border='1'>
<tr>
<td>Bit 0</td>
<td>isOnDesk<a href="#MACBIN3"><sup title="Macintosh Binary Transfer Format (MacBinary III) Standard Proposal (1996-12)">[3]</sup></a></td></tr>
<tr>
<td>Bits 1:3</td>
<td>color<a href="#MACBIN3"><sup title="Macintosh Binary Transfer Format (MacBinary III) Standard Proposal (1996-12)">[3]</sup></a></td></tr>
<tr>
<td>Bit 4</td>
<td>reserved<a href="#MACBIN3"><sup title="Macintosh Binary Transfer Format (MacBinary III) Standard Proposal (1996-12)">[3]</sup></a></td></tr>
<tr>
<td>Bit 5</td>
<td>requiresSwitchLaunch<a href="#MACBIN3"><sup title="Macintosh Binary Transfer Format (MacBinary III) Standard Proposal (1996-12)">[3]</sup></a></td></tr>
<tr>
<td>Bit 6</td>
<td>isShared<a href="#MACBIN3"><sup title="Macintosh Binary Transfer Format (MacBinary III) Standard Proposal (1996-12)">[3]</sup></a></td></tr>
<tr>
<td>Bit 7</td>
<td>hasNoInits<a href="#MACBIN3"><sup title="Macintosh Binary Transfer Format (MacBinary III) Standard Proposal (1996-12)">[3]</sup></a></td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>66</tt></td>	<td>i32be</td>
<td>(Version 3) <tt>"mBIN"</tt><br>Suggested for file check for check for MacBinary III</td></tr>
<tr>
<td><tt><sub>x</sub>6A</tt></td>	<td>i8</td>
<td>(Version 3, FXInfo) Script of file [fdScript]</td></tr>
<tr>
<td><tt><sub>x</sub>6B</tt></td>	<td>i8</td>
<td>(Version 3, FXInfo) Extended Finder flags [fdXFlags]</td></tr>
<tr>
<td><tt><sub>x</sub>6C</tt></td>	<td>c[8]</td>
<td>reserved</td></tr>
<tr>
<td><tt><sub>x</sub>74</tt></td>	<td>i32be</td>
<td>(Version 2) Unpacked file size or 0</td></tr>
<tr>
<td><tt><sub>x</sub>78</tt></td>	<td>i16be</td>
<td>(Version 2) Length of secondary header, must be 0</td></tr>
<tr>
<td><tt><sub>x</sub>7A</tt></td>	<td>i8</td>
<td>(Version 2) Version number
<table border='1'>
<tr>
<td><tt><sub>x</sub>11</tt></td>
<td>Version 2</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>
<td>Version 3</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>7B</tt></td>	<td>i8</td>
<td>(Version 2) Minimum required version number, <tt><sub>x</sub>11</tt></td></tr>
<tr>
<td><tt><sub>x</sub>7C</tt></td>	<td>i16be</td>
<td>(Version 2) CRC of previous 124 bytes<br>Suggested for file check for check for MacBinary II</td></tr>
<tr>
<td><tt><sub>x</sub>7E</tt></td>	<td>i16be</td>
<td>reserved</td></tr>
</table>
<h4>CRC calculation</h2>
<p>CRC calculation for the field at offset <tt><sub>x</sub>7C</tt> is done using the CRC16-CCITT algorithm.</p>
<p>Start with <tt><sub>x</sub>1021</tt>.</p>
<p>For each byte, xor the byte shifted by 8.</p>
<p>Do the CRC loop: rotate 8 times, and each time there is a carry, xor <tt><sub>x</sub>1021</tt> to the result of that rotation.</p>
<a id="_references"/>
<h3>References</h1>
<ul>
<li>[1] <a href="https://web.archive.org/web/20050307030202/http://www.lazerware.com/formats/macbinary/macbinary.html" target='_blank'>Macintosh Binary Transfer Format (MacBinary) Standard Proposal (1985-03-13)</a></li>
<li>[2] <a href="https://web.archive.org/web/20050305042909/http://www.lazerware.com/formats/macbinary/macbinary_ii.html" target='_blank'>Macintosh Binary Transfer Format (MacBinary II) Standard Proposal (1987-06-21)</a></li>
<li>[3] <a href="https://web.archive.org/web/20050305044255/http://www.lazerware.com:80/formats/macbinary/macbinary_iii.html" target='_blank'>Macintosh Binary Transfer Format (MacBinary III) Standard Proposal (1996-12)</a></li>
</ul>
<hr/>
<h1 id="gsos_omf">Object Module Format for Apple computers</h1>
<dl>
<dt>File extensions</td>
<dd>&mdash;</dd>
<dl>
<dt>Magic code</td>
<dd>&mdash;</dd>
<dl>
<dt>Architecture</td>
<dd>MOS 6502, WDC 65C816</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>?: ORCA/M 4.0 (version 0)</li>
<li>around 1986: ORCA/M 4.1 (version 1, 8/16-bit)</li>
<li>1986: ProDOS 16, GS/OS</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>MOS 6502, WDC 65C816</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#seghdr">Segment header</a>
</li>
<li><a href="#segrec">Segment record</a>
<ol>
<li><a href="#">Records used in all modules</a>
</li>
<li><a href="#">Records used in load modules only</a>
<ol>
<li><a href="#">Super-compressed records</a>
</li>
</ol></li>
<li><a href="#">Records used in run-time library dictionaries only</a>
</li>
<li><a href="#">Records used in object files only</a>
</li>
</ol></li>
<li><a href="#Expressions">Expressions</a>
</li>
<li><a href="#Jump-table segment">Jump-table segment</a>
<ol>
<li><a href="#">Unloaded state</a>
</li>
<li><a href="#">Loaded state</a>
</li>
</ol></li>
<li><a href="#Initialization segment">Initialization segment</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<p>An file in the Object Module Format can be an object (type <tt><sub>x</sub>B1</tt>), library (type <tt><sub>x</sub>B2</tt>) or a load file (types <tt><sub>x</sub>B3</tt>-<tt><sub>x</sub>BE</tt>). The general structure of an OMF file is a sequence of segment headers and segment records.</p>
<table border='1' align='center'>
<tr>
<td><a href="#seghdr">Segment header</a> 1</td></tr>
<tr>
<td><a href="#segrec">Segment record</a> sequence 1</td></tr>
<tr>
<td><a href="#seghdr">Segment header</a> 2</td></tr>
<tr>
<td><a href="#segrec">Segment record</a> sequence 2</td></tr>
<tr>
<td>...</td></tr>
</table>
<p>Library files contain a library dictionary segment.</p>
<p>Load files can contain code, data, direct-page/stack, initialization, jump-table and pathname segments. Each segment contains binary data (<tt>LCONST</tt> record followed by zerod out <tt>DS</tt>), followed by a relocation directory (sequence of <tt>RELOC</tt>, <tt>cRELOC</tt>, <tt>INTERSEG</tt>, <tt>cINTERSEG</tt>, <tt>SUPER</tt> records).</p>
<p>Run-time library files have type <tt><sub>x</sub>B4</tt>, shell applications have type <tt><sub>x</sub>B5</tt>.</p>
<a id="seghdr"/>
<h2>Segment header</h1>
<p>Every segment has a segment header. The format and size of the segment has to be determined using this structure. The value at offset <tt><sub>x</sub>0F</tt> provides the version of the segment (each segment in a file can have a different version). The value at <tt><sub>x</sub>00</tt> will then provide the length of the segment. According to <a href="#disc"><sup title="OMF v1.0? - comp.sys.apple2.programmer">[3]</sup></a>, the way that field is interpreted depends on whether it is an executable/object or a library.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i32le</td>
<td>(Version 1<a href="#OMF"><sup title="Object Module Format ERS version 00:93">[1]</sup></a>) <tt>BLKCNT</tt> - Number of 512 byte blocks in segment, including header<br>(Version 2<a href="#REF"><sup title="GS/OS Reference, Volume 2 (Beta Draft)">[2]</sup></a> and static libraries<a href="#disc"><sup title="OMF v1.0? - comp.sys.apple2.programmer">[3]</sup></a>) <tt>BYTECNT</tt> - Number of bytes in segment, including header<br>Offset to next segment data, no alignment required</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i32le</td>
<td><tt>RESSPC</tt> - Number of additional zero bytes to append to segment data (can be replaced via a <tt>DS</tt> record)</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32le</td>
<td><tt>LENGTH</tt> - Number of bytes in segment when loaded into memory, including zero bytes of <tt>RESSPC</tt></td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i8</td>
<td>(Version 1<a href="#OMF"><sup title="Object Module Format ERS version 00:93">[1]</sup></a>) <tt>KIND</tt><br>(Version 2<a href="#REF"><sup title="GS/OS Reference, Volume 2 (Beta Draft)">[2]</sup></a>) Reserved
<table border='1'>
<tr>
<td>Bits 0:4</td>
<td>Type (version 1)
<table border='1'>
<tr>
<td>0x00</td>
<td>Code Segment</td></tr>
<tr>
<td>0x01</td>
<td>Data Segment</td></tr>
<tr>
<td>0x02</td>
<td>Jump Table Segment</td></tr>
<tr>
<td>0x04</td>
<td>Pathname Segment</td></tr>
<tr>
<td>0x08</td>
<td>Library Dictionary Segment</td></tr>
<tr>
<td>0x10</td>
<td>Initialization Segment</td></tr>
<tr>
<td>0x11</td>
<td>Absolute Bank Segment</td></tr>
<tr>
<td>0x12</td>
<td>Direct Page/Stack Segment</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 5</td>
<td>Position independent (version 1)</td></tr>
<tr>
<td>Bit 6</td>
<td>Private (version 1)</td></tr>
<tr>
<td>Bit 7</td>
<td>
<table border='1'>
<tr>
<td>0</td>
<td>Static (version 1)</td></tr>
<tr>
<td>1</td>
<td>Dynamic (version 1)</td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>0D</tt></td>	<td>i8</td>
<td><tt>LABLEN</tt> - Length of all label fields<br>A value of 0 means a variable length field, the first byte of which specifies the number of characters following</td></tr>
<tr>
<td><tt><sub>x</sub>0E</tt></td>	<td>i8</td>
<td><tt>NUMLEN</tt> - Length of number fields, must be 4 for Apple IIGS</td></tr>
<tr>
<td><tt><sub>x</sub>0F</tt></td>	<td>i8</td>
<td><tt>VERSION</tt> - OMF version, currently 1 (version 1.0) and 2 (version 2.0 or 2.1) are valid</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32le</td>
<td><tt>BANKSIZE</tt> - Maximum bank size of segment, must be power of 2 and &le; <tt><sub>x</sub>10000</tt> for Apple IIGS, and a value of 0 permits crossing bank boundaries</td></tr>
<tr>
<td><tt><sub>x</sub>12</tt></td>	<td>i16le</td>
<td>(Version 1<a href="#OMF"><sup title="Object Module Format ERS version 00:93">[1]</sup></a>) Reserved<br>(Version 2<a href="#REF"><sup title="GS/OS Reference, Volume 2 (Beta Draft)">[2]</sup></a>) <tt>KIND</tt>
<table border='1'>
<tr>
<td>Bits 0:4</td>
<td>Type (version 2)
<table border='1'>
<tr>
<td>0x00</td>
<td>Code Segment</td></tr>
<tr>
<td>0x01</td>
<td>Data Segment</td></tr>
<tr>
<td>0x02</td>
<td>Jump Table Segment</td></tr>
<tr>
<td>0x04</td>
<td>Pathname Segment</td></tr>
<tr>
<td>0x08</td>
<td>Library Dictionary Segment</td></tr>
<tr>
<td>0x10</td>
<td>Initialization Segment</td></tr>
<tr>
<td>0x12</td>
<td>Direct Page/Stack Segment</td></tr>
</table>
</td></tr>
<tr>
<td>Bit 8</td>
<td>Bank-relative (version 2)</td></tr>
<tr>
<td>Bit 9</td>
<td>Skip segment (version 2)</td></tr>
<tr>
<td>Bit 10</td>
<td>Reload segment (version 2)</td></tr>
<tr>
<td>Bit 11</td>
<td>Absolute-bank segment (version 2)</td></tr>
<tr>
<td>Bit 12</td>
<td>Do not load in special memory (version 2)</td></tr>
<tr>
<td>Bit 13</td>
<td>Position independent (version 2)</td></tr>
<tr>
<td>Bit 14</td>
<td>Private (version 2)</td></tr>
<tr>
<td>Bit 15</td>
<td>
<table border='1'>
<tr>
<td>0</td>
<td>Static (version 2)</td></tr>
<tr>
<td>1</td>
<td>Dynamic (version 2)</td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i16le</td>
<td>Reserved</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32le</td>
<td><tt>ORG</tt> - Absolute address of segment, or 0 if relocatable</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32le</td>
<td><tt>ALIGN</tt> - Alignment, must be power of 2 and &le; <tt><sub>x</sub>10000</tt> for Apple IIGS<br>Apple IIGS only supports page alignment (<tt><sub>x</sub>100</tt>) and bank alignment (<tt><sub>x</sub>10000</tt>)</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i8</td>
<td><tt>NUMSEX</tt>, must be 0
<table border='1'>
<tr>
<td>0</td>
<td>Little endian</td></tr>
<tr>
<td>1</td>
<td>Big endian</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>21</tt></td>	<td>i8</td>
<td>(Version 1<a href="#OMF"><sup title="Object Module Format ERS version 00:93">[1]</sup></a>) <tt>LCBANK</tt> - Bank number to load into, if <tt>ORG</tt> specifies an address in the Language Card area (banks <tt><sub>x</sub>00</tt>, <tt><sub>x</sub>01</tt>, <tt><sub>x</sub>E0</tt>, <tt><sub>x</sub>E1</tt>)<br>(Version 2<a href="#disc"><sup title="OMF v1.0? - comp.sys.apple2.programmer">[3]</sup></a>) <tt>REVISION</tt> - OMF revision number, set to 1 for version 2.1 (<a href="#REF"><sup title="GS/OS Reference, Volume 2 (Beta Draft)">[2]</sup></a> claims it is reserved)</td></tr>
<tr>
<td><tt><sub>x</sub>22</tt></td>	<td>i16le</td>
<td>(not Version 0<a href="#disc"><sup title="OMF v1.0? - comp.sys.apple2.programmer">[3]</sup></a>)<tt>SEGNUM</tt> - Segment number, must be equal to the index of the segment within the file, starting from 1</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i32le</td>
<td>(not Version 0<a href="#disc"><sup title="OMF v1.0? - comp.sys.apple2.programmer">[3]</sup></a>)<tt>ENTRY</tt> - Entry point of the segment</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i16le</td>
<td>(not Version 0<a href="#disc"><sup title="OMF v1.0? - comp.sys.apple2.programmer">[3]</sup></a>)<tt>DISPNAME</tt> - Offset to <tt>LOADNAME</tt>, typically <tt><sub>x</sub>2C</tt> <a href="#REF"><sup title="GS/OS Reference, Volume 2 (Beta Draft)">[2]</sup></a>, or <tt><sub>x</sub>30</tt> for 2.1 <a href="#disc"><sup title="OMF v1.0? - comp.sys.apple2.programmer">[3]</sup></a></td></tr>
<tr>
<td><tt><sub>x</sub>2A</tt></td>	<td>i16le</td>
<td>(not Version 0<a href="#disc"><sup title="OMF v1.0? - comp.sys.apple2.programmer">[3]</sup></a>)<tt>DISPDATA</tt> - Offset to the segment data, typically <tt><sub>x</sub>3A</tt> + <tt>LABLEN</tt></td></tr>
<tr>
<td><tt><sub>x</sub>2C</tt></td>	<td>i32le</td>
<td>(optional, Version 2.1<a href="#disc"><sup title="OMF v1.0? - comp.sys.apple2.programmer">[3]</sup></a>) <tt>tempOrg</tt><a href="#REF"><sup title="GS/OS Reference, Volume 2 (Beta Draft)">[2]</sup></a></td></tr>
</table>
<p>This is then followed by the <tt>LOADNAME</tt> field, at offset <tt>DISPNAME</tt> (not Version 0<a href="#disc"><sup title="OMF v1.0? - comp.sys.apple2.programmer">[3]</sup></a>):</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[0xA]</td>
<td><tt>LOADNAME</tt>, always length 10 - Name of the segment according to linker</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>c[?]</td>
<td><tt>SEGNAME</tt> - Name of the segment</td></tr>
</table>
<p>Note: <a href="#REF"><sup title="GS/OS Reference, Volume 2 (Beta Draft)">[2]</sup></a> calls the field at <tt><sub>x</sub>0A</tt> <tt>blockCount</tt> which is probably a bug<a href="#disc"><sup title="OMF v1.0? - comp.sys.apple2.programmer">[3]</sup></a>.</p>
<a id="segrec"/>
<h2>Segment record</h1>
<p>The segment body starts at <tt>DISPDATA</tt> (stored in <a href="#seghdr">Segment header</a>), and it is a sequence of records. The first byte defines the record type. The number fields length <tt>NUMLEN</tt> and byte ordering <tt>NUMSEX</tt>, the offsets are indicated with assuming a value of 4, as dictated by Apple IIGS. The label fields have length <tt>LABLEN</tt>.</p>
<h3>Records used in all modules</h2>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>00</tt> - <tt>END</tt> - end of segment</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>F1</tt> - <tt>DS</tt> - inserts a sequence of zero bytes at the current location counter</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>number</td>
<td>Number of zeros to insert</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>F2</tt> - <tt>LCONST</tt> - load absolute data</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i32</td>
<td>Number of bytes of data</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>c[*]</td>
<td>Data to be loaded</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>FB</tt> - <tt>General</tt> - (Version 2) reserved for Apple Computer, Inc.<br><tt><sub>x</sub>FC</tt>-<tt><sub>x</sub>FF</tt> - <tt>Experimental</tt> - (Version 2)</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i32</td>
<td>Number of bytes</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>c[*]</td>
<td>Data</td></tr>
</table>
<h3>Records used in load modules only</h2>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>E2</tt> - <tt>RELOC</tt> - patches an address within a segment</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i8</td>
<td>Number of bytes to relocate</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i8</td>
<td>Shift amount to address before patching value; positive values shift to the left, negative values to the right</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>number</td>
<td>Offset to location to patch</td></tr>
<tr>
<td><tt><sub>x</sub>07</tt></td>	<td>number</td>
<td>Offset from 0 that should be written</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>F5</tt> - <tt>cRELOC</tt> - compressed <tt>RELOC</tt>, patches an address within a segment</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i8</td>
<td>Number of bytes to relocate</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i8</td>
<td>Shift amount to address before patching value; positive values shift to the left, negative values to the right</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>i16</td>
<td>Offset to location to patch</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i16</td>
<td>Offset from 0 that should be written</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>E3</tt> - <tt>INTERSEG</tt> - patches an address between segments</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i8</td>
<td>Number of bytes to relocate</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i8</td>
<td>Shift amount to address before patching value; positive values shift to the left, negative values to the right</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>number</td>
<td>Offset to location to patch</td></tr>
<tr>
<td><tt><sub>x</sub>07</tt></td>	<td>i16</td>
<td>File number, if a program has only 1 load file, the value is 1<br>for dynamic segments, this references a file with a jump table segment</td></tr>
<tr>
<td><tt><sub>x</sub>09</tt></td>	<td>i16</td>
<td>Segment number, starting from 1<br>for dynamic segments, this references a jump table segment</td></tr>
<tr>
<td><tt><sub>x</sub>0B</tt></td>	<td>number</td>
<td>Offset from 0 that should be written<br>for dynamic segments, this references a call to the System Loader for that reference</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>F6</tt> - <tt>cINTERSEG</tt> - compressed <tt>INTERSEG</tt>, patches an address between segments, with file number 1</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i8</td>
<td>Number of bytes to relocate</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i8</td>
<td>Shift amount to address before patching value; positive values shift to the left, negative values to the right</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>i16</td>
<td>Offset to location to patch</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i8</td>
<td>Segment number, starting from 1<br>for dynamic segments, this references a jump table segment</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16</td>
<td>Offset from 0 that should be written<br>for dynamic segments, this references a call to the System Loader for that reference</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>F7</tt> - <tt>SUPER</tt> - (Version 2) A super-compressed relocation-dictionary record</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i32</td>
<td>Number of bytes in the rest of the record</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>i8</td>
<td>Record type</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>c[*]</td>
<td>Lists 16-bit offsets in a sequence of blocks, each block corresonding to that page
<table border='1'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>00</tt>-<tt><sub>x</sub>7F</tt> - Patch 1-128 offsets, the low bytes given in the following bytes<br><tt><sub>x</sub>81</tt>-<tt><sub>x</sub>FF</tt> - Skip 1-128 pages, no following bytes</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i8[*]</td>
<td>Low bytes of the offsets to patch at, within the same page</td></tr>
</table>
</td></tr>
</table>
<h4>Super-compressed records</h3>
<p>For super-compressed records, only the addresses of the patches are provided. The way it will be patched depends on the type of the record and the value stored at the address at the time of patching.</p>
<table border='1' align='center'>
<tr>
<td>Type</td>
<td>i8</td>
<td><tt><sub>x</sub>00</tt> - <tt>SUPER RELOC2</tt>, super-compressed <tt>RELOC</tt>, patches an address within a segment, relocate 2 bytes, bit-shift count of zero</td></tr>
<tr>
<td>Value</td>
<td>i16</td>
<td>Offset from 0 that should be written</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td>Type</td>
<td>i8</td>
<td><tt><sub>x</sub>01</tt> - <tt>SUPER RELOC3</tt>, super-compressed <tt>RELOC</tt>, patches an address within a segment, relocate 3 bytes, bit-shift count of zero</td></tr>
<tr>
<td>Value</td>
<td>i16</td>
<td>Offset from 0 that should be written</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td>Type</td>
<td>i8</td>
<td><tt><sub>x</sub>02</tt>-<tt><sub>x</sub>0D</tt> - <tt>SUPER INTERSEG1</tt>-<tt>SUPER INTERSEG12</tt> - super-compressed <tt>INTERSEG</tt>, patches an address between segments, with file number 1-12, relocate 3 bytes, bit-shift count of zero</td></tr>
<tr>
<td>Value</td>
<td>i16</td>
<td>Offset from 0 that should be written<br>for dynamic segments, this references a call to the System Loader for that reference</td></tr>
<tr>
<td>Value+2</td>
<td>i8</td>
<td>Segment number, starting from 1<br>for dynamic segments, this references a jump table segment</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td>Type</td>
<td>i8</td>
<td><tt><sub>x</sub>0E</tt>-<tt><sub>x</sub>19</tt> - <tt>SUPER INTERSEG13</tt>-<tt>SUPER INTERSEG24</tt> - super-compressed <tt>INTERSEG</tt>, patches an address between segments, with file number 1, segment number 1-12, relocate 2 bytes, bit-shift count of zero</td></tr>
<tr>
<td>Value</td>
<td>i16</td>
<td>Offset from 0 that should be written<br>for dynamic segments, this references a call to the System Loader for that reference</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td>Type</td>
<td>i8</td>
<td><tt><sub>x</sub>1A</tt>-<tt><sub>x</sub>25</tt> - <tt>SUPER INTERSEG25</tt>-<tt>SUPER INTERSEG36</tt> - super-compressed <tt>INTERSEG</tt>, patches an address between segments, with file number 1, segment number 1-12, relocate 2 bytes, bit-shift count of -16 (<tt><sub>x</sub>F0</tt>)</td></tr>
<tr>
<td>Value</td>
<td>i16</td>
<td>Offset from 0 that should be written<br>for dynamic segments, this references a call to the System Loader for that reference</td></tr>
</table>
<h3>Records used in run-time library dictionaries only</h2>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>F4</tt> - <tt>ENTRY</tt> - used in the run-time library entry dictionary</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i16</td>
<td>Segment number</td></tr>
<tr>
<td><tt><sub>x</sub>03</tt></td>	<td>number</td>
<td>Relative location within the load segment of the label</td></tr>
<tr>
<td><tt><sub>x</sub>07</tt></td>	<td>label</td>
<td>Label</td></tr>
</table>
<h3>Records used in object files only</h2>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>01</tt>-<tt><sub>x</sub>DF</tt> - <tt>CONST</tt> - load absolute data</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>c[*]</td>
<td>Data to be loaded</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>E0</tt> - <tt>ALIGN</tt> - insert zero bytes to align to boundary</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i32</td>
<td>Alignment, must be a power of 2 that is at most <tt>ALIGN</tt></td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>E1</tt> - <tt>ORG</tt> - moves present location counter<br>if negative, subsequent writes will overwrite the previous data</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>number</td>
<td>Amount of bytes to move</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>E4</tt> - <tt>USING</tt> - loads the local labels from a data segment for usage</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>label</td>
<td>Segment name</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>E5</tt> - <tt>STRONG</tt> - requires that a segment must be linked, even if it is not referenced</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>label</td>
<td>Segment name</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>E6</tt> - <tt>GLOBAL</tt> - defines a global label at the current position<br><tt><sub>x</sub>EF</tt> - <tt>LOCAL</tt> - defines a local label at the current position</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>label</td>
<td>Label name, of length <tt>LABLEN</tt></td></tr>
<tr>
<td><tt>...</tt></td>	<td>i16</td>
<td>Number of bytes generated by the line, or <tt><sub>x</sub>FFFF</tt> if it is greater or equal to <tt><sub>x</sub>FFFF</tt></td></tr>
<tr>
<td><tt>...</tt></td>	<td>i8</td>
<td>Operation type
<table border='1'>
<tr>
<td>'A'</td>
<td>Address-type DC statement</td></tr>
<tr>
<td>'B'</td>
<td>Boolean-type DC statement</td></tr>
<tr>
<td>'C'</td>
<td>Character-type DC statement</td></tr>
<tr>
<td>'D'</td>
<td>Double-precision floating-point-type DC statement</td></tr>
<tr>
<td>'F'</td>
<td>Floating-point-type DC statement</td></tr>
<tr>
<td>'G'</td>
<td>EQU or GEQU statement</td></tr>
<tr>
<td>'H'</td>
<td>Hexadecimal-type DC statement</td></tr>
<tr>
<td>'I'</td>
<td>Integer-type DC statement</td></tr>
<tr>
<td>'K'</td>
<td>Reference-address-type DC statement</td></tr>
<tr>
<td>'L'</td>
<td>Soft-reference-type DC statement</td></tr>
<tr>
<td>'M'</td>
<td>Instruction</td></tr>
<tr>
<td>'N'</td>
<td>Assembler directive</td></tr>
<tr>
<td>'O'</td>
<td>ORG statement</td></tr>
<tr>
<td>'P'</td>
<td>ALIGN statement</td></tr>
<tr>
<td>'S'</td>
<td>DS statement</td></tr>
<tr>
<td>'X'</td>
<td>Arithmetic symbolic parameter</td></tr>
<tr>
<td>'Y'</td>
<td>Boolean symbolic parameter</td></tr>
<tr>
<td>'Z'</td>
<td>Character symbolic parameter</td></tr>
</table>
</td></tr>
<tr>
<td><tt>...</tt></td>	<td>i8</td>
<td>Private flag, designates the code or data segment as private if <tt><sub>x</sub>01</tt></td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>E7</tt> - <tt>GEQU</tt> - defines a global label with expression<br><tt><sub>x</sub>F0</tt> - <tt>EQU</tt> - defines a local label with expression</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>label</td>
<td>Label name, of length <tt>LABLEN</tt></td></tr>
<tr>
<td><tt>...</tt></td>	<td>i16</td>
<td>Number of bytes generated by the line, or <tt><sub>x</sub>FFFF</tt> if it is greater or equal to <tt><sub>x</sub>FFFF</tt></td></tr>
<tr>
<td><tt>...</tt></td>	<td>i8</td>
<td>Operation type (same as <tt>GLOBAL</tt>)</td></tr>
<tr>
<td><tt>...</tt></td>	<td>i8</td>
<td>Private flag, designates the code or data segment as private if <tt><sub>x</sub>01</tt></td></tr>
<tr>
<td><tt>...</tt></td>	<td>expr</td>
<td>Expression</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>E8</tt> - <tt>MEM</tt> - reserves a memory range</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>number</td>
<td>Start address</td></tr>
<tr>
<td><tt><sub>x</sub>05</tt></td>	<td>number</td>
<td>End address</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>EB</tt> - <tt>EXPR</tt> - evaluates an expression and stores its truncated value<br><tt><sub>x</sub>EC</tt> - <tt>ZEXPR</tt> - evaluates an expression and stores its value, making sure the truncated bytes are 0<br><tt><sub>x</sub>ED</tt> - <tt>BEXPR</tt> - evaluates an expression and stores its value, making sure the truncated bytes match those of the location counter<br><tt><sub>x</sub>F3</tt> - <tt>LEXPR</tt> - like <tt>EXPR</tt>, but if the expression evaluates to a label with fixed, constant offset in a different dynamic code segment, a jump-table segment entry is generated</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i8</td>
<td>Size of value in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>expr</td>
<td>Expression</td></tr>
</table>
<p></p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i8</td>
<td><tt><sub>x</sub>EE</tt> - <tt>RELEXPR</tt> - generates a relative branch offset from a location</td></tr>
<tr>
<td><tt><sub>x</sub>01</tt></td>	<td>i8</td>
<td>Size of value in bytes</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>number</td>
<td>Offset of origin of branch</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>expr</td>
<td>Expression</td></tr>
</table>
<a id="Expressions"/>
<h2>Expressions</h1>
<p>TODO (only relevant to object files)</p>
<a id="Jump-table segment"/>
<h2>Jump-table segment</h1>
<p>The jump-table begins with 8 zero bytes. Afterwards, each jump-table entry is 14 bytes long.</p>
<h3>Unloaded state</h2>
<p>This is the format stored in files.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>User ID, initially 0, filled in after loading</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Load-file number, a value of 0 terminates the list</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Load-segment number</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i32le</td>
<td>Load-segment offset</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>c[4]</td>
<td>A long subroutine jump to the load function using <tt>JSL</tt>, the actual address is filled in after loading</td></tr>
</table>
<h3>Loaded state</h2>
<p>This format is only used for the image in memory.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>i16le</td>
<td>User ID</td></tr>
<tr>
<td><tt><sub>x</sub>02</tt></td>	<td>i16le</td>
<td>Load-file number</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Load-segment number</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i32le</td>
<td>Load-segment offset</td></tr>
<tr>
<td><tt><sub>x</sub>0A</tt></td>	<td>c[4]</td>
<td>A long jump to the reference using <tt>JML</tt></td></tr>
</table>
<a id="Initialization segment"/>
<h2>Initialization segment</h1>
<p>When encountering an initialization segment, the System Loader transfers control to it. It must then return to the System Loader via a long return <tt>RTL</tt> instruction. It must also not change the stack pointer, use the current direct page, or reference segments that have not been loaded yet. When an application is restarted, initialization segments are also rerun.</p>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] Object Module Format ERS version 00:93</li>
<li>[2] GS/OS Reference, Volume 2 (Beta Draft)</li>
<li>[3] <a href="https://groups.google.com/g/comp.sys.apple2.programmer/c/_wUSsAQ_N1E" target='_blank'>OMF v1.0? - comp.sys.apple2.programmer</a></li>
</ul>
<hr/>
<h1 id="pef">Preferred Executable Format (PEF)</h1>
<dl>
<dt>File extensions</td>
<dd>&mdash;</dd>
<dl>
<dt>Magic code</td>
<dd><tt>"Joy!"</tt></dd>
<dl>
<dt>Architecture</td>
<dd>Motorola 68000, PowerPC</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>1994-03-14: System 7.1.2 for Power Macintosh 6100</li>
<li>1996-01: BeOS Developer Release 6 on PowerPC</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>Motorola 68000, PowerPC</dd>
<hr/>
<h1 id="hunk">Hunk executable</h1>
<dl>
<dt>File extensions</td>
<dd>&mdash;</dd>
<dl>
<dt>Magic code</td>
<dd><tt><sub>x</sub>00<sub>x</sub>00<sub>x</sub>03<sub>x</sub>F3</tt></dd>
<dl>
<dt>Architecture</td>
<dd>Motorola 68000, PowerPC for WarpUp (1997)</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>1978: TRIPOS<sup>?</sup></li>
<li>1985-07-23: AmigaOS 1.0</li>
<li>1997: WarpOS</li>
<li>2004-04: AmigaOS 4.0 (alongside <a href="#elf">ELF</a>)</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>Motorola 68000, PowerPC for WarpUp (1997)</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Further work</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Further work</h1>
<p>This format requires documentation.</p>
<a id="_references"/>
<h2>References</h1>
<ul>
</ul>
<hr/>
<h1 id="adam">Adam Seychell's DOS32 executable</h1>
<dl>
<dt>File extensions</td>
<dd><tt>.exe</tt></dd>
<dl>
<dt>Magic code</td>
<dd><tt>"Adam"</tt>, <tt>"DLL "</tt></dd>
<dl>
<dt>Architecture</td>
<dd>Intel 80386</dd>
<dl>
<dt>Operating systems</td>
<dd><ul>
<li>1994: Adam Seychell's DOS32 extender</li>
<li>?: WDOSX</li>
<li>?: DX64</li>
</ul></dd>
</dl>
<dl>
<dt>Influences</td>
<dd>Intel 80386</dd>
<a id="_contents"/>
<h2>Contents</h1>
<ol>
<li><a href="#_contents">Contents</a>
</li>
<li><a href="#">Overall layout</a>
</li>
<li><a href="#header">Executable Header</a>
<ol>
<li><a href="#">Executable Header for the version 3.5 beta</a>
</li>
</ol></li>
<li><a href="#relocs">Relocations</a>
</li><li><a href="#_references">References</a></li>
</ol>
<h2>Overall layout</h1>
<table border='1' align='center'>
<tr>
<td>Optional MZ stub (DJGPP only)</td></tr>
<tr>
<td><a href="#header">Executable Header</a></td></tr>
<tr>
<td>Executable image</td></tr>
<tr>
<td><a href="#relocs">Relocations</a></td></tr>
</table>
<a id="header"/>
<h2>Executable Header</h1>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[4]</td>
<td>Signature
<table border='1'>
<tr>
<td><tt>"Adam"</tt> - executable</td></tr>
<tr>
<td><tt>"DLL "</tt> - dynamic linking library</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Version number of linker (DLINK), in packed BCD format</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>Version number of DOS32 required, in packed BCD format</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32le</td>
<td>Size of DOS32 executable, without stub</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32le</td>
<td>Start of executable image from header start</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32le</td>
<td>Size of executable image, start of relocations</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32le</td>
<td>Memory required, including executable image</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32le</td>
<td>Initial EIP (entry)</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32le</td>
<td>Initial ESP (stack)</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32le</td>
<td>Number of relocations</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i32le</td>
<td>Flags
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Compressed image</td></tr>
<tr>
<td>Bit 1</td>
<td>Display DOS32 logo on start</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i32le</td>
<td>Size of relocations<a href="#WDOSX"><sup title="dos32.asm - Wuschel's DOS eXtender sources">[2]</sup></a>, apparently not used</td></tr>
</table>
<h3>Executable Header for the version 3.5 beta</h2>
<p>According to Michael Tippach's research<a href="#WDOSX"><sup title="dos32.asm - Wuschel's DOS eXtender sources">[2]</sup></a>, version 3.5 uses a different header format.</p>
<table border='1' align='center'>
<tr>
<td><tt><sub>x</sub>00</tt></td>	<td>c[4]</td>
<td>Signature
<table border='1'>
<tr>
<td><tt>"Adam"</tt> - executable</td></tr>
<tr>
<td><tt>"DLL "</tt> - dynamic linking library</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>04</tt></td>	<td>i16le</td>
<td>Version number of linker (DLINK), in packed BCD format</td></tr>
<tr>
<td><tt><sub>x</sub>06</tt></td>	<td>i16le</td>
<td>Version number of DOS32 required, in packed BCD format</td></tr>
<tr>
<td><tt><sub>x</sub>08</tt></td>	<td>i32le</td>
<td>Size of DOS32 executable, without stub</td></tr>
<tr>
<td><tt><sub>x</sub>0C</tt></td>	<td>i32le</td>
<td>Size of executable image</td></tr>
<tr>
<td><tt><sub>x</sub>10</tt></td>	<td>i32le</td>
<td>Start of executable image from header start</td></tr>
<tr>
<td><tt><sub>x</sub>14</tt></td>	<td>i32le</td>
<td>Initial EIP (entry)</td></tr>
<tr>
<td><tt><sub>x</sub>18</tt></td>	<td>i32le</td>
<td>Memory required, including executable image</td></tr>
<tr>
<td><tt><sub>x</sub>1C</tt></td>	<td>i32le</td>
<td>Initial ESP (stack)</td></tr>
<tr>
<td><tt><sub>x</sub>20</tt></td>	<td>i32le</td>
<td>Start of relocations</td></tr>
<tr>
<td><tt><sub>x</sub>24</tt></td>	<td>i8</td>
<td>Logo color</td></tr>
<tr>
<td><tt><sub>x</sub>25</tt></td>	<td>i8</td>
<td>Logo delay</td></tr>
<tr>
<td><tt><sub>x</sub>26</tt></td>	<td>i8</td>
<td>Flags
<table border='1'>
<tr>
<td>Bit 0</td>
<td>Compressed image</td></tr>
<tr>
<td>Bit 1</td>
<td>Display DOS32 logo on start</td></tr>
<tr>
<td>Bit 2</td>
<td>Unregistered</td></tr>
</table>
</td></tr>
<tr>
<td><tt><sub>x</sub>27</tt></td>	<td>i8</td>
<td>=0</td></tr>
<tr>
<td><tt><sub>x</sub>28</tt></td>	<td>i32le</td>
<td>=0</td></tr>
</table>
<a id="relocs"/>
<h2>Relocations</h1>
<p>Each relocation is stored as a 32-bit offset from the executable image start, and addresses a 16-bit word that is the selector of the data segment.</p>
<a id="_references"/>
<h2>References</h1>
<ul>
<li>[1] <a href="https://hornet.org/code/hardware/pmode/dos32v33.zip" target='_blank'>A 32-bit DOS extender package, DOS32 Version 3.3 (1995-11-27)</a></li>
<li>[2] <a href="http://tippach.business.t-online.de/wdosx/" target='_blank'>dos32.asm - Wuschel's DOS eXtender sources</a></li>
</ul>
</body>
</html>
